<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kronos OS - Complete Operating System with All Applications</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Ubuntu', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow: hidden;
            height: 100vh;
        }

        .desktop {
            width: 100vw;
            height: 100vh;
            position: relative;
            background: linear-gradient(135deg, #4A90E2 0%, #357ABD 100%);
            transition: background 0.5s ease;
        }

        /* Wallpaper styles */
        .wallpaper-ubuntu-orange {
            background: linear-gradient(135deg, #E95420 0%, #772953 100%);
        }

        .wallpaper-ocean-blue {
            background: linear-gradient(135deg, #4A90E2 0%, #357ABD 100%);
        }

        .wallpaper-forest-green {
            background: linear-gradient(135deg, #28A745 0%, #155724 100%);
        }

        .wallpaper-sunset-purple {
            background: linear-gradient(135deg, #6F42C1 0%, #4C2A85 100%);
        }

        .wallpaper-deep-space {
            background: linear-gradient(135deg, #000033 0%, #000066 100%);
        }

        .wallpaper-cherry-blossom {
            background: linear-gradient(135deg, #FF69B4 0%, #FF1493 100%);
        }

        .wallpaper-arctic-blue {
            background: linear-gradient(135deg, #87CEEB 0%, #4682B4 100%);
        }

        .wallpaper-autumn-gold {
            background: linear-gradient(135deg, #FFD700 0%, #FF8C00 100%);
        }

        .wallpaper-midnight-black {
            background: #000000;
        }

        .wallpaper-pure-white {
            background: #FFFFFF;
        }

        .wallpaper-matrix-green {
            background: linear-gradient(135deg, #00FF00 0%, #008000 100%);
        }

        .desktop-icon {
            position: absolute;
            width: 64px;
            height: 80px;
            cursor: pointer;
            text-align: center;
            color: white;
            font-size: 12px;
            user-select: none;
            transition: all 0.2s ease;
        }

        .desktop-icon:hover {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            transform: scale(1.05);
        }

        .icon {
            width: 48px;
            height: 48px;
            margin: 0 auto 4px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
            transition: all 0.2s ease;
        }

        .desktop-icon:hover .icon {
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.4);
        }

        .taskbar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 48px;
            background: linear-gradient(to bottom, #772953, #5d1f3f);
            display: flex;
            align-items: center;
            padding: 0 8px;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.3);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .start-button {
            background: linear-gradient(to bottom, #E95420, #D44414);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            margin-right: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            transition: all 0.2s ease;
        }

        .start-button:hover {
            background: linear-gradient(to bottom, #D44414, #C23D0F);
            transform: translateY(-1px);
        }

        .taskbar-item {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: none;
            padding: 8px 12px;
            margin-right: 4px;
            border-radius: 4px;
            cursor: pointer;
            max-width: 150px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            transition: all 0.2s ease;
        }

        .taskbar-item:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .taskbar-item.active {
            background: rgba(255, 255, 255, 0.3);
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .system-tray {
            margin-left: auto;
            display: flex;
            align-items: center;
            color: white;
            font-size: 14px;
            gap: 16px;
        }

        .window {
            position: absolute;
            background: white;
            border-radius: 8px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            min-width: 400px;
            min-height: 300px;
            display: none !important;
            border: 1px solid rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .window.active {
            display: block !important;
            z-index: 1000;
        }

        .window.show {
            display: block !important;
            visibility: visible !important;
        }

        .window-header {
            background: linear-gradient(to bottom, #E95420, #D44414);
            color: white;
            padding: 8px 12px;
            display: flex;
            align-items: center;
            cursor: move;
            user-select: none;
        }

        .window-title {
            flex: 1;
            font-weight: bold;
        }

        .window-controls {
            display: flex;
            gap: 4px;
        }

        .window-control {
            width: 20px;
            height: 20px;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            font-size: 12px;
            font-weight: bold;
            transition: all 0.2s ease;
        }

        .window-control:hover {
            transform: scale(1.1);
        }

        .minimize { background: #FFC107; color: #333; }
        .maximize { background: #28A745; color: white; }
        .close { background: #DC3545; color: white; }

        .window-content {
            padding: 16px;
            height: calc(100% - 40px);
            overflow: auto;
        }

        .start-menu {
            position: fixed;
            bottom: 48px;
            left: 8px;
            width: 400px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            display: none;
            z-index: 2000;
            border: 1px solid rgba(0, 0, 0, 0.1);
            max-height: 600px;
            overflow-y: auto;
        }

        .start-menu.show {
            display: block;
            animation: slideUp 0.3s ease-out;
        }

        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .start-menu-header {
            background: linear-gradient(to bottom, #E95420, #D44414);
            color: white;
            padding: 16px;
            font-weight: bold;
            font-size: 18px;
        }

        .start-menu-section {
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }

        .start-menu-section:last-child {
            border-bottom: none;
        }

        .start-menu-section-title {
            padding: 8px 16px;
            font-weight: bold;
            color: #666;
            font-size: 12px;
            text-transform: uppercase;
        }

        .start-menu-item {
            padding: 12px 16px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: background 0.2s ease;
        }

        .start-menu-item:hover {
            background: #f0f0f0;
        }

        .start-menu-item-icon {
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
            font-size: 16px;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #28A745;
            color: white;
            padding: 12px 16px;
            border-radius: 4px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            z-index: 3000;
            display: none;
            max-width: 300px;
        }

        .notification.show {
            display: block;
            animation: slideIn 0.3s ease-out;
        }

        .notification.error {
            background: #DC3545;
        }

        .notification.warning {
            background: #FFC107;
            color: #333;
        }

        .notification.info {
            background: #17A2B8;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* Application-specific styles */
        .calculator {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
        }

        .calc-display {
            background: #000;
            color: #00ff00;
            padding: 15px;
            text-align: right;
            font-family: 'Courier New', monospace;
            font-size: 24px;
            margin-bottom: 15px;
            border-radius: 4px;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: flex-end;
        }

        .calc-buttons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
        }

        .calc-button {
            padding: 15px;
            font-size: 18px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .calc-button:hover {
            transform: scale(1.05);
        }

        .calc-button.number {
            background: #6c757d;
            color: white;
        }

        .calc-button.operator {
            background: #007bff;
            color: white;
        }

        .calc-button.function {
            background: #28a745;
            color: white;
        }

        .calc-button.clear {
            background: #dc3545;
            color: white;
        }

        .wallpaper-selector {
            padding: 20px;
        }

        .wallpaper-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-top: 20px;
        }

        .wallpaper-item {
            cursor: pointer;
            border-radius: 8px;
            overflow: hidden;
            transition: all 0.2s ease;
            border: 3px solid transparent;
        }

        .wallpaper-item:hover {
            transform: scale(1.05);
        }

        .wallpaper-item.selected {
            border-color: #E95420;
        }

        .wallpaper-preview {
            width: 150px;
            height: 100px;
            border-radius: 4px;
        }

        .wallpaper-name {
            text-align: center;
            padding: 8px;
            font-size: 12px;
            background: #f8f9fa;
        }

        /* Settings System Styles */
        .settings-category {
            border-bottom: 1px solid #eee;
            transition: all 0.2s ease;
        }

        .settings-category:hover {
            background: #e9ecef;
        }

        .settings-category.active {
            background: #E95420;
            color: white;
            border-left: 4px solid #D44414;
        }

        .settings-category.active div {
            color: white !important;
        }

        .setting-item {
            transition: all 0.2s ease;
        }

        .setting-item:hover {
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            border-color: #E95420 !important;
        }

        .toggle-switch {
            transition: all 0.3s ease;
        }

        .toggle-switch:hover {
            transform: scale(1.05);
        }

        .toggle-knob {
            transition: all 0.3s ease;
        }

        .settings-search {
            transition: all 0.2s ease;
        }

        .settings-search:focus {
            outline: none;
            border-color: #E95420;
            box-shadow: 0 0 0 2px rgba(233, 84, 32, 0.2);
        }

        /* System Information Styles */
        .sysinfo-category {
            border-bottom: 1px solid #eee;
            transition: all 0.2s ease;
        }

        .sysinfo-category:hover {
            background: #e9ecef;
        }

        .sysinfo-category.active {
            background: #E95420;
            color: white;
            border-left: 4px solid #D44414;
        }

        .sysinfo-category.active div {
            color: white !important;
        }

        .sysinfo-usage-bar {
            width: 100%;
            height: 20px;
            background: #e9ecef;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }

        .sysinfo-usage-fill {
            height: 100%;
            border-radius: 10px;
            transition: width 0.5s ease;
        }

        .sysinfo-usage-fill.cpu {
            background: linear-gradient(90deg, #28a745, #20c997);
        }

        .sysinfo-usage-fill.memory {
            background: linear-gradient(90deg, #007bff, #6610f2);
        }

        .sysinfo-usage-fill.storage {
            background: linear-gradient(90deg, #fd7e14, #e83e8c);
        }

        .sysinfo-usage-fill.gpu {
            background: linear-gradient(90deg, #6f42c1, #e83e8c);
        }

        .sysinfo-stat-card {
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            transition: all 0.2s ease;
        }

        .sysinfo-stat-card:hover {
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .sysinfo-stat-value {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .sysinfo-stat-value.temperature {
            color: #dc3545;
        }

        .sysinfo-stat-value.frequency {
            color: #6610f2;
        }

        .sysinfo-stat-value.processes {
            color: #20c997;
        }

        .sysinfo-stat-value.uptime {
            color: #fd7e14;
        }

        .sysinfo-stat-label {
            color: #666;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Terminal Styles */
        .terminal-line {
            margin-bottom: 2px;
            word-wrap: break-word;
        }

        .terminal-prompt {
            color: #00ff00;
            font-weight: bold;
        }

        .terminal-output {
            font-family: 'Courier New', monospace;
            background: #1e1e1e;
            color: #ffffff;
        }

        .terminal-input {
            background: transparent;
            border: none;
            color: white;
            font-family: 'Courier New', monospace;
            outline: none;
        }

        .terminal-input:focus {
            outline: none;
        }

        .terminal-toolbar {
            background: #2d2d2d;
            border-bottom: 1px solid #444;
        }

        .terminal-button {
            background: #444;
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
            transition: background 0.2s;
        }

        .terminal-button:hover {
            background: #555;
        }

        .terminal-status {
            color: #888;
            font-size: 12px;
        }

        /* Terminal scrollbar */
        #terminal-output::-webkit-scrollbar {
            width: 8px;
        }

        #terminal-output::-webkit-scrollbar-track {
            background: #2d2d2d;
        }

        #terminal-output::-webkit-scrollbar-thumb {
            background: #555;
            border-radius: 4px;
        }

        #terminal-output::-webkit-scrollbar-thumb:hover {
            background: #666;
        }

        /* Window States */
        .window.minimized {
            transform: scale(0.1);
            opacity: 0;
            transition: all 0.3s ease;
        }

        .window.maximized {
            border-radius: 0;
        }

        .window {
            transition: transform 0.3s ease, opacity 0.3s ease;
        }

        .taskbar-item.minimized {
            opacity: 0.6;
            font-style: italic;
        }

        .taskbar-item:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        /* System Monitor Styles */
        .monitor-category {
            border-bottom: 1px solid #eee;
            transition: all 0.2s ease;
        }

        .monitor-category:hover {
            background: #e9ecef;
        }

        .monitor-category.active {
            background: #E95420;
            color: white;
            border-left: 4px solid #D44414;
        }

        .monitor-category.active div {
            color: white !important;
        }

        .process-row {
            transition: background-color 0.2s ease;
        }

        .process-row:hover {
            background-color: #f8f9fa !important;
        }

        .process-row.selected {
            background-color: #e3f2fd !important;
        }

        .monitor-card {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            transition: all 0.2s ease;
        }

        .monitor-card:hover {
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            border-color: #E95420;
        }

        .monitor-progress-bar {
            width: 100%;
            height: 8px;
            background: #e9ecef;
            border-radius: 4px;
            overflow: hidden;
        }

        .monitor-progress-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        .monitor-progress-fill.cpu {
            background: linear-gradient(90deg, #28a745, #20c997);
        }

        .monitor-progress-fill.memory {
            background: linear-gradient(90deg, #007bff, #6610f2);
        }

        .monitor-progress-fill.disk {
            background: linear-gradient(90deg, #fd7e14, #e83e8c);
        }

        .monitor-progress-fill.network {
            background: linear-gradient(90deg, #6f42c1, #e83e8c);
        }

        .monitor-table {
            width: 100%;
            border-collapse: collapse;
        }

        .monitor-table th {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #dee2e6;
            background: #f8f9fa;
            font-weight: 600;
            cursor: pointer;
        }

        .monitor-table th:hover {
            background: #e9ecef;
        }

        .monitor-table td {
            padding: 10px;
            border-bottom: 1px solid #f1f3f4;
        }

        .monitor-value {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .monitor-value.cpu {
            color: #28a745;
        }

        .monitor-value.memory {
            color: #007bff;
        }

        .monitor-value.disk {
            color: #fd7e14;
        }

        .monitor-value.network {
            color: #6f42c1;
        }

        .monitor-value.temperature {
            color: #dc3545;
        }

        .monitor-label {
            color: #666;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Video Player Styles */
        .video-player-container {
            background: #000;
            color: white;
        }

        .video-controls {
            background: #1a1a1a;
            border-top: 1px solid #333;
        }

        .video-control-btn {
            background: none;
            border: none;
            color: #fff;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .video-control-btn:hover {
            color: #E95420;
            transform: scale(1.1);
        }

        .play-pause-btn {
            background: #E95420;
            border: none;
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .play-pause-btn:hover {
            background: #D44414;
            transform: scale(1.05);
        }

        .progress-container {
            height: 6px;
            background: #333;
            border-radius: 3px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .progress-container:hover {
            height: 8px;
        }

        .progress-bar {
            height: 100%;
            background: #E95420;
            border-radius: 3px;
            transition: width 0.1s ease;
        }

        .volume-slider {
            width: 80px;
            height: 4px;
            background: #333;
            outline: none;
            border-radius: 2px;
        }

        .volume-slider::-webkit-slider-thumb {
            appearance: none;
            width: 12px;
            height: 12px;
            background: #E95420;
            border-radius: 50%;
            cursor: pointer;
        }

        .volume-slider::-moz-range-thumb {
            width: 12px;
            height: 12px;
            background: #E95420;
            border-radius: 50%;
            cursor: pointer;
            border: none;
        }

        .playlist-sidebar {
            background: #2a2a2a;
            border-left: 1px solid #444;
        }

        .playlist-item {
            transition: all 0.2s ease;
        }

        .playlist-item:hover .playlist-item-container {
            background: #555 !important;
        }

        .playlist-item.active .playlist-item-container {
            background: #E95420 !important;
        }

        .playlist-item-container {
            display: flex;
            align-items: center;
            padding: 10px;
            background: #444;
            border-radius: 6px;
            cursor: pointer;
            margin-bottom: 8px;
            transition: all 0.2s ease;
        }

        .video-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            color: white;
            backdrop-filter: blur(5px);
        }

        .video-thumbnail {
            width: 40px;
            height: 30px;
            background: #333;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #999;
            font-size: 12px;
        }

        .playlist-controls {
            display: flex;
            gap: 8px;
            margin-bottom: 10px;
        }

        .playlist-btn {
            flex: 1;
            border: none;
            padding: 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s ease;
        }

        .playlist-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .playlist-btn.primary {
            background: #E95420;
            color: white;
        }

        .playlist-btn.danger {
            background: #dc3545;
            color: white;
        }

        .playlist-btn.secondary {
            background: #6c757d;
            color: white;
        }

        /* Fullscreen video styles */
        .video-display-area:-webkit-full-screen {
            background: #000;
        }

        .video-display-area:-moz-full-screen {
            background: #000;
        }

        .video-display-area:fullscreen {
            background: #000;
        }

        /* Games Styles */
        .game-card {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            padding: 25px;
            border-radius: 12px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .game-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
            border-color: rgba(255, 255, 255, 0.3);
        }

        .game-card[data-game="snake"] {
            background: linear-gradient(135deg, #4CAF50, #45a049);
        }

        .game-card[data-game="tetris"] {
            background: linear-gradient(135deg, #2196F3, #1976D2);
        }

        .game-card[data-game="pong"] {
            background: linear-gradient(135deg, #FF9800, #F57C00);
        }

        .game-card[data-game="minesweeper"] {
            background: linear-gradient(135deg, #F44336, #D32F2F);
        }

        .game-card[data-game="chess"] {
            background: linear-gradient(135deg, #795548, #5D4037);
        }

        .game-card[data-game="solitaire"] {
            background: linear-gradient(135deg, #9C27B0, #7B1FA2);
        }

        .game-icon {
            font-size: 48px;
            margin-bottom: 15px;
            display: block;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .game-card h4 {
            margin: 10px 0 5px 0;
            font-size: 18px;
            font-weight: bold;
        }

        .game-card p {
            margin: 0 0 10px 0;
            opacity: 0.9;
            font-size: 14px;
        }

        .game-stats {
            font-size: 12px;
            opacity: 0.8;
            background: rgba(0, 0, 0, 0.2);
            padding: 5px 10px;
            border-radius: 15px;
            display: inline-block;
            margin-top: 5px;
        }

        /* Game Canvas Styles */
        .game-canvas {
            border: 2px solid #333;
            background: #000;
            display: block;
            margin: 0 auto;
        }

        .game-info {
            color: white;
            text-align: center;
            padding: 20px;
            font-family: 'Courier New', monospace;
        }

        .game-controls {
            color: white;
            text-align: center;
            padding: 10px;
            background: rgba(0, 0, 0, 0.5);
            font-size: 14px;
        }

        /* Snake Game Styles */
        .snake-segment {
            background: #4CAF50;
            border: 1px solid #45a049;
        }

        .snake-food {
            background: #F44336;
            border-radius: 50%;
        }

        /* Tetris Styles */
        .tetris-block {
            border: 1px solid #333;
        }

        .tetris-i { background: #00f0f0; }
        .tetris-o { background: #f0f000; }
        .tetris-t { background: #a000f0; }
        .tetris-s { background: #00f000; }
        .tetris-z { background: #f00000; }
        .tetris-j { background: #0000f0; }
        .tetris-l { background: #f0a000; }

        /* Pong Styles */
        .pong-paddle {
            background: white;
            border-radius: 4px;
        }

        .pong-ball {
            background: white;
            border-radius: 50%;
        }

        /* Minesweeper Styles */
        .mine-cell {
            width: 25px;
            height: 25px;
            border: 2px outset #c0c0c0;
            background: #c0c0c0;
            text-align: center;
            line-height: 21px;
            font-weight: bold;
            cursor: pointer;
            font-size: 12px;
        }

        .mine-cell.revealed {
            border: 1px inset #c0c0c0;
            background: #e0e0e0;
        }

        .mine-cell.flagged {
            background: #ffff00;
        }

        .mine-cell.mine {
            background: #ff0000;
        }

        /* Chess Styles */
        .chess-board {
            border: 2px solid #8B4513;
        }

        .chess-square {
            width: 50px;
            height: 50px;
            display: inline-block;
            text-align: center;
            line-height: 50px;
            font-size: 30px;
            cursor: pointer;
        }

        .chess-square.light {
            background: #F0D9B5;
        }

        .chess-square.dark {
            background: #B58863;
        }

        .chess-square.selected {
            background: #7FFF00 !important;
        }

        .chess-square.possible-move {
            background: #90EE90 !important;
        }

        /* Solitaire Styles */
        .card {
            width: 60px;
            height: 84px;
            border: 1px solid #333;
            border-radius: 6px;
            background: white;
            display: inline-block;
            margin: 2px;
            text-align: center;
            line-height: 84px;
            font-size: 12px;
            cursor: pointer;
            position: relative;
        }

        .card.red {
            color: #d32f2f;
        }

        .card.black {
            color: #000;
        }

        .card.face-down {
            background: #1976d2;
            color: white;
        }

        .card-stack {
            min-height: 100px;
            border: 2px dashed #666;
            border-radius: 6px;
            margin: 5px;
            padding: 5px;
        }

        /* File Manager Styles */
        .sidebar-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            cursor: pointer;
            border-radius: 4px;
            margin-bottom: 2px;
            font-size: 14px;
            transition: all 0.2s ease;
        }

        .sidebar-item:hover {
            background: #e9ecef;
        }

        .sidebar-item.active {
            background: #E95420;
            color: white;
        }

        .file-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 12px;
            cursor: pointer;
            border-radius: 4px;
            margin-bottom: 2px;
            transition: all 0.2s ease;
            border: 1px solid transparent;
        }

        .file-item:hover {
            background: #f8f9fa;
            border-color: #dee2e6;
        }

        .file-item.selected {
            background: #E95420;
            color: white;
            border-color: #D44414;
        }

        .file-item.grid-view {
            flex-direction: column;
            text-align: center;
            width: 100px;
            height: 100px;
            margin: 5px;
            padding: 10px;
        }

        .file-icon {
            font-size: 24px;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .file-icon.large {
            font-size: 48px;
            width: 64px;
            height: 64px;
        }

        .file-info {
            flex: 1;
            min-width: 0;
        }

        .file-name {
            font-weight: 500;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .file-details {
            font-size: 12px;
            color: #666;
            margin-top: 2px;
        }

        .file-size {
            font-size: 12px;
            color: #666;
            min-width: 80px;
            text-align: right;
        }

        .file-date {
            font-size: 12px;
            color: #666;
            min-width: 120px;
            text-align: right;
        }

        .file-list-header {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 12px;
            background: #f8f9fa;
            border-bottom: 1px solid #dee2e6;
            font-weight: 600;
            font-size: 14px;
            color: #333;
        }

        .file-list-header .header-name {
            flex: 1;
        }

        .file-list-header .header-size {
            min-width: 80px;
            text-align: right;
        }

        .file-list-header .header-date {
            min-width: 120px;
            text-align: right;
        }

        .file-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 10px;
            padding: 15px;
        }

        .file-list {
            display: flex;
            flex-direction: column;
        }

        .context-menu {
            position: absolute;
            background: white;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            z-index: 1000;
            min-width: 150px;
        }

        .context-menu-item {
            padding: 8px 12px;
            cursor: pointer;
            font-size: 14px;
            border-bottom: 1px solid #eee;
        }

        .context-menu-item:hover {
            background: #f8f9fa;
        }

        .context-menu-item:last-child {
            border-bottom: none;
        }

        .context-menu-separator {
            height: 1px;
            background: #eee;
            margin: 4px 0;
        }

        .file-toolbar-btn {
            background: #6c757d;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s ease;
        }

        .file-toolbar-btn:hover {
            background: #5a6268;
        }

        .file-toolbar-btn:disabled {
            background: #adb5bd;
            cursor: not-allowed;
        }

        .file-toolbar-btn.primary {
            background: #E95420;
        }

        .file-toolbar-btn.primary:hover {
            background: #D44414;
        }

        .file-toolbar-btn.success {
            background: #28a745;
        }

        .file-toolbar-btn.success:hover {
            background: #218838;
        }

        .file-toolbar-btn.info {
            background: #007bff;
        }

        .file-toolbar-btn.info:hover {
            background: #0056b3;
        }
    </style>
</head>
<body>
    <!-- Desktop -->
    <div class="desktop wallpaper-ocean-blue" id="desktop">
        <!-- Desktop Icons - Complete Application Suite -->
        <div class="desktop-icon" style="left: 50px; top: 50px;" onclick="openApp('terminal')">
            <div class="icon" style="background: #E95420;">🖥️</div>
            <div>Terminal</div>
        </div>

        <div class="desktop-icon" style="left: 50px; top: 150px;" onclick="openApp('files')">
            <div class="icon" style="background: #4A90E2;">📁</div>
            <div>Files</div>
        </div>

        <div class="desktop-icon" style="left: 50px; top: 250px;" onclick="openApp('editor')">
            <div class="icon" style="background: #28A745;">📝</div>
            <div>Text Editor</div>
        </div>

        <div class="desktop-icon" style="left: 50px; top: 350px;" onclick="openApp('monitor')">
            <div class="icon" style="background: #6F42C1;">📊</div>
            <div>System Monitor</div>
        </div>

        <div class="desktop-icon" style="left: 50px; top: 450px;" onclick="openApp('calculator')">
            <div class="icon" style="background: #FD7E14;">🧮</div>
            <div>Calculator</div>
        </div>

        <div class="desktop-icon" style="left: 150px; top: 50px;" onclick="openApp('settings')">
            <div class="icon" style="background: #6C757D;">⚙️</div>
            <div>Settings</div>
        </div>

        <div class="desktop-icon" style="left: 150px; top: 150px;" onclick="openApp('browser')">
            <div class="icon" style="background: #FF6B35;">🌐</div>
            <div>Web Browser</div>
        </div>

        <div class="desktop-icon" style="left: 150px; top: 250px;" onclick="openApp('package-manager')">
            <div class="icon" style="background: #20C997;">📦</div>
            <div>Package Manager</div>
        </div>

        <div class="desktop-icon" style="left: 150px; top: 350px;" onclick="openApp('image-viewer')">
            <div class="icon" style="background: #E91E63;">🖼️</div>
            <div>Image Viewer</div>
        </div>

        <div class="desktop-icon" style="left: 150px; top: 450px;" onclick="openApp('music-player')">
            <div class="icon" style="background: #9C27B0;">🎵</div>
            <div>Music Player</div>
        </div>

        <div class="desktop-icon" style="left: 250px; top: 50px;" onclick="openApp('video-player')">
            <div class="icon" style="background: #F44336;">🎬</div>
            <div>Video Player</div>
        </div>

        <div class="desktop-icon" style="left: 250px; top: 150px;" onclick="openApp('games')">
            <div class="icon" style="background: #795548;">🎮</div>
            <div>Games</div>
        </div>

        <div class="desktop-icon" style="left: 250px; top: 250px;" onclick="openApp('wallpaper-selector')">
            <div class="icon" style="background: #607D8B;">🎨</div>
            <div>Wallpapers</div>
        </div>

        <div class="desktop-icon" style="left: 250px; top: 350px;" onclick="openApp('app-store')">
            <div class="icon" style="background: #3F51B5;">🏪</div>
            <div>App Store</div>
        </div>

        <div class="desktop-icon" style="left: 250px; top: 450px;" onclick="openApp('system-info')">
            <div class="icon" style="background: #009688;">ℹ️</div>
            <div>System Info</div>
        </div>

        <!-- Test Buttons -->
        <div style="position: absolute; top: 10px; right: 10px; z-index: 10000; display: flex; gap: 10px;">
            <button onclick="openApp('terminal')" style="background: #E95420; color: white; border: none; padding: 10px 15px; border-radius: 5px; cursor: pointer; font-weight: bold;">Open Terminal</button>
            <button onclick="openApp('files')" style="background: #4A90E2; color: white; border: none; padding: 10px 15px; border-radius: 5px; cursor: pointer; font-weight: bold;">Open Files</button>
            <button onclick="openApp('calculator')" style="background: #FD7E14; color: white; border: none; padding: 10px 15px; border-radius: 5px; cursor: pointer; font-weight: bold;">Open Calculator</button>
        </div>

        <!-- File Manager Window -->
        <div class="window" id="file-manager-window" style="left: 150px; top: 80px; width: 900px; height: 650px;">
            <div class="window-header" onmousedown="startDrag(event, 'file-manager-window')">
                <div class="window-title">File Manager - Kronos Files</div>
                <div class="window-controls">
                    <button class="window-control minimize" onclick="minimizeWindow('file-manager-window')">−</button>
                    <button class="window-control maximize" onclick="maximizeWindow('file-manager-window')">□</button>
                    <button class="window-control close" onclick="closeWindow('file-manager-window')">×</button>
                </div>
            </div>
            <div class="window-content" style="padding: 0; overflow: hidden;">
                <!-- File Manager Interface -->
                <div style="display: flex; flex-direction: column; height: 100%;">
                    <!-- Toolbar -->
                    <div id="file-toolbar" style="background: #f8f9fa; border-bottom: 1px solid #dee2e6; padding: 10px 15px; display: flex; align-items: center; gap: 10px;">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <button onclick="navigateBack()" id="back-btn" style="background: #6c757d; color: white; border: none; padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 14px;" disabled>← Back</button>
                            <button onclick="navigateForward()" id="forward-btn" style="background: #6c757d; color: white; border: none; padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 14px;" disabled>Forward →</button>
                            <button onclick="navigateUp()" id="up-btn" style="background: #6c757d; color: white; border: none; padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 14px;">↑ Up</button>
                            <button onclick="refreshFiles()" style="background: #28a745; color: white; border: none; padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 14px;">🔄 Refresh</button>
                        </div>

                        <div style="flex: 1; display: flex; align-items: center; gap: 10px;">
                            <div style="display: flex; align-items: center; gap: 5px; background: white; border: 1px solid #ced4da; border-radius: 4px; padding: 6px 10px; flex: 1; max-width: 400px;">
                                <span style="color: #666; font-size: 14px;">📁</span>
                                <input type="text" id="address-bar" value="/home/user" style="border: none; outline: none; flex: 1; font-size: 14px;" onkeypress="handleAddressBarEnter(event)">
                            </div>
                            <div style="display: flex; align-items: center; gap: 5px; background: white; border: 1px solid #ced4da; border-radius: 4px; padding: 6px 10px; width: 250px;">
                                <span style="color: #666; font-size: 14px;">🔍</span>
                                <input type="text" id="search-box" placeholder="Search files..." style="border: none; outline: none; flex: 1; font-size: 14px;" oninput="searchFiles(this.value)">
                            </div>
                        </div>

                        <div style="display: flex; align-items: center; gap: 8px;">
                            <button onclick="toggleViewMode()" id="view-mode-btn" style="background: #007bff; color: white; border: none; padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 14px;">📋 List</button>
                            <button onclick="showNewMenu()" style="background: #E95420; color: white; border: none; padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 14px;">+ New</button>
                        </div>
                    </div>

                    <!-- Main Content Area -->
                    <div style="display: flex; flex: 1; overflow: hidden;">
                        <!-- Sidebar -->
                        <div id="file-sidebar" style="width: 200px; background: #f8f9fa; border-right: 1px solid #dee2e6; overflow-y: auto;">
                            <div style="padding: 15px 10px;">
                                <h4 style="margin-bottom: 10px; color: #333; font-size: 14px;">Quick Access</h4>
                                <div class="sidebar-item active" onclick="navigateToPath('/home/user')" data-path="/home/user">
                                    <span>🏠</span>
                                    <span>Home</span>
                                </div>
                                <div class="sidebar-item" onclick="navigateToPath('/home/user/Desktop')" data-path="/home/user/Desktop">
                                    <span>🖥️</span>
                                    <span>Desktop</span>
                                </div>
                                <div class="sidebar-item" onclick="navigateToPath('/home/user/Documents')" data-path="/home/user/Documents">
                                    <span>📄</span>
                                    <span>Documents</span>
                                </div>
                                <div class="sidebar-item" onclick="navigateToPath('/home/user/Downloads')" data-path="/home/user/Downloads">
                                    <span>📥</span>
                                    <span>Downloads</span>
                                </div>
                                <div class="sidebar-item" onclick="navigateToPath('/home/user/Pictures')" data-path="/home/user/Pictures">
                                    <span>🖼️</span>
                                    <span>Pictures</span>
                                </div>
                                <div class="sidebar-item" onclick="navigateToPath('/home/user/Music')" data-path="/home/user/Music">
                                    <span>🎵</span>
                                    <span>Music</span>
                                </div>
                                <div class="sidebar-item" onclick="navigateToPath('/home/user/Videos')" data-path="/home/user/Videos">
                                    <span>🎬</span>
                                    <span>Videos</span>
                                </div>
                            </div>

                            <div style="padding: 15px 10px; border-top: 1px solid #dee2e6;">
                                <h4 style="margin-bottom: 10px; color: #333; font-size: 14px;">Devices</h4>
                                <div class="sidebar-item" onclick="navigateToPath('/')" data-path="/">
                                    <span>💿</span>
                                    <span>System (C:)</span>
                                </div>
                                <div class="sidebar-item" onclick="navigateToPath('/media/usb')" data-path="/media/usb">
                                    <span>🔌</span>
                                    <span>USB Drive</span>
                                </div>
                                <div class="sidebar-item" onclick="navigateToPath('/media/cdrom')" data-path="/media/cdrom">
                                    <span>💽</span>
                                    <span>CD/DVD</span>
                                </div>
                            </div>
                        </div>

                        <!-- File Area -->
                        <div style="flex: 1; display: flex; flex-direction: column;">
                            <!-- Breadcrumb -->
                            <div id="breadcrumb" style="background: #fff; border-bottom: 1px solid #dee2e6; padding: 10px 15px; display: flex; align-items: center; gap: 5px; font-size: 14px;">
                                <span onclick="navigateToPath('/')" style="cursor: pointer; color: #007bff;">🏠</span>
                                <span style="color: #666;">></span>
                                <span onclick="navigateToPath('/home')" style="cursor: pointer; color: #007bff;">home</span>
                                <span style="color: #666;">></span>
                                <span onclick="navigateToPath('/home/user')" style="cursor: pointer; color: #007bff;">user</span>
                            </div>

                            <!-- File List -->
                            <div id="file-list" style="flex: 1; padding: 15px; overflow-y: auto; background: white;">
                                <!-- Files will be populated here -->
                            </div>
                        </div>
                    </div>

                    <!-- Status Bar -->
                    <div id="status-bar" style="background: #f8f9fa; border-top: 1px solid #dee2e6; padding: 8px 15px; display: flex; justify-content: space-between; align-items: center; font-size: 12px; color: #666;">
                        <div id="status-text">Ready</div>
                        <div id="file-count">0 items</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Calculator Window -->
        <div class="window" id="calculator-window" style="left: 200px; top: 100px; width: 350px; height: 500px;">
            <div class="window-header">
                <div class="window-title">Calculator - Advanced Scientific</div>
                <div class="window-controls">
                    <button class="window-control minimize" onclick="minimizeWindow('calculator-window')">−</button>
                    <button class="window-control maximize" onclick="maximizeWindow('calculator-window')">□</button>
                    <button class="window-control close" onclick="closeWindow('calculator-window')">×</button>
                </div>
            </div>
            <div class="window-content">
                <div class="calculator">
                    <div class="calc-display" id="calc-display">0</div>
                    <div class="calc-buttons">
                        <button class="calc-button clear" onclick="calcInput('C')">C</button>
                        <button class="calc-button clear" onclick="calcInput('CE')">CE</button>
                        <button class="calc-button clear" onclick="calcInput('⌫')">⌫</button>
                        <button class="calc-button operator" onclick="calcInput('/')">÷</button>

                        <button class="calc-button number" onclick="calcInput('7')">7</button>
                        <button class="calc-button number" onclick="calcInput('8')">8</button>
                        <button class="calc-button number" onclick="calcInput('9')">9</button>
                        <button class="calc-button operator" onclick="calcInput('*')">×</button>

                        <button class="calc-button number" onclick="calcInput('4')">4</button>
                        <button class="calc-button number" onclick="calcInput('5')">5</button>
                        <button class="calc-button number" onclick="calcInput('6')">6</button>
                        <button class="calc-button operator" onclick="calcInput('-')">−</button>

                        <button class="calc-button number" onclick="calcInput('1')">1</button>
                        <button class="calc-button number" onclick="calcInput('2')">2</button>
                        <button class="calc-button number" onclick="calcInput('3')">3</button>
                        <button class="calc-button operator" onclick="calcInput('+')">+</button>

                        <button class="calc-button function" onclick="calcInput('±')">±</button>
                        <button class="calc-button number" onclick="calcInput('0')">0</button>
                        <button class="calc-button number" onclick="calcInput('.')">.</button>
                        <button class="calc-button operator" onclick="calcInput('=')">=</button>
                    </div>
                    <div style="margin-top: 15px;">
                        <button class="calc-button function" onclick="calcInput('sin')" style="margin: 2px;">sin</button>
                        <button class="calc-button function" onclick="calcInput('cos')" style="margin: 2px;">cos</button>
                        <button class="calc-button function" onclick="calcInput('tan')" style="margin: 2px;">tan</button>
                        <button class="calc-button function" onclick="calcInput('√')" style="margin: 2px;">√</button>
                        <button class="calc-button function" onclick="calcInput('x²')" style="margin: 2px;">x²</button>
                        <button class="calc-button function" onclick="calcInput('π')" style="margin: 2px;">π</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Wallpaper Selector Window -->
        <div class="window" id="wallpaper-selector-window" style="left: 300px; top: 80px; width: 600px; height: 500px;">
            <div class="window-header">
                <div class="window-title">Wallpaper Selector - Beautiful Backgrounds</div>
                <div class="window-controls">
                    <button class="window-control minimize" onclick="minimizeWindow('wallpaper-selector-window')">−</button>
                    <button class="window-control maximize" onclick="maximizeWindow('wallpaper-selector-window')">□</button>
                    <button class="window-control close" onclick="closeWindow('wallpaper-selector-window')">×</button>
                </div>
            </div>
            <div class="window-content">
                <div class="wallpaper-selector">
                    <h3>Choose Your Desktop Wallpaper</h3>
                    <div class="wallpaper-grid" id="wallpaper-grid">
                        <div class="wallpaper-item selected" onclick="selectWallpaper('ocean-blue')">
                            <div class="wallpaper-preview" style="background: linear-gradient(135deg, #4A90E2 0%, #357ABD 100%);"></div>
                            <div class="wallpaper-name">Ocean Blue</div>
                        </div>
                        <div class="wallpaper-item" onclick="selectWallpaper('ubuntu-orange')">
                            <div class="wallpaper-preview" style="background: linear-gradient(135deg, #E95420 0%, #772953 100%);"></div>
                            <div class="wallpaper-name">Ubuntu Orange</div>
                        </div>
                        <div class="wallpaper-item" onclick="selectWallpaper('forest-green')">
                            <div class="wallpaper-preview" style="background: linear-gradient(135deg, #28A745 0%, #155724 100%);"></div>
                            <div class="wallpaper-name">Forest Green</div>
                        </div>
                        <div class="wallpaper-item" onclick="selectWallpaper('sunset-purple')">
                            <div class="wallpaper-preview" style="background: linear-gradient(135deg, #6F42C1 0%, #4C2A85 100%);"></div>
                            <div class="wallpaper-name">Sunset Purple</div>
                        </div>
                        <div class="wallpaper-item" onclick="selectWallpaper('deep-space')">
                            <div class="wallpaper-preview" style="background: linear-gradient(135deg, #000033 0%, #000066 100%);"></div>
                            <div class="wallpaper-name">Deep Space</div>
                        </div>
                        <div class="wallpaper-item" onclick="selectWallpaper('cherry-blossom')">
                            <div class="wallpaper-preview" style="background: linear-gradient(135deg, #FF69B4 0%, #FF1493 100%);"></div>
                            <div class="wallpaper-name">Cherry Blossom</div>
                        </div>
                        <div class="wallpaper-item" onclick="selectWallpaper('arctic-blue')">
                            <div class="wallpaper-preview" style="background: linear-gradient(135deg, #87CEEB 0%, #4682B4 100%);"></div>
                            <div class="wallpaper-name">Arctic Blue</div>
                        </div>
                        <div class="wallpaper-item" onclick="selectWallpaper('autumn-gold')">
                            <div class="wallpaper-preview" style="background: linear-gradient(135deg, #FFD700 0%, #FF8C00 100%);"></div>
                            <div class="wallpaper-name">Autumn Gold</div>
                        </div>
                        <div class="wallpaper-item" onclick="selectWallpaper('matrix-green')">
                            <div class="wallpaper-preview" style="background: linear-gradient(135deg, #00FF00 0%, #008000 100%);"></div>
                            <div class="wallpaper-name">Matrix Green</div>
                        </div>
                    </div>
                    <div style="margin-top: 20px; text-align: center;">
                        <button onclick="applyWallpaper()" style="background: #E95420; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; margin-right: 10px;">Apply</button>
                        <button onclick="closeWindow('wallpaper-selector-window')" style="background: #6c757d; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer;">Cancel</button>
                    </div>
                    <div style="margin-top: 15px;">
                        <label>
                            <input type="checkbox" id="slideshow-enabled" onchange="toggleSlideshow()">
                            Enable Slideshow (changes every 10 seconds)
                        </label>
                    </div>
                </div>
            </div>
        </div>

        <!-- Package Manager Window -->
        <div class="window" id="package-manager-window" style="left: 250px; top: 120px; width: 800px; height: 600px;">
            <div class="window-header">
                <div class="window-title">Package Manager - Software Center</div>
                <div class="window-controls">
                    <button class="window-control minimize" onclick="minimizeWindow('package-manager-window')">−</button>
                    <button class="window-control maximize" onclick="maximizeWindow('package-manager-window')">□</button>
                    <button class="window-control close" onclick="closeWindow('package-manager-window')">×</button>
                </div>
            </div>
            <div class="window-content">
                <div style="padding: 20px;">
                    <h3>Kronos Package Manager</h3>
                    <div style="margin: 20px 0; display: flex; gap: 10px;">
                        <button onclick="packageAction('update')" style="background: #007bff; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer;">Update</button>
                        <button onclick="packageAction('upgrade')" style="background: #28a745; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer;">Upgrade All</button>
                        <input type="text" placeholder="Search packages..." style="flex: 1; padding: 8px; border: 1px solid #ccc; border-radius: 4px;">
                    </div>
                    <div style="border: 1px solid #ddd; border-radius: 4px; max-height: 400px; overflow-y: auto;">
                        <div style="padding: 15px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <strong>Firefox Web Browser</strong><br>
                                <small style="color: #666;">Mozilla Firefox - Fast, secure web browser</small>
                            </div>
                            <button onclick="installPackage('firefox')" style="background: #28a745; color: white; border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer;">Install</button>
                        </div>
                        <div style="padding: 15px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <strong>LibreOffice</strong><br>
                                <small style="color: #666;">Complete office productivity suite</small>
                            </div>
                            <button onclick="installPackage('libreoffice')" style="background: #28a745; color: white; border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer;">Install</button>
                        </div>
                        <div style="padding: 15px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <strong>GIMP</strong><br>
                                <small style="color: #666;">GNU Image Manipulation Program</small>
                            </div>
                            <button onclick="installPackage('gimp')" style="background: #28a745; color: white; border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer;">Install</button>
                        </div>
                        <div style="padding: 15px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <strong>VLC Media Player</strong><br>
                                <small style="color: #666;">Multimedia player for various formats</small>
                            </div>
                            <span style="color: #28a745; font-weight: bold;">✓ Installed</span>
                        </div>
                        <div style="padding: 15px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <strong>Visual Studio Code</strong><br>
                                <small style="color: #666;">Advanced code editor</small>
                            </div>
                            <button onclick="installPackage('vscode')" style="background: #28a745; color: white; border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer;">Install</button>
                        </div>
                        <div style="padding: 15px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <strong>Docker</strong><br>
                                <small style="color: #666;">Container platform</small>
                            </div>
                            <button onclick="upgradePackage('docker')" style="background: #ffc107; color: #333; border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer;">Upgrade</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Music Player Window -->
        <div class="window" id="music-player-window" style="left: 350px; top: 150px; width: 500px; height: 400px;">
            <div class="window-header">
                <div class="window-title">Music Player - Kronos Audio</div>
                <div class="window-controls">
                    <button class="window-control minimize" onclick="minimizeWindow('music-player-window')">−</button>
                    <button class="window-control maximize" onclick="maximizeWindow('music-player-window')">□</button>
                    <button class="window-control close" onclick="closeWindow('music-player-window')">×</button>
                </div>
            </div>
            <div class="window-content">
                <div style="padding: 20px; text-align: center;">
                    <div style="background: linear-gradient(135deg, #9C27B0, #673AB7); color: white; padding: 40px; border-radius: 8px; margin-bottom: 20px;">
                        <h2>🎵 Now Playing</h2>
                        <h3 style="margin: 10px 0;">Kronos OS Theme Song</h3>
                        <p>by Kronos Development Team</p>
                        <div style="margin: 20px 0;">
                            <div style="background: rgba(255,255,255,0.3); height: 4px; border-radius: 2px; position: relative;">
                                <div style="background: white; height: 4px; width: 35%; border-radius: 2px;"></div>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-top: 5px; font-size: 12px;">
                                <span>1:23</span>
                                <span>3:45</span>
                            </div>
                        </div>
                    </div>
                    <div style="display: flex; justify-content: center; gap: 15px; margin-bottom: 20px;">
                        <button onclick="musicControl('prev')" style="background: #9C27B0; color: white; border: none; padding: 12px; border-radius: 50%; cursor: pointer; font-size: 16px;">⏮️</button>
                        <button onclick="musicControl('play')" style="background: #9C27B0; color: white; border: none; padding: 12px 16px; border-radius: 50%; cursor: pointer; font-size: 20px;">⏸️</button>
                        <button onclick="musicControl('next')" style="background: #9C27B0; color: white; border: none; padding: 12px; border-radius: 50%; cursor: pointer; font-size: 16px;">⏭️</button>
                    </div>
                    <div style="text-align: left;">
                        <h4>Playlist</h4>
                        <div style="border: 1px solid #ddd; border-radius: 4px; max-height: 150px; overflow-y: auto;">
                            <div style="padding: 10px; border-bottom: 1px solid #eee; background: #f0f0f0;">🎵 Kronos OS Theme Song</div>
                            <div style="padding: 10px; border-bottom: 1px solid #eee; cursor: pointer;" onclick="playTrack('startup')">🎵 System Startup Sound</div>
                            <div style="padding: 10px; border-bottom: 1px solid #eee; cursor: pointer;" onclick="playTrack('notification')">🎵 Notification Chime</div>
                            <div style="padding: 10px; cursor: pointer;" onclick="playTrack('shutdown')">🎵 Shutdown Melody</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Advanced Settings Window -->
        <div class="window" id="settings-window" style="left: 150px; top: 80px; width: 900px; height: 650px;">
            <div class="window-header">
                <div class="window-title">Settings - Advanced System Configuration</div>
                <div class="window-controls">
                    <button class="window-control minimize" onclick="minimizeWindow('settings-window')">−</button>
                    <button class="window-control maximize" onclick="maximizeWindow('settings-window')">□</button>
                    <button class="window-control close" onclick="closeWindow('settings-window')">×</button>
                </div>
            </div>
            <div class="window-content" style="padding: 0;">
                <div style="display: flex; height: 100%;">
                    <!-- Settings Sidebar -->
                    <div style="width: 250px; background: #f8f9fa; border-right: 1px solid #dee2e6; overflow-y: auto;">
                        <div style="padding: 15px; border-bottom: 1px solid #eee;">
                            <input type="text" placeholder="Search settings..." style="width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px;" oninput="searchSettings(this.value)">
                        </div>
                        <div class="settings-category active" onclick="selectSettingsCategory('appearance')" data-category="appearance">
                            <div style="display: flex; align-items: center; padding: 12px 15px; cursor: pointer;">
                                <span style="margin-right: 10px; font-size: 18px;">🎨</span>
                                <div>
                                    <div style="font-weight: 600;">Appearance</div>
                                    <div style="font-size: 12px; color: #666;">Theme, wallpaper, visual</div>
                                </div>
                            </div>
                        </div>
                        <div class="settings-category" onclick="selectSettingsCategory('display')" data-category="display">
                            <div style="display: flex; align-items: center; padding: 12px 15px; cursor: pointer;">
                                <span style="margin-right: 10px; font-size: 18px;">🖥️</span>
                                <div>
                                    <div style="font-weight: 600;">Display</div>
                                    <div style="font-size: 12px; color: #666;">Resolution, brightness</div>
                                </div>
                            </div>
                        </div>
                        <div class="settings-category" onclick="selectSettingsCategory('audio')" data-category="audio">
                            <div style="display: flex; align-items: center; padding: 12px 15px; cursor: pointer;">
                                <span style="margin-right: 10px; font-size: 18px;">🔊</span>
                                <div>
                                    <div style="font-weight: 600;">Audio</div>
                                    <div style="font-size: 12px; color: #666;">Sound, volume, devices</div>
                                </div>
                            </div>
                        </div>
                        <div class="settings-category" onclick="selectSettingsCategory('network')" data-category="network">
                            <div style="display: flex; align-items: center; padding: 12px 15px; cursor: pointer;">
                                <span style="margin-right: 10px; font-size: 18px;">🌐</span>
                                <div>
                                    <div style="font-weight: 600;">Network</div>
                                    <div style="font-size: 12px; color: #666;">WiFi, Ethernet, firewall</div>
                                </div>
                            </div>
                        </div>
                        <div class="settings-category" onclick="selectSettingsCategory('security')" data-category="security">
                            <div style="display: flex; align-items: center; padding: 12px 15px; cursor: pointer;">
                                <span style="margin-right: 10px; font-size: 18px;">🔒</span>
                                <div>
                                    <div style="font-weight: 600;">Security</div>
                                    <div style="font-size: 12px; color: #666;">Passwords, encryption</div>
                                </div>
                            </div>
                        </div>
                        <div class="settings-category" onclick="selectSettingsCategory('performance')" data-category="performance">
                            <div style="display: flex; align-items: center; padding: 12px 15px; cursor: pointer;">
                                <span style="margin-right: 10px; font-size: 18px;">⚡</span>
                                <div>
                                    <div style="font-weight: 600;">Performance</div>
                                    <div style="font-size: 12px; color: #666;">CPU, memory, power</div>
                                </div>
                            </div>
                        </div>
                        <div class="settings-category" onclick="selectSettingsCategory('system')" data-category="system">
                            <div style="display: flex; align-items: center; padding: 12px 15px; cursor: pointer;">
                                <span style="margin-right: 10px; font-size: 18px;">ℹ️</span>
                                <div>
                                    <div style="font-weight: 600;">System Info</div>
                                    <div style="font-size: 12px; color: #666;">Hardware, about</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Settings Content -->
                    <div style="flex: 1; padding: 20px; overflow-y: auto;" id="settings-content">
                        <!-- Appearance Settings (Default) -->
                        <h3 style="margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                            <span>🎨</span>
                            <span>Appearance Settings</span>
                        </h3>

                        <div class="setting-item" style="background: white; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px; margin-bottom: 15px;">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <div style="font-weight: 600; margin-bottom: 4px;">Dark Theme</div>
                                    <div style="color: #666; font-size: 14px;">Use dark colors for the desktop and applications</div>
                                </div>
                                <div class="toggle-switch" onclick="toggleSystemSetting(this, 'darkTheme')" style="width: 50px; height: 24px; background: #ccc; border-radius: 12px; position: relative; cursor: pointer; transition: all 0.3s;">
                                    <div class="toggle-knob" style="position: absolute; top: 2px; left: 2px; width: 20px; height: 20px; background: white; border-radius: 50%; transition: all 0.3s; box-shadow: 0 2px 4px rgba(0,0,0,0.2);"></div>
                                </div>
                            </div>
                        </div>

                        <div class="setting-item" style="background: white; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px; margin-bottom: 15px;">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <div style="font-weight: 600; margin-bottom: 4px;">Window Animations</div>
                                    <div style="color: #666; font-size: 14px;">Enable smooth transitions and effects</div>
                                </div>
                                <div class="toggle-switch active" onclick="toggleSystemSetting(this, 'animations')" style="width: 50px; height: 24px; background: #E95420; border-radius: 12px; position: relative; cursor: pointer; transition: all 0.3s;">
                                    <div class="toggle-knob" style="position: absolute; top: 2px; left: 28px; width: 20px; height: 20px; background: white; border-radius: 50%; transition: all 0.3s; box-shadow: 0 2px 4px rgba(0,0,0,0.2);"></div>
                                </div>
                            </div>
                        </div>

                        <div class="setting-item" style="background: white; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px; margin-bottom: 15px;">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <div style="font-weight: 600; margin-bottom: 4px;">Desktop Wallpaper</div>
                                    <div style="color: #666; font-size: 14px;">Choose your desktop background</div>
                                </div>
                                <button onclick="openApp('wallpaper-selector')" style="background: #E95420; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer;">Change...</button>
                            </div>
                        </div>

                        <div class="setting-item" style="background: white; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px; margin-bottom: 15px;">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <div style="font-weight: 600; margin-bottom: 4px;">Icon Size</div>
                                    <div style="color: #666; font-size: 14px;">Size of desktop and application icons</div>
                                </div>
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <div style="width: 100px; height: 4px; background: #ddd; border-radius: 2px; position: relative; cursor: pointer;" onclick="setIconSize(event)">
                                        <div style="width: 50%; height: 100%; background: #E95420; border-radius: 2px;"></div>
                                        <div style="position: absolute; top: -6px; left: calc(50% - 8px); width: 16px; height: 16px; background: #E95420; border-radius: 50%; cursor: pointer;"></div>
                                    </div>
                                    <span style="font-weight: 600; min-width: 40px;">48px</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Terminal Window -->
        <div class="window" id="terminal-window" style="left: 200px; top: 100px; width: 800px; height: 600px;">
            <div class="window-header" onmousedown="startDrag(event, 'terminal-window')">
                <div class="window-title">Terminal - Kronos Shell (ksh)</div>
                <div class="window-controls">
                    <button class="window-control minimize" onclick="minimizeWindow('terminal-window')">−</button>
                    <button class="window-control maximize" onclick="maximizeWindow('terminal-window')">□</button>
                    <button class="window-control close" onclick="closeWindow('terminal-window')">×</button>
                </div>
            </div>
            <div class="window-content" style="padding: 0; background: #1e1e1e; color: #ffffff; font-family: 'Courier New', monospace; overflow: hidden;">
                <!-- Terminal Toolbar -->
                <div style="background: #2d2d2d; border-bottom: 1px solid #444; padding: 8px 12px; display: flex; align-items: center; gap: 10px;">
                    <button onclick="clearTerminal()" style="background: #444; color: white; border: none; padding: 4px 8px; border-radius: 3px; cursor: pointer; font-size: 12px;">Clear</button>
                    <button onclick="copyTerminalOutput()" style="background: #444; color: white; border: none; padding: 4px 8px; border-radius: 3px; cursor: pointer; font-size: 12px;">Copy</button>
                    <button onclick="pasteToTerminal()" style="background: #444; color: white; border: none; padding: 4px 8px; border-radius: 3px; cursor: pointer; font-size: 12px;">Paste</button>
                    <div style="margin-left: auto; font-size: 12px; color: #888;">
                        <span id="terminal-status">Ready</span>
                    </div>
                </div>

                <!-- Terminal Output Area -->
                <div id="terminal-output" style="height: 500px; overflow-y: auto; padding: 15px; background: #1e1e1e; font-size: 14px; line-height: 1.4;">
                    <div style="color: #00ff00; margin-bottom: 10px;">
                        Kronos OS Terminal v2.0.1 - Advanced Shell Environment<br>
                        Copyright (c) 2024 Kronos OS Project. All rights reserved.<br>
                        Type 'help' for available commands.<br><br>
                    </div>
                    <div id="terminal-content">
                        <div class="terminal-line">
                            <span class="terminal-prompt">user@kronos-desktop:~$ </span>
                        </div>
                    </div>
                </div>

                <!-- Terminal Input Area -->
                <div style="background: #2d2d2d; border-top: 1px solid #444; padding: 8px 15px; display: flex; align-items: center;">
                    <span class="terminal-prompt" style="color: #00ff00; margin-right: 8px;">user@kronos-desktop:~$ </span>
                    <input type="text" id="terminal-input" style="flex: 1; background: transparent; border: none; color: white; font-family: 'Courier New', monospace; font-size: 14px; outline: none;" placeholder="Enter command..." onkeypress="handleTerminalInput(event)" autocomplete="off">
                </div>
            </div>
        </div>

        <!-- System Information Window -->
        <div class="window" id="system-info-window" style="left: 100px; top: 60px; width: 900px; height: 650px;">
            <div class="window-header">
                <div class="window-title">System Information - Hardware & Software Details</div>
                <div class="window-controls">
                    <button class="window-control minimize" onclick="minimizeWindow('system-info-window')">−</button>
                    <button class="window-control maximize" onclick="maximizeWindow('system-info-window')">□</button>
                    <button class="window-control close" onclick="closeWindow('system-info-window')">×</button>
                </div>
            </div>
            <div class="window-content" style="padding: 0;">
                <div style="display: flex; height: 100%;">
                    <!-- System Info Sidebar -->
                    <div style="width: 200px; background: #f8f9fa; border-right: 1px solid #dee2e6; overflow-y: auto;">
                        <div style="padding: 15px; border-bottom: 1px solid #eee;">
                            <button onclick="refreshSystemInfo()" style="width: 100%; padding: 8px; background: #28A745; color: white; border: none; border-radius: 4px; cursor: pointer;">🔄 Refresh</button>
                        </div>
                        <div class="sysinfo-category active" onclick="selectSystemInfoCategory('overview')" data-category="overview">
                            <div style="display: flex; align-items: center; padding: 12px 15px; cursor: pointer;">
                                <span style="margin-right: 10px; font-size: 18px;">📊</span>
                                <div>
                                    <div style="font-weight: 600;">Overview</div>
                                    <div style="font-size: 12px; color: #666;">System summary</div>
                                </div>
                            </div>
                        </div>
                        <div class="sysinfo-category" onclick="selectSystemInfoCategory('cpu')" data-category="cpu">
                            <div style="display: flex; align-items: center; padding: 12px 15px; cursor: pointer;">
                                <span style="margin-right: 10px; font-size: 18px;">🖥️</span>
                                <div>
                                    <div style="font-weight: 600;">Processor</div>
                                    <div style="font-size: 12px; color: #666;">CPU details</div>
                                </div>
                            </div>
                        </div>
                        <div class="sysinfo-category" onclick="selectSystemInfoCategory('memory')" data-category="memory">
                            <div style="display: flex; align-items: center; padding: 12px 15px; cursor: pointer;">
                                <span style="margin-right: 10px; font-size: 18px;">💾</span>
                                <div>
                                    <div style="font-weight: 600;">Memory</div>
                                    <div style="font-size: 12px; color: #666;">RAM info</div>
                                </div>
                            </div>
                        </div>
                        <div class="sysinfo-category" onclick="selectSystemInfoCategory('storage')" data-category="storage">
                            <div style="display: flex; align-items: center; padding: 12px 15px; cursor: pointer;">
                                <span style="margin-right: 10px; font-size: 18px;">💿</span>
                                <div>
                                    <div style="font-weight: 600;">Storage</div>
                                    <div style="font-size: 12px; color: #666;">Disks & drives</div>
                                </div>
                            </div>
                        </div>
                        <div class="sysinfo-category" onclick="selectSystemInfoCategory('graphics')" data-category="graphics">
                            <div style="display: flex; align-items: center; padding: 12px 15px; cursor: pointer;">
                                <span style="margin-right: 10px; font-size: 18px;">🎮</span>
                                <div>
                                    <div style="font-weight: 600;">Graphics</div>
                                    <div style="font-size: 12px; color: #666;">GPU info</div>
                                </div>
                            </div>
                        </div>
                        <div class="sysinfo-category" onclick="selectSystemInfoCategory('network')" data-category="network">
                            <div style="display: flex; align-items: center; padding: 12px 15px; cursor: pointer;">
                                <span style="margin-right: 10px; font-size: 18px;">🌐</span>
                                <div>
                                    <div style="font-weight: 600;">Network</div>
                                    <div style="font-size: 12px; color: #666;">Connections</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- System Info Content -->
                    <div style="flex: 1; padding: 20px; overflow-y: auto;" id="system-info-content">
                        <!-- Overview Content (Default) -->
                        <h3 style="margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                            <span>📊</span>
                            <span>System Overview</span>
                        </h3>

                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 20px;">
                            <div style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px;">
                                <h4 style="margin-bottom: 15px; color: #333;">Operating System</h4>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span style="color: #666;">OS Name:</span>
                                    <span style="font-weight: 600;">Kronos OS Advanced</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span style="color: #666;">Version:</span>
                                    <span style="font-weight: 600;">2.0.1 LTS</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span style="color: #666;">Kernel:</span>
                                    <span style="font-weight: 600;">5.15.0-kronos</span>
                                </div>
                                <div style="display: flex; justify-content: space-between;">
                                    <span style="color: #666;">Architecture:</span>
                                    <span style="font-weight: 600;">x86_64</span>
                                </div>
                            </div>

                            <div style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px;">
                                <h4 style="margin-bottom: 15px; color: #333;">Hardware Summary</h4>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span style="color: #666;">Processor:</span>
                                    <span style="font-weight: 600;">Intel Core i7-8550U</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span style="color: #666;">Memory:</span>
                                    <span style="font-weight: 600;">8.0 GB RAM</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span style="color: #666;">Storage:</span>
                                    <span style="font-weight: 600;">256 GB SSD</span>
                                </div>
                                <div style="display: flex; justify-content: space-between;">
                                    <span style="color: #666;">Graphics:</span>
                                    <span style="font-weight: 600;">Intel UHD 620</span>
                                </div>
                            </div>
                        </div>

                        <!-- Resource Usage -->
                        <div style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px;">
                            <h4 style="margin-bottom: 15px; color: #333;">Resource Usage</h4>

                            <!-- CPU Usage -->
                            <div style="margin-bottom: 20px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                    <span>CPU Usage</span>
                                    <span id="sysinfo-cpu-usage">15.2%</span>
                                </div>
                                <div style="width: 100%; height: 20px; background: #e9ecef; border-radius: 10px; overflow: hidden;">
                                    <div id="sysinfo-cpu-bar" style="height: 100%; background: linear-gradient(90deg, #28a745, #20c997); width: 15.2%; transition: width 0.5s ease; border-radius: 10px;"></div>
                                </div>
                            </div>

                            <!-- Memory Usage -->
                            <div style="margin-bottom: 20px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                    <span>Memory Usage</span>
                                    <span id="sysinfo-memory-usage">2.1 GB / 8.0 GB (26%)</span>
                                </div>
                                <div style="width: 100%; height: 20px; background: #e9ecef; border-radius: 10px; overflow: hidden;">
                                    <div id="sysinfo-memory-bar" style="height: 100%; background: linear-gradient(90deg, #007bff, #6610f2); width: 26%; transition: width 0.5s ease; border-radius: 10px;"></div>
                                </div>
                            </div>

                            <!-- Storage Usage -->
                            <div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                    <span>Storage Usage</span>
                                    <span id="sysinfo-storage-usage">128 GB / 256 GB (50%)</span>
                                </div>
                                <div style="width: 100%; height: 20px; background: #e9ecef; border-radius: 10px; overflow: hidden;">
                                    <div id="sysinfo-storage-bar" style="height: 100%; background: linear-gradient(90deg, #fd7e14, #e83e8c); width: 50%; transition: width 0.5s ease; border-radius: 10px;"></div>
                                </div>
                            </div>
                        </div>

                        <!-- Real-time Stats -->
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-top: 20px;">
                            <div style="background: white; border: 1px solid #e9ecef; border-radius: 8px; padding: 15px; text-align: center;">
                                <div style="font-size: 24px; font-weight: bold; color: #dc3545; margin-bottom: 5px;" id="sysinfo-cpu-temp">45.2°C</div>
                                <div style="color: #666; font-size: 12px; text-transform: uppercase;">CPU Temperature</div>
                            </div>
                            <div style="background: white; border: 1px solid #e9ecef; border-radius: 8px; padding: 15px; text-align: center;">
                                <div style="font-size: 24px; font-weight: bold; color: #6610f2; margin-bottom: 5px;" id="sysinfo-cpu-freq">2.4 GHz</div>
                                <div style="color: #666; font-size: 12px; text-transform: uppercase;">CPU Frequency</div>
                            </div>
                            <div style="background: white; border: 1px solid #e9ecef; border-radius: 8px; padding: 15px; text-align: center;">
                                <div style="font-size: 24px; font-weight: bold; color: #20c997; margin-bottom: 5px;" id="sysinfo-processes">187</div>
                                <div style="color: #666; font-size: 12px; text-transform: uppercase;">Processes</div>
                            </div>
                            <div style="background: white; border: 1px solid #e9ecef; border-radius: 8px; padding: 15px; text-align: center;">
                                <div style="font-size: 24px; font-weight: bold; color: #fd7e14; margin-bottom: 5px;" id="sysinfo-uptime">2d 14h</div>
                                <div style="color: #666; font-size: 12px; text-transform: uppercase;">Uptime</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- System Monitor Window -->
        <div class="window" id="monitor-window" style="left: 150px; top: 80px; width: 1000px; height: 700px;">
            <div class="window-header" onmousedown="startDrag(event, 'monitor-window')">
                <div class="window-title">System Monitor - Real-time Performance Tracking</div>
                <div class="window-controls">
                    <button class="window-control minimize" onclick="minimizeWindow('monitor-window')">−</button>
                    <button class="window-control maximize" onclick="maximizeWindow('monitor-window')">□</button>
                    <button class="window-control close" onclick="closeWindow('monitor-window')">×</button>
                </div>
            </div>
            <div class="window-content" style="padding: 0; overflow: hidden;">
                <!-- Monitor Toolbar -->
                <div style="background: #f8f9fa; border-bottom: 1px solid #dee2e6; padding: 10px 15px; display: flex; align-items: center; gap: 15px;">
                    <button onclick="refreshMonitorData()" style="background: #28A745; color: white; border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer;">🔄 Refresh</button>
                    <div style="display: flex; align-items: center; gap: 5px;">
                        <input type="checkbox" id="autoRefreshMonitor" checked onchange="toggleAutoRefreshMonitor()">
                        <label for="autoRefreshMonitor">Auto-refresh (1s)</label>
                    </div>
                    <button onclick="killSelectedProcess()" style="background: #dc3545; color: white; border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer;">🗑️ End Process</button>
                    <div style="margin-left: auto; display: flex; align-items: center; gap: 10px;">
                        <span style="font-size: 12px; color: #666;">View:</span>
                        <select id="monitorView" onchange="changeMonitorView()" style="padding: 4px; border: 1px solid #ccc; border-radius: 3px;">
                            <option value="overview">Overview</option>
                            <option value="processes">Processes</option>
                            <option value="performance">Performance</option>
                            <option value="network">Network</option>
                            <option value="storage">Storage</option>
                        </select>
                    </div>
                </div>

                <!-- Monitor Content -->
                <div style="display: flex; height: calc(100% - 60px);">
                    <!-- Monitor Sidebar -->
                    <div style="width: 200px; background: #f8f9fa; border-right: 1px solid #dee2e6; overflow-y: auto;">
                        <div class="monitor-category active" onclick="selectMonitorCategory('overview')" data-category="overview">
                            <div style="display: flex; align-items: center; padding: 12px 15px; cursor: pointer;">
                                <span style="margin-right: 10px; font-size: 18px;">📊</span>
                                <div>
                                    <div style="font-weight: 600;">Overview</div>
                                    <div style="font-size: 12px; color: #666;">System summary</div>
                                </div>
                            </div>
                        </div>
                        <div class="monitor-category" onclick="selectMonitorCategory('processes')" data-category="processes">
                            <div style="display: flex; align-items: center; padding: 12px 15px; cursor: pointer;">
                                <span style="margin-right: 10px; font-size: 18px;">⚙️</span>
                                <div>
                                    <div style="font-weight: 600;">Processes</div>
                                    <div style="font-size: 12px; color: #666;">Running tasks</div>
                                </div>
                            </div>
                        </div>
                        <div class="monitor-category" onclick="selectMonitorCategory('performance')" data-category="performance">
                            <div style="display: flex; align-items: center; padding: 12px 15px; cursor: pointer;">
                                <span style="margin-right: 10px; font-size: 18px;">⚡</span>
                                <div>
                                    <div style="font-weight: 600;">Performance</div>
                                    <div style="font-size: 12px; color: #666;">Real-time stats</div>
                                </div>
                            </div>
                        </div>
                        <div class="monitor-category" onclick="selectMonitorCategory('network')" data-category="network">
                            <div style="display: flex; align-items: center; padding: 12px 15px; cursor: pointer;">
                                <span style="margin-right: 10px; font-size: 18px;">🌐</span>
                                <div>
                                    <div style="font-weight: 600;">Network</div>
                                    <div style="font-size: 12px; color: #666;">Traffic & connections</div>
                                </div>
                            </div>
                        </div>
                        <div class="monitor-category" onclick="selectMonitorCategory('storage')" data-category="storage">
                            <div style="display: flex; align-items: center; padding: 12px 15px; cursor: pointer;">
                                <span style="margin-right: 10px; font-size: 18px;">💿</span>
                                <div>
                                    <div style="font-weight: 600;">Storage</div>
                                    <div style="font-size: 12px; color: #666;">Disk usage</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Monitor Main Content -->
                    <div style="flex: 1; padding: 20px; overflow-y: auto; background: white;" id="monitor-content">
                        <!-- Overview Content (Default) -->
                        <h3 style="margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                            <span>📊</span>
                            <span>System Overview</span>
                        </h3>

                        <!-- Real-time Performance Cards -->
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 25px;">
                            <div style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 15px; text-align: center;">
                                <div style="font-size: 24px; font-weight: bold; color: #28a745; margin-bottom: 5px;" id="monitor-cpu-usage">15.2%</div>
                                <div style="color: #666; font-size: 12px; text-transform: uppercase;">CPU Usage</div>
                                <div style="width: 100%; height: 4px; background: #e9ecef; border-radius: 2px; margin-top: 8px;">
                                    <div id="monitor-cpu-bar" style="height: 100%; background: #28a745; width: 15.2%; border-radius: 2px; transition: width 0.5s ease;"></div>
                                </div>
                            </div>
                            <div style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 15px; text-align: center;">
                                <div style="font-size: 24px; font-weight: bold; color: #007bff; margin-bottom: 5px;" id="monitor-memory-usage">26%</div>
                                <div style="color: #666; font-size: 12px; text-transform: uppercase;">Memory Usage</div>
                                <div style="width: 100%; height: 4px; background: #e9ecef; border-radius: 2px; margin-top: 8px;">
                                    <div id="monitor-memory-bar" style="height: 100%; background: #007bff; width: 26%; border-radius: 2px; transition: width 0.5s ease;"></div>
                                </div>
                            </div>
                            <div style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 15px; text-align: center;">
                                <div style="font-size: 24px; font-weight: bold; color: #fd7e14; margin-bottom: 5px;" id="monitor-disk-usage">50%</div>
                                <div style="color: #666; font-size: 12px; text-transform: uppercase;">Disk Usage</div>
                                <div style="width: 100%; height: 4px; background: #e9ecef; border-radius: 2px; margin-top: 8px;">
                                    <div id="monitor-disk-bar" style="height: 100%; background: #fd7e14; width: 50%; border-radius: 2px; transition: width 0.5s ease;"></div>
                                </div>
                            </div>
                            <div style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 15px; text-align: center;">
                                <div style="font-size: 24px; font-weight: bold; color: #6f42c1; margin-bottom: 5px;" id="monitor-network-usage">1.2 MB/s</div>
                                <div style="color: #666; font-size: 12px; text-transform: uppercase;">Network I/O</div>
                                <div style="width: 100%; height: 4px; background: #e9ecef; border-radius: 2px; margin-top: 8px;">
                                    <div id="monitor-network-bar" style="height: 100%; background: #6f42c1; width: 30%; border-radius: 2px; transition: width 0.5s ease;"></div>
                                </div>
                            </div>
                        </div>

                        <!-- System Information Grid -->
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                            <div style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px;">
                                <h4 style="margin-bottom: 15px; color: #333;">System Information</h4>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span style="color: #666;">Uptime:</span>
                                    <span style="font-weight: 600;" id="monitor-uptime">2 days, 14:32:18</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span style="color: #666;">Processes:</span>
                                    <span style="font-weight: 600;" id="monitor-processes">187</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span style="color: #666;">Load Average:</span>
                                    <span style="font-weight: 600;" id="monitor-load">0.85, 0.72, 0.68</span>
                                </div>
                                <div style="display: flex; justify-content: space-between;">
                                    <span style="color: #666;">CPU Temperature:</span>
                                    <span style="font-weight: 600; color: #dc3545;" id="monitor-cpu-temp">45.2°C</span>
                                </div>
                            </div>

                            <div style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px;">
                                <h4 style="margin-bottom: 15px; color: #333;">Top Processes</h4>
                                <div id="monitor-top-processes">
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 6px; font-size: 12px; color: #666;">
                                        <span>Process</span>
                                        <span>CPU%</span>
                                    </div>
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                        <span style="font-size: 14px;">kronos-desktop</span>
                                        <span style="font-weight: 600; color: #28a745;">8.2%</span>
                                    </div>
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                        <span style="font-size: 14px;">system-monitor</span>
                                        <span style="font-weight: 600; color: #28a745;">3.1%</span>
                                    </div>
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                        <span style="font-size: 14px;">terminal</span>
                                        <span style="font-weight: 600; color: #28a745;">1.8%</span>
                                    </div>
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                        <span style="font-size: 14px;">file-manager</span>
                                        <span style="font-weight: 600; color: #28a745;">1.2%</span>
                                    </div>
                                    <div style="display: flex; justify-content: space-between;">
                                        <span style="font-size: 14px;">systemd</span>
                                        <span style="font-weight: 600; color: #28a745;">0.5%</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Video Player Window -->
        <div class="window" id="video-player-window" style="left: 200px; top: 80px; width: 900px; height: 650px;">
            <div class="window-header" onmousedown="startDrag(event, 'video-player-window')">
                <div class="window-title">Video Player - Kronos Media Center</div>
                <div class="window-controls">
                    <button class="window-control minimize" onclick="minimizeWindow('video-player-window')">−</button>
                    <button class="window-control maximize" onclick="maximizeWindow('video-player-window')">□</button>
                    <button class="window-control close" onclick="closeWindow('video-player-window')">×</button>
                </div>
            </div>
            <div class="window-content" style="padding: 0; background: #000; overflow: hidden;">
                <!-- Video Player Interface -->
                <div style="display: flex; height: 100%;">
                    <!-- Main Video Area -->
                    <div style="flex: 1; display: flex; flex-direction: column; background: #000;">
                        <!-- Video Display Area -->
                        <div id="video-display-area" style="flex: 1; position: relative; background: #000; display: flex; align-items: center; justify-content: center;">
                            <video id="main-video" style="width: 100%; height: 100%; object-fit: contain;" controls>
                                <source src="" type="video/mp4">
                                Your browser does not support the video tag.
                            </video>

                            <!-- Video Overlay -->
                            <div id="video-overlay" style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); display: flex; align-items: center; justify-content: center; flex-direction: column; color: white;">
                                <div style="font-size: 48px; margin-bottom: 20px;">🎬</div>
                                <h3 style="margin-bottom: 10px;">Kronos Video Player</h3>
                                <p style="margin-bottom: 20px; text-align: center;">Select a video from the playlist or drag & drop a video file here</p>
                                <button onclick="openVideoFile()" style="background: #E95420; color: white; border: none; padding: 12px 24px; border-radius: 6px; cursor: pointer; font-size: 16px;">📁 Open Video File</button>
                            </div>
                        </div>

                        <!-- Custom Video Controls -->
                        <div id="video-controls" style="background: #1a1a1a; padding: 15px; border-top: 1px solid #333;">
                            <!-- Progress Bar -->
                            <div style="margin-bottom: 15px;">
                                <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 5px;">
                                    <span id="current-time" style="color: #fff; font-size: 12px; min-width: 45px;">00:00</span>
                                    <div style="flex: 1; height: 6px; background: #333; border-radius: 3px; cursor: pointer;" onclick="seekVideo(event)" id="progress-container">
                                        <div id="progress-bar" style="height: 100%; background: #E95420; border-radius: 3px; width: 0%; transition: width 0.1s;"></div>
                                    </div>
                                    <span id="duration" style="color: #fff; font-size: 12px; min-width: 45px;">00:00</span>
                                </div>
                            </div>

                            <!-- Control Buttons -->
                            <div style="display: flex; align-items: center; justify-content: space-between;">
                                <div style="display: flex; align-items: center; gap: 15px;">
                                    <button onclick="previousVideo()" style="background: none; border: none; color: #fff; font-size: 20px; cursor: pointer;" title="Previous">⏮️</button>
                                    <button id="play-pause-btn" onclick="togglePlayPause()" style="background: #E95420; border: none; color: white; font-size: 24px; width: 50px; height: 50px; border-radius: 50%; cursor: pointer;" title="Play/Pause">▶️</button>
                                    <button onclick="nextVideo()" style="background: none; border: none; color: #fff; font-size: 20px; cursor: pointer;" title="Next">⏭️</button>
                                    <button onclick="stopVideo()" style="background: none; border: none; color: #fff; font-size: 18px; cursor: pointer;" title="Stop">⏹️</button>
                                </div>

                                <div style="display: flex; align-items: center; gap: 15px;">
                                    <div style="display: flex; align-items: center; gap: 5px;">
                                        <span style="color: #fff; font-size: 14px;">🔊</span>
                                        <input type="range" id="volume-slider" min="0" max="100" value="50" onchange="setVolume(this.value)" style="width: 80px;">
                                    </div>
                                    <button onclick="toggleMute()" id="mute-btn" style="background: none; border: none; color: #fff; font-size: 18px; cursor: pointer;" title="Mute">🔊</button>
                                    <button onclick="toggleFullscreen()" style="background: none; border: none; color: #fff; font-size: 18px; cursor: pointer;" title="Fullscreen">⛶</button>
                                    <button onclick="togglePlaylist()" style="background: none; border: none; color: #fff; font-size: 18px; cursor: pointer;" title="Playlist">📋</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Playlist Sidebar -->
                    <div id="playlist-sidebar" style="width: 300px; background: #2a2a2a; border-left: 1px solid #444; display: flex; flex-direction: column;">
                        <!-- Playlist Header -->
                        <div style="padding: 15px; border-bottom: 1px solid #444; background: #333;">
                            <h4 style="color: white; margin: 0; display: flex; align-items: center; gap: 10px;">
                                <span>📋</span>
                                <span>Playlist</span>
                                <span style="margin-left: auto; font-size: 12px; color: #999;" id="playlist-count">0 videos</span>
                            </h4>
                        </div>

                        <!-- Playlist Controls -->
                        <div style="padding: 10px; border-bottom: 1px solid #444;">
                            <div style="display: flex; gap: 8px; margin-bottom: 10px;">
                                <button onclick="addVideoToPlaylist()" style="flex: 1; background: #E95420; color: white; border: none; padding: 8px; border-radius: 4px; cursor: pointer; font-size: 12px;">➕ Add Video</button>
                                <button onclick="clearPlaylist()" style="flex: 1; background: #dc3545; color: white; border: none; padding: 8px; border-radius: 4px; cursor: pointer; font-size: 12px;">🗑️ Clear</button>
                            </div>
                            <div style="display: flex; gap: 8px;">
                                <button onclick="shufflePlaylist()" style="flex: 1; background: #6c757d; color: white; border: none; padding: 6px; border-radius: 4px; cursor: pointer; font-size: 11px;">🔀 Shuffle</button>
                                <button onclick="toggleRepeat()" id="repeat-btn" style="flex: 1; background: #6c757d; color: white; border: none; padding: 6px; border-radius: 4px; cursor: pointer; font-size: 11px;">🔁 Repeat</button>
                            </div>
                        </div>

                        <!-- Playlist Items -->
                        <div id="playlist-items" style="flex: 1; overflow-y: auto; padding: 10px;">
                            <!-- Sample playlist items -->
                            <div class="playlist-item active" onclick="selectPlaylistItem(0)" data-index="0">
                                <div style="display: flex; align-items: center; padding: 10px; background: #E95420; border-radius: 6px; cursor: pointer; margin-bottom: 8px;">
                                    <div style="width: 40px; height: 30px; background: #333; border-radius: 4px; margin-right: 10px; display: flex; align-items: center; justify-content: center; color: #999; font-size: 12px;">🎬</div>
                                    <div style="flex: 1; min-width: 0;">
                                        <div style="color: white; font-weight: 600; font-size: 13px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">Sample Video 1</div>
                                        <div style="color: #ccc; font-size: 11px;">Demo • 02:30</div>
                                    </div>
                                    <button onclick="removeFromPlaylist(0)" style="background: none; border: none; color: #fff; font-size: 14px; cursor: pointer; padding: 4px;">×</button>
                                </div>
                            </div>

                            <div class="playlist-item" onclick="selectPlaylistItem(1)" data-index="1">
                                <div style="display: flex; align-items: center; padding: 10px; background: #444; border-radius: 6px; cursor: pointer; margin-bottom: 8px;">
                                    <div style="width: 40px; height: 30px; background: #333; border-radius: 4px; margin-right: 10px; display: flex; align-items: center; justify-content: center; color: #999; font-size: 12px;">🎬</div>
                                    <div style="flex: 1; min-width: 0;">
                                        <div style="color: white; font-weight: 600; font-size: 13px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">Sample Video 2</div>
                                        <div style="color: #ccc; font-size: 11px;">Demo • 01:45</div>
                                    </div>
                                    <button onclick="removeFromPlaylist(1)" style="background: none; border: none; color: #fff; font-size: 14px; cursor: pointer; padding: 4px;">×</button>
                                </div>
                            </div>

                            <div class="playlist-item" onclick="selectPlaylistItem(2)" data-index="2">
                                <div style="display: flex; align-items: center; padding: 10px; background: #444; border-radius: 6px; cursor: pointer; margin-bottom: 8px;">
                                    <div style="width: 40px; height: 30px; background: #333; border-radius: 4px; margin-right: 10px; display: flex; align-items: center; justify-content: center; color: #999; font-size: 12px;">🎬</div>
                                    <div style="flex: 1; min-width: 0;">
                                        <div style="color: white; font-weight: 600; font-size: 13px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">Sample Video 3</div>
                                        <div style="color: #ccc; font-size: 11px;">Demo • 03:15</div>
                                    </div>
                                    <button onclick="removeFromPlaylist(2)" style="background: none; border: none; color: #fff; font-size: 14px; cursor: pointer; padding: 4px;">×</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Games Window -->
        <div class="window" id="games-window" style="left: 400px; top: 100px; width: 800px; height: 600px;">
            <div class="window-header" onmousedown="startDrag(event, 'games-window')">
                <div class="window-title">Games - Kronos Entertainment Center</div>
                <div class="window-controls">
                    <button class="window-control minimize" onclick="minimizeWindow('games-window')">−</button>
                    <button class="window-control maximize" onclick="maximizeWindow('games-window')">□</button>
                    <button class="window-control close" onclick="closeWindow('games-window')">×</button>
                </div>
            </div>
            <div class="window-content" style="padding: 0; overflow: hidden;">
                <!-- Games Menu -->
                <div id="games-menu" style="padding: 20px;">
                    <h3 style="margin-bottom: 20px; color: #333;">Built-in Games</h3>
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 30px;">
                        <div class="game-card" onclick="launchGame('snake')" data-game="snake">
                            <div class="game-icon">🐍</div>
                            <h4>Snake Game</h4>
                            <p>Classic arcade game</p>
                            <div class="game-stats">Best: 1,250 pts</div>
                        </div>
                        <div class="game-card" onclick="launchGame('tetris')" data-game="tetris">
                            <div class="game-icon">🧩</div>
                            <h4>Tetris</h4>
                            <p>Puzzle block game</p>
                            <div class="game-stats">Best: 45,600 pts</div>
                        </div>
                        <div class="game-card" onclick="launchGame('pong')" data-game="pong">
                            <div class="game-icon">🏓</div>
                            <h4>Pong</h4>
                            <p>Classic paddle game</p>
                            <div class="game-stats">Best: 21 wins</div>
                        </div>
                        <div class="game-card" onclick="launchGame('minesweeper')" data-game="minesweeper">
                            <div class="game-icon">💣</div>
                            <h4>Minesweeper</h4>
                            <p>Logic puzzle game</p>
                            <div class="game-stats">Best: 89 sec</div>
                        </div>
                        <div class="game-card" onclick="launchGame('chess')" data-game="chess">
                            <div class="game-icon">♟️</div>
                            <h4>Chess</h4>
                            <p>Strategic board game</p>
                            <div class="game-stats">Rating: 1,450</div>
                        </div>
                        <div class="game-card" onclick="launchGame('solitaire')" data-game="solitaire">
                            <div class="game-icon">🃏</div>
                            <h4>Solitaire</h4>
                            <p>Card game classic</p>
                            <div class="game-stats">Win: 78%</div>
                        </div>
                    </div>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div style="padding: 20px; background: #f8f9fa; border-radius: 8px;">
                            <h4 style="margin-bottom: 15px; color: #333;">Game Statistics</h4>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                                <div style="font-size: 14px;">Games Played: <strong>127</strong></div>
                                <div style="font-size: 14px;">Total Score: <strong>89,420</strong></div>
                                <div style="font-size: 14px;">Time Played: <strong>5h 23m</strong></div>
                                <div style="font-size: 14px;">Achievements: <strong>12/18</strong></div>
                            </div>
                        </div>

                        <div style="padding: 20px; background: #e8f5e8; border-radius: 8px;">
                            <h4 style="margin-bottom: 15px; color: #333;">Recent Achievements</h4>
                            <div style="font-size: 14px; line-height: 1.6;">
                                🏆 Snake Master - Score 1000+ points<br>
                                🎯 Tetris Pro - Clear 10 lines at once<br>
                                ⚡ Speed Demon - Win Pong in under 30s<br>
                                🧠 Logic Expert - Solve Expert Minesweeper
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Game Container -->
                <div id="game-container" style="display: none; height: 100%; background: #000; position: relative;">
                    <div id="game-header" style="background: #333; color: white; padding: 10px 20px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #555;">
                        <div style="display: flex; align-items: center; gap: 15px;">
                            <button onclick="returnToGamesMenu()" style="background: #E95420; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer;">← Back to Games</button>
                            <span id="current-game-title" style="font-size: 18px; font-weight: bold;">Game Title</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 15px;">
                            <span id="game-score" style="font-size: 16px;">Score: 0</span>
                            <button onclick="pauseGame()" id="pause-btn" style="background: #6c757d; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer;">⏸️ Pause</button>
                            <button onclick="restartGame()" style="background: #28a745; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer;">🔄 Restart</button>
                        </div>
                    </div>
                    <div id="game-area" style="flex: 1; position: relative; overflow: hidden; height: calc(100% - 60px);">
                        <!-- Game content will be loaded here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Taskbar -->
    <div class="taskbar">
        <button class="start-button" onclick="toggleStartMenu()">🐧 Kronos</button>
        <div id="taskbar-items"></div>
        <div class="system-tray">
            <span onclick="showSystemInfo()">🔊 📶 🔋 💾</span>
            <span id="clock">12:34</span>
            <span id="date">Jan 15</span>
        </div>
    </div>

    <!-- Start Menu -->
    <div class="start-menu" id="start-menu">
        <div class="start-menu-header">Applications</div>

        <div class="start-menu-section">
            <div class="start-menu-section-title">System Tools</div>
            <div class="start-menu-item" onclick="openApp('terminal')">
                <div class="start-menu-item-icon" style="background: #E95420; color: white;">🖥️</div>
                <div>Terminal</div>
            </div>
            <div class="start-menu-item" onclick="openApp('files')">
                <div class="start-menu-item-icon" style="background: #4A90E2; color: white;">📁</div>
                <div>File Manager</div>
            </div>
            <div class="start-menu-item" onclick="openApp('monitor')">
                <div class="start-menu-item-icon" style="background: #6F42C1; color: white;">📊</div>
                <div>System Monitor</div>
            </div>
            <div class="start-menu-item" onclick="openApp('settings')">
                <div class="start-menu-item-icon" style="background: #6C757D; color: white;">⚙️</div>
                <div>Settings</div>
            </div>
        </div>

        <div class="start-menu-section">
            <div class="start-menu-section-title">Applications</div>
            <div class="start-menu-item" onclick="openApp('editor')">
                <div class="start-menu-item-icon" style="background: #28A745; color: white;">📝</div>
                <div>Text Editor</div>
            </div>
            <div class="start-menu-item" onclick="openApp('browser')">
                <div class="start-menu-item-icon" style="background: #FF6B35; color: white;">🌐</div>
                <div>Web Browser</div>
            </div>
            <div class="start-menu-item" onclick="openApp('calculator')">
                <div class="start-menu-item-icon" style="background: #FD7E14; color: white;">🧮</div>
                <div>Calculator</div>
            </div>
            <div class="start-menu-item" onclick="openApp('package-manager')">
                <div class="start-menu-item-icon" style="background: #20C997; color: white;">📦</div>
                <div>Package Manager</div>
            </div>
        </div>

        <div class="start-menu-section">
            <div class="start-menu-section-title">Entertainment</div>
            <div class="start-menu-item" onclick="openApp('music-player')">
                <div class="start-menu-item-icon" style="background: #9C27B0; color: white;">🎵</div>
                <div>Music Player</div>
            </div>
            <div class="start-menu-item" onclick="openApp('video-player')">
                <div class="start-menu-item-icon" style="background: #F44336; color: white;">🎬</div>
                <div>Video Player</div>
            </div>
            <div class="start-menu-item" onclick="openApp('games')">
                <div class="start-menu-item-icon" style="background: #795548; color: white;">🎮</div>
                <div>Games</div>
            </div>
            <div class="start-menu-item" onclick="openApp('image-viewer')">
                <div class="start-menu-item-icon" style="background: #E91E63; color: white;">🖼️</div>
                <div>Image Viewer</div>
            </div>
        </div>

        <div class="start-menu-section">
            <div class="start-menu-section-title">Customization</div>
            <div class="start-menu-item" onclick="openApp('wallpaper-selector')">
                <div class="start-menu-item-icon" style="background: #607D8B; color: white;">🎨</div>
                <div>Wallpapers</div>
            </div>
            <div class="start-menu-item" onclick="openApp('app-store')">
                <div class="start-menu-item-icon" style="background: #3F51B5; color: white;">🏪</div>
                <div>App Store</div>
            </div>
        </div>

        <div class="start-menu-section">
            <div class="start-menu-item" onclick="showNotification('System shutting down...', 'info')">
                <div class="start-menu-item-icon" style="background: #DC3545; color: white;">🔌</div>
                <div>Shutdown</div>
            </div>
            <div class="start-menu-item" onclick="showNotification('System restarting...', 'info')">
                <div class="start-menu-item-icon" style="background: #FFC107; color: #333;">🔄</div>
                <div>Restart</div>
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification"></div>

    <script>
        // Application management
        let openWindows = new Set();
        let activeWindow = null;
        let windowZIndex = 1000;
        let currentWallpaper = 'ocean-blue';
        let selectedWallpaper = 'ocean-blue';
        let slideshowEnabled = false;
        let slideshowInterval;

        // Calculator state
        let calcDisplay = '0';
        let calcValue = 0;
        let calcOperator = null;
        let calcWaitingForOperand = false;

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            updateClock();
            setInterval(updateClock, 1000);
            showNotification('Welcome to Kronos OS! Complete application suite loaded.', 'info');
        });

        function openApp(appName) {
            console.log('🚀 Opening app:', appName);

            // Simple, direct mapping - same as working test
            let windowId;
            switch(appName) {
                case 'terminal': windowId = 'terminal-window'; break;
                case 'files': windowId = 'file-manager-window'; break;
                case 'monitor': windowId = 'monitor-window'; break;
                case 'calculator': windowId = 'calculator-window'; break;
                case 'settings': windowId = 'settings-window'; break;
                case 'package-manager': windowId = 'package-manager-window'; break;
                case 'music-player': windowId = 'music-player-window'; break;
                case 'video-player': windowId = 'video-player-window'; break;
                case 'games': windowId = 'games-window'; break;
                case 'wallpaper-selector': windowId = 'wallpaper-selector-window'; break;
                case 'system-info': windowId = 'system-info-window'; break;
                case 'editor':
                case 'browser':
                case 'image-viewer':
                case 'app-store':
                    showNotification(`${appName} not implemented yet`, 'info');
                    return;
                default:
                    showNotification(`Unknown app: ${appName}`, 'warning');
                    return;
            }

            console.log('🔍 Looking for window:', windowId);
            const windowElement = document.getElementById(windowId);

            if (!windowElement) {
                console.error('❌ Window not found:', windowId);
                showNotification(`Window ${windowId} not found`, 'error');
                return;
            }

            console.log('✅ Window found, opening...');

            // Close all other windows first (like the working test)
            document.querySelectorAll('.window').forEach(w => {
                w.classList.remove('active', 'show');
                w.style.display = 'none';
            });

            // Show this window using the same method as working test
            windowElement.classList.add('show');
            windowElement.classList.add('active');
            windowElement.style.display = 'block';
            windowElement.style.zIndex = '9999';

            // Update window management
            openWindows.clear();
            openWindows.add(windowId);
            activeWindow = windowId;

            // Update taskbar and close start menu
            updateTaskbar();
            closeStartMenu();

            console.log('✅ Window opened successfully!');
            showNotification(`${getAppDisplayName(appName)} opened!`, 'success');

            // Initialize specific applications
            setTimeout(() => {
                try {
                    if (appName === 'files' && typeof initializeFileManager === 'function') {
                        initializeFileManager();
                    } else if (appName === 'video-player' && typeof initializeVideoPlayer === 'function') {
                        initializeVideoPlayer();
                    } else if (appName === 'terminal' && typeof focusTerminalInput === 'function') {
                        focusTerminalInput();
                    } else if (appName === 'monitor' && typeof initializeSystemMonitor === 'function') {
                        initializeSystemMonitor();
                    }
                } catch (initError) {
                    console.error('Error initializing app:', initError);
                }
            }, 100);
        }

        // Debug function to check what windows exist
        function debugWindows() {
            console.log('=== DEBUGGING WINDOWS ===');

            const expectedWindows = [
                'file-manager-window',
                'calculator-window',
                'wallpaper-selector-window',
                'package-manager-window',
                'music-player-window',
                'settings-window',
                'terminal-window',
                'system-info-window',
                'monitor-window',
                'video-player-window',
                'games-window'
            ];

            expectedWindows.forEach(windowId => {
                const element = document.getElementById(windowId);
                console.log(`Window ${windowId}:`, !!element, element);
            });

            // Also check all elements with class 'window'
            const allWindows = document.querySelectorAll('.window');
            console.log('All window elements found:', allWindows.length);
            allWindows.forEach(window => {
                console.log('Window ID:', window.id, 'Display:', window.style.display, 'Classes:', window.className);
            });
        }

        // Test function to verify all applications work
        function testAllApps() {
            const apps = ['terminal', 'files', 'monitor', 'calculator', 'settings', 'package-manager', 'music-player', 'video-player', 'games', 'wallpaper-selector', 'system-info'];

            console.log('Testing all applications...');

            apps.forEach((app, index) => {
                setTimeout(() => {
                    console.log(`Testing app: ${app}`);
                    openApp(app);
                }, index * 1000);
            });
        }

        function restoreWindow(windowId) {
            const window = document.getElementById(windowId);
            if (window) {
                window.style.display = 'block';
                window.classList.remove('minimized');
                window.classList.add('active');

                // Add restore animation
                window.style.transform = 'scale(0.1)';
                window.style.opacity = '0';
                window.style.transition = 'all 0.3s ease';

                setTimeout(() => {
                    window.style.transform = 'scale(1)';
                    window.style.opacity = '1';
                }, 10);

                setTimeout(() => {
                    window.style.transform = '';
                    window.style.opacity = '';
                    window.style.transition = '';
                }, 300);

                openWindows.add(windowId);
                setActiveWindow(windowId);
                updateTaskbar();

                showNotification('Window restored', 'info');
            }
        }

        function getAppDisplayName(appName) {
            const names = {
                'terminal': 'Terminal',
                'files': 'File Manager',
                'editor': 'Text Editor',
                'monitor': 'System Monitor',
                'calculator': 'Calculator',
                'settings': 'Settings',
                'browser': 'Web Browser',
                'package-manager': 'Package Manager',
                'music-player': 'Music Player',
                'video-player': 'Video Player',
                'games': 'Games',
                'image-viewer': 'Image Viewer',
                'wallpaper-selector': 'Wallpapers',
                'app-store': 'App Store',
                'system-info': 'System Info'
            };
            return names[appName] || appName;
        }

        function closeWindow(windowId) {
            const window = document.getElementById(windowId);
            if (window) {
                window.classList.remove('active');
                window.style.display = 'none';
                openWindows.delete(windowId);

                if (activeWindow === windowId) {
                    activeWindow = null;
                    if (openWindows.size > 0) {
                        const lastWindow = Array.from(openWindows).pop();
                        setActiveWindow(lastWindow);
                    }
                }

                updateTaskbar();
                showNotification('Window closed', 'info');
            }
        }

        function minimizeWindow(windowId) {
            const window = document.getElementById(windowId);
            if (window) {
                window.classList.remove('active');
                window.classList.add('minimized');

                // Add minimize animation
                window.style.transform = 'scale(0.1)';
                window.style.opacity = '0';
                window.style.transition = 'all 0.3s ease';

                setTimeout(() => {
                    window.style.display = 'none';
                    window.style.transform = '';
                    window.style.opacity = '';
                    window.style.transition = '';
                }, 300);

                if (activeWindow === windowId) {
                    activeWindow = null;
                    if (openWindows.size > 0) {
                        const remainingWindows = Array.from(openWindows).filter(id => id !== windowId);
                        if (remainingWindows.length > 0) {
                            setActiveWindow(remainingWindows[remainingWindows.length - 1]);
                        }
                    }
                }

                showNotification('Window minimized', 'info');
            }
        }

        function maximizeWindow(windowId) {
            const window = document.getElementById(windowId);
            if (window) {
                if (window.classList.contains('maximized')) {
                    // Restore window
                    window.classList.remove('maximized');
                    window.style.width = window.dataset.originalWidth || '800px';
                    window.style.height = window.dataset.originalHeight || '600px';
                    window.style.left = window.dataset.originalLeft || '200px';
                    window.style.top = window.dataset.originalTop || '100px';
                    showNotification('Window restored', 'info');
                } else {
                    // Maximize window
                    window.dataset.originalWidth = window.style.width || '800px';
                    window.dataset.originalHeight = window.style.height || '600px';
                    window.dataset.originalLeft = window.style.left || '200px';
                    window.dataset.originalTop = window.style.top || '100px';

                    window.classList.add('maximized');
                    window.style.width = '100vw';
                    window.style.height = 'calc(100vh - 48px)';
                    window.style.left = '0';
                    window.style.top = '0';
                    showNotification('Window maximized', 'info');
                }
            }
        }

        function setActiveWindow(windowId) {
            document.querySelectorAll('.window').forEach(w => {
                w.style.zIndex = '999';
            });

            const window = document.getElementById(windowId);
            if (window) {
                window.style.zIndex = ++windowZIndex;
                activeWindow = windowId;
            }
        }

        function updateTaskbar() {
            const taskbarItems = document.getElementById('taskbar-items');
            taskbarItems.innerHTML = '';

            openWindows.forEach(windowId => {
                const appName = windowId.replace('-window', '');
                const window = document.getElementById(windowId);
                const button = document.createElement('button');
                button.className = 'taskbar-item';
                button.textContent = getAppDisplayName(appName);

                button.onclick = () => {
                    if (window && (window.classList.contains('minimized') || window.style.display === 'none')) {
                        // Restore minimized window
                        restoreWindow(windowId);
                    } else if (window && window.classList.contains('active')) {
                        // Minimize active window
                        minimizeWindow(windowId);
                    } else {
                        // Activate window
                        if (window) {
                            window.style.display = 'block';
                            window.classList.add('active');
                            setActiveWindow(windowId);
                        }
                    }
                };

                if (windowId === activeWindow) {
                    button.classList.add('active');
                }

                // Add visual indicator for minimized windows
                if (window && (window.classList.contains('minimized') || window.style.display === 'none')) {
                    button.style.opacity = '0.6';
                    button.style.fontStyle = 'italic';
                } else {
                    button.style.opacity = '1';
                    button.style.fontStyle = 'normal';
                }

                taskbarItems.appendChild(button);
            });
        }

        function toggleStartMenu() {
            const startMenu = document.getElementById('start-menu');
            startMenu.classList.toggle('show');
        }

        function closeStartMenu() {
            const startMenu = document.getElementById('start-menu');
            startMenu.classList.remove('show');
        }

        function showNotification(message, type = 'info') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type} show`;

            setTimeout(() => {
                notification.classList.remove('show');
            }, 4000);
        }

        function updateClock() {
            const now = new Date();
            const timeString = now.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
            const dateString = now.toLocaleDateString([], {month: 'short', day: 'numeric'});

            const clockElement = document.getElementById('clock');
            const dateElement = document.getElementById('date');

            if (clockElement) clockElement.textContent = timeString;
            if (dateElement) dateElement.textContent = dateString;
        }

        // Calculator functions
        function calcInput(input) {
            const display = document.getElementById('calc-display');

            if (input >= '0' && input <= '9') {
                if (calcWaitingForOperand) {
                    calcDisplay = input;
                    calcWaitingForOperand = false;
                } else {
                    calcDisplay = calcDisplay === '0' ? input : calcDisplay + input;
                }
            } else if (input === '.') {
                if (calcDisplay.indexOf('.') === -1) {
                    calcDisplay += input;
                }
            } else if (['+', '-', '*', '/'].includes(input)) {
                if (calcOperator && !calcWaitingForOperand) {
                    const result = calculate();
                    calcDisplay = String(result);
                    calcValue = result;
                }

                calcValue = parseFloat(calcDisplay);
                calcOperator = input;
                calcWaitingForOperand = true;
            } else if (input === '=') {
                if (calcOperator && !calcWaitingForOperand) {
                    calcDisplay = String(calculate());
                    calcOperator = null;
                    calcValue = 0;
                    calcWaitingForOperand = true;
                }
            } else if (input === 'C') {
                calcDisplay = '0';
                calcValue = 0;
                calcOperator = null;
                calcWaitingForOperand = false;
            } else if (input === 'CE') {
                calcDisplay = '0';
            } else if (input === '⌫') {
                calcDisplay = calcDisplay.length > 1 ? calcDisplay.slice(0, -1) : '0';
            } else if (input === '±') {
                calcDisplay = String(-parseFloat(calcDisplay));
            } else if (input === 'sin') {
                calcDisplay = String(Math.sin(parseFloat(calcDisplay) * Math.PI / 180));
            } else if (input === 'cos') {
                calcDisplay = String(Math.cos(parseFloat(calcDisplay) * Math.PI / 180));
            } else if (input === 'tan') {
                calcDisplay = String(Math.tan(parseFloat(calcDisplay) * Math.PI / 180));
            } else if (input === '√') {
                calcDisplay = String(Math.sqrt(parseFloat(calcDisplay)));
            } else if (input === 'x²') {
                calcDisplay = String(Math.pow(parseFloat(calcDisplay), 2));
            } else if (input === 'π') {
                calcDisplay = String(Math.PI);
            }

            display.textContent = calcDisplay;
        }

        function calculate() {
            const current = parseFloat(calcDisplay);

            switch (calcOperator) {
                case '+': return calcValue + current;
                case '-': return calcValue - current;
                case '*': return calcValue * current;
                case '/': return calcValue / current;
                default: return current;
            }
        }

        // Wallpaper functions
        function selectWallpaper(wallpaperName) {
            selectedWallpaper = wallpaperName;

            // Update selection in grid
            document.querySelectorAll('.wallpaper-item').forEach(item => {
                item.classList.remove('selected');
            });
            event.target.closest('.wallpaper-item').classList.add('selected');
        }

        function applyWallpaper() {
            currentWallpaper = selectedWallpaper;
            const desktop = document.getElementById('desktop');

            // Remove all wallpaper classes
            desktop.className = desktop.className.replace(/wallpaper-\S+/g, '');

            // Add new wallpaper class
            desktop.classList.add('wallpaper-' + currentWallpaper);

            showNotification(`Wallpaper changed to ${selectedWallpaper.replace('-', ' ')}!`, 'info');
            closeWindow('wallpaper-selector-window');
        }

        function toggleSlideshow() {
            const checkbox = document.getElementById('slideshow-enabled');
            slideshowEnabled = checkbox.checked;

            if (slideshowEnabled) {
                startSlideshow();
                showNotification('Slideshow enabled - wallpaper will change every 10 seconds', 'info');
            } else {
                stopSlideshow();
                showNotification('Slideshow disabled', 'info');
            }
        }

        function startSlideshow() {
            const wallpapers = ['ocean-blue', 'ubuntu-orange', 'forest-green', 'sunset-purple',
                              'deep-space', 'cherry-blossom', 'arctic-blue', 'autumn-gold', 'matrix-green'];
            let currentIndex = wallpapers.indexOf(currentWallpaper);

            slideshowInterval = setInterval(() => {
                currentIndex = (currentIndex + 1) % wallpapers.length;
                currentWallpaper = wallpapers[currentIndex];

                const desktop = document.getElementById('desktop');
                desktop.className = desktop.className.replace(/wallpaper-\S+/g, '');
                desktop.classList.add('wallpaper-' + currentWallpaper);

                showNotification(`Slideshow: ${currentWallpaper.replace('-', ' ')}`, 'info');
            }, 10000);
        }

        function stopSlideshow() {
            if (slideshowInterval) {
                clearInterval(slideshowInterval);
                slideshowInterval = null;
            }
        }

        // Package Manager functions
        function packageAction(action) {
            switch (action) {
                case 'update':
                    showNotification('Updating package lists...', 'info');
                    setTimeout(() => {
                        showNotification('Package lists updated successfully!', 'info');
                    }, 2000);
                    break;
                case 'upgrade':
                    showNotification('Upgrading all packages...', 'info');
                    setTimeout(() => {
                        showNotification('All packages upgraded successfully!', 'info');
                    }, 3000);
                    break;
            }
        }

        function installPackage(packageName) {
            showNotification(`Installing ${packageName}...`, 'info');
            setTimeout(() => {
                showNotification(`${packageName} installed successfully!`, 'info');
                event.target.textContent = '✓ Installed';
                event.target.style.background = '#28a745';
                event.target.disabled = true;
            }, 2000);
        }

        function upgradePackage(packageName) {
            showNotification(`Upgrading ${packageName}...`, 'info');
            setTimeout(() => {
                showNotification(`${packageName} upgraded successfully!`, 'info');
                event.target.textContent = '✓ Updated';
                event.target.style.background = '#28a745';
            }, 1500);
        }

        // Music Player functions
        function musicControl(action) {
            switch (action) {
                case 'play':
                    const playBtn = event.target;
                    if (playBtn.textContent === '⏸️') {
                        playBtn.textContent = '▶️';
                        showNotification('Music paused', 'info');
                    } else {
                        playBtn.textContent = '⏸️';
                        showNotification('Music playing', 'info');
                    }
                    break;
                case 'prev':
                    showNotification('Previous track', 'info');
                    break;
                case 'next':
                    showNotification('Next track', 'info');
                    break;
            }
        }

        function playTrack(trackName) {
            showNotification(`Playing: ${trackName}`, 'info');

            // Update playlist selection
            document.querySelectorAll('#music-player-window .window-content div[style*="background: #f0f0f0"]').forEach(item => {
                item.style.background = '';
            });
            event.target.style.background = '#f0f0f0';
        }

        // Games functions
        let currentGame = null;
        let gameState = {};
        let gameLoop = null;
        let gamePaused = false;

        function launchGame(gameName) {
            const gameNames = {
                'snake': 'Snake Game',
                'tetris': 'Tetris',
                'pong': 'Pong',
                'minesweeper': 'Minesweeper',
                'chess': 'Chess',
                'solitaire': 'Solitaire'
            };

            currentGame = gameName;
            document.getElementById('games-menu').style.display = 'none';
            document.getElementById('game-container').style.display = 'block';
            document.getElementById('current-game-title').textContent = gameNames[gameName];
            document.getElementById('game-score').textContent = 'Score: 0';

            // Initialize the specific game
            switch(gameName) {
                case 'snake':
                    initSnakeGame();
                    break;
                case 'tetris':
                    initTetrisGame();
                    break;
                case 'pong':
                    initPongGame();
                    break;
                case 'minesweeper':
                    initMinesweeperGame();
                    break;
                case 'chess':
                    initChessGame();
                    break;
                case 'solitaire':
                    initSolitaireGame();
                    break;
            }

            showNotification(`${gameNames[gameName]} started!`, 'success');
        }

        function returnToGamesMenu() {
            if (gameLoop) {
                clearInterval(gameLoop);
                gameLoop = null;
            }

            document.getElementById('game-container').style.display = 'none';
            document.getElementById('games-menu').style.display = 'block';
            currentGame = null;
            gameState = {};
            gamePaused = false;
        }

        function pauseGame() {
            gamePaused = !gamePaused;
            const pauseBtn = document.getElementById('pause-btn');

            if (gamePaused) {
                pauseBtn.innerHTML = '▶️ Resume';
                if (gameLoop) {
                    clearInterval(gameLoop);
                    gameLoop = null;
                }
                showNotification('Game paused', 'info');
            } else {
                pauseBtn.innerHTML = '⏸️ Pause';
                if (currentGame === 'snake') startSnakeLoop();
                else if (currentGame === 'tetris') startTetrisLoop();
                else if (currentGame === 'pong') startPongLoop();
                showNotification('Game resumed', 'info');
            }
        }

        function restartGame() {
            if (currentGame) {
                launchGame(currentGame);
                showNotification('Game restarted', 'info');
            }
        }

        // Snake Game Implementation
        function initSnakeGame() {
            const gameArea = document.getElementById('game-area');
            gameArea.innerHTML = `
                <div class="game-info">
                    <h3>🐍 Snake Game</h3>
                    <p>Use WASD or Arrow Keys to move. Eat the red food to grow!</p>
                </div>
                <canvas id="snake-canvas" class="game-canvas" width="400" height="400"></canvas>
                <div class="game-controls">
                    Controls: W/↑ = Up, S/↓ = Down, A/← = Left, D/→ = Right
                </div>
            `;

            gameState = {
                snake: [{x: 200, y: 200}],
                direction: {x: 20, y: 0},
                food: {x: 100, y: 100},
                score: 0,
                gridSize: 20
            };

            drawSnake();
            startSnakeLoop();

            // Add keyboard controls
            document.addEventListener('keydown', handleSnakeInput);
        }

        function handleSnakeInput(event) {
            if (currentGame !== 'snake' || gamePaused) return;

            const key = event.key.toLowerCase();
            const state = gameState;

            switch(key) {
                case 'w':
                case 'arrowup':
                    if (state.direction.y === 0) state.direction = {x: 0, y: -state.gridSize};
                    break;
                case 's':
                case 'arrowdown':
                    if (state.direction.y === 0) state.direction = {x: 0, y: state.gridSize};
                    break;
                case 'a':
                case 'arrowleft':
                    if (state.direction.x === 0) state.direction = {x: -state.gridSize, y: 0};
                    break;
                case 'd':
                case 'arrowright':
                    if (state.direction.x === 0) state.direction = {x: state.gridSize, y: 0};
                    break;
            }
        }

        function startSnakeLoop() {
            if (gameLoop) clearInterval(gameLoop);
            gameLoop = setInterval(updateSnake, 150);
        }

        function updateSnake() {
            if (gamePaused) return;

            const state = gameState;
            const head = {x: state.snake[0].x + state.direction.x, y: state.snake[0].y + state.direction.y};

            // Check wall collision
            if (head.x < 0 || head.x >= 400 || head.y < 0 || head.y >= 400) {
                gameOver('Snake hit the wall!');
                return;
            }

            // Check self collision
            for (let segment of state.snake) {
                if (head.x === segment.x && head.y === segment.y) {
                    gameOver('Snake hit itself!');
                    return;
                }
            }

            state.snake.unshift(head);

            // Check food collision
            if (head.x === state.food.x && head.y === state.food.y) {
                state.score += 10;
                document.getElementById('game-score').textContent = `Score: ${state.score}`;
                generateFood();
            } else {
                state.snake.pop();
            }

            drawSnake();
        }

        function generateFood() {
            const state = gameState;
            do {
                state.food = {
                    x: Math.floor(Math.random() * 20) * state.gridSize,
                    y: Math.floor(Math.random() * 20) * state.gridSize
                };
            } while (state.snake.some(segment => segment.x === state.food.x && segment.y === state.food.y));
        }

        function drawSnake() {
            const canvas = document.getElementById('snake-canvas');
            if (!canvas) return;

            const ctx = canvas.getContext('2d');
            const state = gameState;

            // Clear canvas
            ctx.fillStyle = '#000';
            ctx.fillRect(0, 0, 400, 400);

            // Draw snake
            ctx.fillStyle = '#4CAF50';
            for (let segment of state.snake) {
                ctx.fillRect(segment.x, segment.y, state.gridSize - 2, state.gridSize - 2);
            }

            // Draw food
            ctx.fillStyle = '#F44336';
            ctx.fillRect(state.food.x, state.food.y, state.gridSize - 2, state.gridSize - 2);
        }

        function gameOver(message) {
            clearInterval(gameLoop);
            gameLoop = null;
            showNotification(`Game Over! ${message} Final Score: ${gameState.score}`, 'warning');
        }

        // Tetris Game Implementation
        function initTetrisGame() {
            const gameArea = document.getElementById('game-area');
            gameArea.innerHTML = `
                <div class="game-info">
                    <h3>🧩 Tetris</h3>
                    <p>Use A/D to move, S to drop, W to rotate. Clear lines to score!</p>
                </div>
                <canvas id="tetris-canvas" class="game-canvas" width="300" height="600"></canvas>
                <div class="game-controls">
                    Controls: A/← = Left, D/→ = Right, S/↓ = Drop, W/↑ = Rotate
                </div>
            `;

            gameState = {
                board: Array(20).fill().map(() => Array(10).fill(0)),
                currentPiece: null,
                score: 0,
                lines: 0,
                level: 1
            };

            spawnTetrisPiece();
            drawTetris();
            startTetrisLoop();

            document.addEventListener('keydown', handleTetrisInput);
        }

        function handleTetrisInput(event) {
            if (currentGame !== 'tetris' || gamePaused) return;

            const key = event.key.toLowerCase();

            switch(key) {
                case 'a':
                case 'arrowleft':
                    moveTetrisPiece(-1, 0);
                    break;
                case 'd':
                case 'arrowright':
                    moveTetrisPiece(1, 0);
                    break;
                case 's':
                case 'arrowdown':
                    moveTetrisPiece(0, 1);
                    break;
                case 'w':
                case 'arrowup':
                    rotateTetrisPiece();
                    break;
            }
        }

        function spawnTetrisPiece() {
            const pieces = [
                { shape: [[1,1,1,1]], color: '#00f0f0' }, // I
                { shape: [[1,1],[1,1]], color: '#f0f000' }, // O
                { shape: [[0,1,0],[1,1,1]], color: '#a000f0' }, // T
                { shape: [[0,1,1],[1,1,0]], color: '#00f000' }, // S
                { shape: [[1,1,0],[0,1,1]], color: '#f00000' }, // Z
                { shape: [[1,0,0],[1,1,1]], color: '#0000f0' }, // J
                { shape: [[0,0,1],[1,1,1]], color: '#f0a000' }  // L
            ];

            const piece = pieces[Math.floor(Math.random() * pieces.length)];
            gameState.currentPiece = {
                shape: piece.shape,
                color: piece.color,
                x: 4,
                y: 0
            };
        }

        function moveTetrisPiece(dx, dy) {
            const piece = gameState.currentPiece;
            piece.x += dx;
            piece.y += dy;

            if (checkTetrisCollision()) {
                piece.x -= dx;
                piece.y -= dy;

                if (dy > 0) {
                    placeTetrisPiece();
                    clearTetrisLines();
                    spawnTetrisPiece();

                    if (checkTetrisCollision()) {
                        gameOver('Game Over!');
                        return;
                    }
                }
            }

            drawTetris();
        }

        function rotateTetrisPiece() {
            const piece = gameState.currentPiece;
            const rotated = piece.shape[0].map((_, i) =>
                piece.shape.map(row => row[i]).reverse()
            );

            const oldShape = piece.shape;
            piece.shape = [rotated];

            if (checkTetrisCollision()) {
                piece.shape = oldShape;
            }

            drawTetris();
        }

        function checkTetrisCollision() {
            const piece = gameState.currentPiece;
            const board = gameState.board;

            for (let y = 0; y < piece.shape.length; y++) {
                for (let x = 0; x < piece.shape[y].length; x++) {
                    if (piece.shape[y][x]) {
                        const newX = piece.x + x;
                        const newY = piece.y + y;

                        if (newX < 0 || newX >= 10 || newY >= 20 ||
                            (newY >= 0 && board[newY][newX])) {
                            return true;
                        }
                    }
                }
            }
            return false;
        }

        function placeTetrisPiece() {
            const piece = gameState.currentPiece;
            const board = gameState.board;

            for (let y = 0; y < piece.shape.length; y++) {
                for (let x = 0; x < piece.shape[y].length; x++) {
                    if (piece.shape[y][x]) {
                        const boardY = piece.y + y;
                        const boardX = piece.x + x;
                        if (boardY >= 0) {
                            board[boardY][boardX] = piece.color;
                        }
                    }
                }
            }
        }

        function clearTetrisLines() {
            const board = gameState.board;
            let linesCleared = 0;

            for (let y = board.length - 1; y >= 0; y--) {
                if (board[y].every(cell => cell !== 0)) {
                    board.splice(y, 1);
                    board.unshift(Array(10).fill(0));
                    linesCleared++;
                    y++; // Check the same line again
                }
            }

            if (linesCleared > 0) {
                gameState.lines += linesCleared;
                gameState.score += linesCleared * 100 * gameState.level;
                gameState.level = Math.floor(gameState.lines / 10) + 1;
                document.getElementById('game-score').textContent = `Score: ${gameState.score} | Lines: ${gameState.lines} | Level: ${gameState.level}`;
            }
        }

        function startTetrisLoop() {
            if (gameLoop) clearInterval(gameLoop);
            gameLoop = setInterval(() => {
                if (!gamePaused) {
                    moveTetrisPiece(0, 1);
                }
            }, Math.max(50, 500 - gameState.level * 50));
        }

        function drawTetris() {
            const canvas = document.getElementById('tetris-canvas');
            if (!canvas) return;

            const ctx = canvas.getContext('2d');
            const board = gameState.board;
            const piece = gameState.currentPiece;

            // Clear canvas
            ctx.fillStyle = '#000';
            ctx.fillRect(0, 0, 300, 600);

            // Draw board
            for (let y = 0; y < board.length; y++) {
                for (let x = 0; x < board[y].length; x++) {
                    if (board[y][x]) {
                        ctx.fillStyle = board[y][x];
                        ctx.fillRect(x * 30, y * 30, 29, 29);
                    }
                }
            }

            // Draw current piece
            if (piece) {
                ctx.fillStyle = piece.color;
                for (let y = 0; y < piece.shape.length; y++) {
                    for (let x = 0; x < piece.shape[y].length; x++) {
                        if (piece.shape[y][x]) {
                            ctx.fillRect((piece.x + x) * 30, (piece.y + y) * 30, 29, 29);
                        }
                    }
                }
            }

            // Draw grid
            ctx.strokeStyle = '#333';
            for (let x = 0; x <= 10; x++) {
                ctx.beginPath();
                ctx.moveTo(x * 30, 0);
                ctx.lineTo(x * 30, 600);
                ctx.stroke();
            }
            for (let y = 0; y <= 20; y++) {
                ctx.beginPath();
                ctx.moveTo(0, y * 30);
                ctx.lineTo(300, y * 30);
                ctx.stroke();
            }
        }

        // Pong Game Implementation
        function initPongGame() {
            const gameArea = document.getElementById('game-area');
            gameArea.innerHTML = `
                <div class="game-info">
                    <h3>🏓 Pong</h3>
                    <p>Use W/S or Arrow Keys to move your paddle. First to 5 wins!</p>
                </div>
                <canvas id="pong-canvas" class="game-canvas" width="600" height="400"></canvas>
                <div class="game-controls">
                    Controls: W/↑ = Up, S/↓ = Down | Player: <span id="player-score">0</span> | AI: <span id="ai-score">0</span>
                </div>
            `;

            gameState = {
                ball: {x: 300, y: 200, dx: 4, dy: 3, size: 10},
                player: {x: 20, y: 150, width: 10, height: 100, speed: 6},
                ai: {x: 570, y: 150, width: 10, height: 100, speed: 4},
                playerScore: 0,
                aiScore: 0
            };

            drawPong();
            startPongLoop();

            document.addEventListener('keydown', handlePongInput);
        }

        function handlePongInput(event) {
            if (currentGame !== 'pong' || gamePaused) return;

            const key = event.key.toLowerCase();
            const player = gameState.player;

            switch(key) {
                case 'w':
                case 'arrowup':
                    if (player.y > 0) player.y -= player.speed;
                    break;
                case 's':
                case 'arrowdown':
                    if (player.y < 300) player.y += player.speed;
                    break;
            }

            drawPong();
        }

        function startPongLoop() {
            if (gameLoop) clearInterval(gameLoop);
            gameLoop = setInterval(updatePong, 16);
        }

        function updatePong() {
            if (gamePaused) return;

            const state = gameState;
            const ball = state.ball;
            const player = state.player;
            const ai = state.ai;

            // Move ball
            ball.x += ball.dx;
            ball.y += ball.dy;

            // Ball collision with top/bottom
            if (ball.y <= 0 || ball.y >= 390) {
                ball.dy = -ball.dy;
            }

            // Ball collision with paddles
            if (ball.x <= player.x + player.width &&
                ball.y >= player.y && ball.y <= player.y + player.height) {
                ball.dx = Math.abs(ball.dx);
                ball.dy += (Math.random() - 0.5) * 2;
            }

            if (ball.x >= ai.x - ball.size &&
                ball.y >= ai.y && ball.y <= ai.y + ai.height) {
                ball.dx = -Math.abs(ball.dx);
                ball.dy += (Math.random() - 0.5) * 2;
            }

            // AI movement
            const aiCenter = ai.y + ai.height / 2;
            if (ball.y < aiCenter - 10) {
                ai.y = Math.max(0, ai.y - ai.speed);
            } else if (ball.y > aiCenter + 10) {
                ai.y = Math.min(300, ai.y + ai.speed);
            }

            // Scoring
            if (ball.x < 0) {
                state.aiScore++;
                document.getElementById('ai-score').textContent = state.aiScore;
                resetPongBall();
                if (state.aiScore >= 5) {
                    gameOver('AI Wins!');
                    return;
                }
            } else if (ball.x > 600) {
                state.playerScore++;
                document.getElementById('player-score').textContent = state.playerScore;
                document.getElementById('game-score').textContent = `Score: ${state.playerScore}`;
                resetPongBall();
                if (state.playerScore >= 5) {
                    gameOver('You Win!');
                    return;
                }
            }

            drawPong();
        }

        function resetPongBall() {
            const ball = gameState.ball;
            ball.x = 300;
            ball.y = 200;
            ball.dx = (Math.random() > 0.5 ? 1 : -1) * 4;
            ball.dy = (Math.random() - 0.5) * 6;
        }

        function drawPong() {
            const canvas = document.getElementById('pong-canvas');
            if (!canvas) return;

            const ctx = canvas.getContext('2d');
            const state = gameState;

            // Clear canvas
            ctx.fillStyle = '#000';
            ctx.fillRect(0, 0, 600, 400);

            // Draw center line
            ctx.strokeStyle = '#fff';
            ctx.setLineDash([5, 5]);
            ctx.beginPath();
            ctx.moveTo(300, 0);
            ctx.lineTo(300, 400);
            ctx.stroke();
            ctx.setLineDash([]);

            // Draw paddles
            ctx.fillStyle = '#fff';
            ctx.fillRect(state.player.x, state.player.y, state.player.width, state.player.height);
            ctx.fillRect(state.ai.x, state.ai.y, state.ai.width, state.ai.height);

            // Draw ball
            ctx.beginPath();
            ctx.arc(state.ball.x, state.ball.y, state.ball.size, 0, Math.PI * 2);
            ctx.fill();
        }

        // Minesweeper Game Implementation
        function initMinesweeperGame() {
            const gameArea = document.getElementById('game-area');
            gameArea.innerHTML = `
                <div class="game-info">
                    <h3>💣 Minesweeper</h3>
                    <p>Left click to reveal, right click to flag. Find all mines!</p>
                    <div>Mines: <span id="mines-count">10</span> | Flags: <span id="flags-count">0</span> | Time: <span id="game-time">0</span>s</div>
                </div>
                <div id="minesweeper-board" style="display: inline-block; margin: 20px auto; background: #c0c0c0; padding: 10px; border: 2px inset #c0c0c0;"></div>
                <div class="game-controls">
                    Left Click = Reveal | Right Click = Flag/Unflag
                </div>
            `;

            gameState = {
                board: [],
                revealed: [],
                flagged: [],
                mines: [],
                width: 10,
                height: 10,
                mineCount: 10,
                flagCount: 0,
                gameTime: 0,
                gameStarted: false,
                gameWon: false
            };

            initMinesweeperBoard();
            drawMinesweeper();

            // Start timer
            gameLoop = setInterval(() => {
                if (gameState.gameStarted && !gameState.gameWon && !gamePaused) {
                    gameState.gameTime++;
                    document.getElementById('game-time').textContent = gameState.gameTime;
                }
            }, 1000);
        }

        function initMinesweeperBoard() {
            const state = gameState;

            // Initialize arrays
            state.board = Array(state.height).fill().map(() => Array(state.width).fill(0));
            state.revealed = Array(state.height).fill().map(() => Array(state.width).fill(false));
            state.flagged = Array(state.height).fill().map(() => Array(state.width).fill(false));
            state.mines = [];

            // Place mines
            while (state.mines.length < state.mineCount) {
                const x = Math.floor(Math.random() * state.width);
                const y = Math.floor(Math.random() * state.height);

                if (!state.mines.some(mine => mine.x === x && mine.y === y)) {
                    state.mines.push({x, y});
                    state.board[y][x] = -1; // -1 represents a mine
                }
            }

            // Calculate numbers
            for (let y = 0; y < state.height; y++) {
                for (let x = 0; x < state.width; x++) {
                    if (state.board[y][x] !== -1) {
                        let count = 0;
                        for (let dy = -1; dy <= 1; dy++) {
                            for (let dx = -1; dx <= 1; dx++) {
                                const ny = y + dy;
                                const nx = x + dx;
                                if (ny >= 0 && ny < state.height && nx >= 0 && nx < state.width) {
                                    if (state.board[ny][nx] === -1) count++;
                                }
                            }
                        }
                        state.board[y][x] = count;
                    }
                }
            }
        }

        function drawMinesweeper() {
            const boardElement = document.getElementById('minesweeper-board');
            if (!boardElement) return;

            const state = gameState;
            boardElement.innerHTML = '';
            boardElement.style.display = 'grid';
            boardElement.style.gridTemplateColumns = `repeat(${state.width}, 25px)`;
            boardElement.style.gap = '1px';

            for (let y = 0; y < state.height; y++) {
                for (let x = 0; x < state.width; x++) {
                    const cell = document.createElement('div');
                    cell.className = 'mine-cell';
                    cell.onclick = () => revealMineCell(x, y);
                    cell.oncontextmenu = (e) => {
                        e.preventDefault();
                        flagMineCell(x, y);
                    };

                    if (state.flagged[y][x]) {
                        cell.textContent = '🚩';
                        cell.classList.add('flagged');
                    } else if (state.revealed[y][x]) {
                        cell.classList.add('revealed');
                        if (state.board[y][x] === -1) {
                            cell.textContent = '💣';
                            cell.classList.add('mine');
                        } else if (state.board[y][x] > 0) {
                            cell.textContent = state.board[y][x];
                            cell.style.color = ['', '#0000ff', '#008000', '#ff0000', '#000080', '#800000', '#008080', '#000000', '#808080'][state.board[y][x]];
                        }
                    }

                    boardElement.appendChild(cell);
                }
            }
        }

        function revealMineCell(x, y) {
            const state = gameState;

            if (state.flagged[y][x] || state.revealed[y][x]) return;

            if (!state.gameStarted) {
                state.gameStarted = true;
            }

            state.revealed[y][x] = true;

            if (state.board[y][x] === -1) {
                // Hit a mine
                for (let mine of state.mines) {
                    state.revealed[mine.y][mine.x] = true;
                }
                drawMinesweeper();
                gameOver('You hit a mine!');
                return;
            }

            // Auto-reveal empty cells
            if (state.board[y][x] === 0) {
                for (let dy = -1; dy <= 1; dy++) {
                    for (let dx = -1; dx <= 1; dx++) {
                        const ny = y + dy;
                        const nx = x + dx;
                        if (ny >= 0 && ny < state.height && nx >= 0 && nx < state.width) {
                            if (!state.revealed[ny][nx] && !state.flagged[ny][nx]) {
                                revealMineCell(nx, ny);
                            }
                        }
                    }
                }
            }

            drawMinesweeper();
            checkMinesweeperWin();
        }

        function flagMineCell(x, y) {
            const state = gameState;

            if (state.revealed[y][x]) return;

            state.flagged[y][x] = !state.flagged[y][x];
            state.flagCount += state.flagged[y][x] ? 1 : -1;

            document.getElementById('flags-count').textContent = state.flagCount;
            document.getElementById('mines-count').textContent = state.mineCount - state.flagCount;

            drawMinesweeper();
            checkMinesweeperWin();
        }

        function checkMinesweeperWin() {
            const state = gameState;
            let revealedCount = 0;

            for (let y = 0; y < state.height; y++) {
                for (let x = 0; x < state.width; x++) {
                    if (state.revealed[y][x] && state.board[y][x] !== -1) {
                        revealedCount++;
                    }
                }
            }

            if (revealedCount === state.width * state.height - state.mineCount) {
                state.gameWon = true;
                document.getElementById('game-score').textContent = `Score: ${Math.max(0, 1000 - state.gameTime * 10)}`;
                gameOver(`You won in ${state.gameTime} seconds!`);
            }
        }

        // Chess Game Implementation (Simplified)
        function initChessGame() {
            const gameArea = document.getElementById('game-area');
            gameArea.innerHTML = `
                <div class="game-info">
                    <h3>♟️ Chess</h3>
                    <p>Click a piece to select, then click a valid square to move. White goes first!</p>
                    <div>Turn: <span id="chess-turn">White</span> | Moves: <span id="chess-moves">0</span></div>
                </div>
                <div id="chess-board" class="chess-board" style="display: inline-block; margin: 20px auto;"></div>
                <div class="game-controls">
                    Click piece → Click destination | ♔♕♖♗♘♙ = White | ♚♛♜♝♞♟ = Black
                </div>
            `;

            gameState = {
                board: [
                    ['♜','♞','♝','♛','♚','♝','♞','♜'],
                    ['♟','♟','♟','♟','♟','♟','♟','♟'],
                    ['','','','','','','',''],
                    ['','','','','','','',''],
                    ['','','','','','','',''],
                    ['','','','','','','',''],
                    ['♙','♙','♙','♙','♙','♙','♙','♙'],
                    ['♖','♘','♗','♕','♔','♗','♘','♖']
                ],
                selectedSquare: null,
                currentPlayer: 'white',
                moveCount: 0
            };

            drawChess();
        }

        function drawChess() {
            const boardElement = document.getElementById('chess-board');
            if (!boardElement) return;

            const state = gameState;
            boardElement.innerHTML = '';
            boardElement.style.display = 'grid';
            boardElement.style.gridTemplateColumns = 'repeat(8, 50px)';
            boardElement.style.border = '2px solid #8B4513';

            for (let row = 0; row < 8; row++) {
                for (let col = 0; col < 8; col++) {
                    const square = document.createElement('div');
                    square.className = `chess-square ${(row + col) % 2 === 0 ? 'light' : 'dark'}`;
                    square.textContent = state.board[row][col];
                    square.onclick = () => handleChessClick(row, col);

                    if (state.selectedSquare && state.selectedSquare.row === row && state.selectedSquare.col === col) {
                        square.classList.add('selected');
                    }

                    boardElement.appendChild(square);
                }
            }
        }

        function handleChessClick(row, col) {
            const state = gameState;
            const piece = state.board[row][col];

            if (state.selectedSquare) {
                // Try to move
                if (isValidChessMove(state.selectedSquare.row, state.selectedSquare.col, row, col)) {
                    state.board[row][col] = state.board[state.selectedSquare.row][state.selectedSquare.col];
                    state.board[state.selectedSquare.row][state.selectedSquare.col] = '';

                    state.currentPlayer = state.currentPlayer === 'white' ? 'black' : 'white';
                    state.moveCount++;

                    document.getElementById('chess-turn').textContent = state.currentPlayer === 'white' ? 'White' : 'Black';
                    document.getElementById('chess-moves').textContent = Math.floor(state.moveCount / 2) + 1;
                    document.getElementById('game-score').textContent = `Moves: ${state.moveCount}`;
                }
                state.selectedSquare = null;
            } else if (piece && isPlayerPiece(piece, state.currentPlayer)) {
                // Select piece
                state.selectedSquare = {row, col};
            }

            drawChess();
        }

        function isPlayerPiece(piece, player) {
            const whitePieces = '♔♕♖♗♘♙';
            const blackPieces = '♚♛♜♝♞♟';

            if (player === 'white') {
                return whitePieces.includes(piece);
            } else {
                return blackPieces.includes(piece);
            }
        }

        function isValidChessMove(fromRow, fromCol, toRow, toCol) {
            // Simplified chess validation - just check if destination is empty or enemy piece
            const fromPiece = gameState.board[fromRow][fromCol];
            const toPiece = gameState.board[toRow][toCol];

            if (toPiece && isPlayerPiece(toPiece, gameState.currentPlayer)) {
                return false; // Can't capture own piece
            }

            // Basic movement validation (simplified)
            const rowDiff = Math.abs(toRow - fromRow);
            const colDiff = Math.abs(toCol - fromCol);

            // Allow any move for demo purposes (real chess would have piece-specific rules)
            return rowDiff <= 2 && colDiff <= 2;
        }

        // Solitaire Game Implementation (Simplified)
        function initSolitaireGame() {
            const gameArea = document.getElementById('game-area');
            gameArea.innerHTML = `
                <div class="game-info">
                    <h3>🃏 Solitaire</h3>
                    <p>Move all cards to the foundation piles (Ace to King by suit)</p>
                    <div>Score: <span id="solitaire-score">0</span> | Moves: <span id="solitaire-moves">0</span> | Time: <span id="solitaire-time">0</span>s</div>
                </div>
                <div id="solitaire-board" style="padding: 20px; min-height: 400px;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 20px;">
                        <div style="display: flex; gap: 10px;">
                            <div class="card-stack" id="stock-pile" style="width: 60px; height: 84px;">Stock</div>
                            <div class="card-stack" id="waste-pile" style="width: 60px; height: 84px;">Waste</div>
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <div class="card-stack foundation" id="foundation-0" style="width: 60px; height: 84px;">♠</div>
                            <div class="card-stack foundation" id="foundation-1" style="width: 60px; height: 84px;">♥</div>
                            <div class="card-stack foundation" id="foundation-2" style="width: 60px; height: 84px;">♣</div>
                            <div class="card-stack foundation" id="foundation-3" style="width: 60px; height: 84px;">♦</div>
                        </div>
                    </div>
                    <div style="display: flex; gap: 10px; justify-content: center;">
                        <div class="card-stack tableau" id="tableau-0" style="width: 60px; min-height: 200px;"></div>
                        <div class="card-stack tableau" id="tableau-1" style="width: 60px; min-height: 200px;"></div>
                        <div class="card-stack tableau" id="tableau-2" style="width: 60px; min-height: 200px;"></div>
                        <div class="card-stack tableau" id="tableau-3" style="width: 60px; min-height: 200px;"></div>
                        <div class="card-stack tableau" id="tableau-4" style="width: 60px; min-height: 200px;"></div>
                        <div class="card-stack tableau" id="tableau-5" style="width: 60px; min-height: 200px;"></div>
                        <div class="card-stack tableau" id="tableau-6" style="width: 60px; min-height: 200px;"></div>
                    </div>
                </div>
                <div class="game-controls">
                    Click cards to move them. Build down in alternating colors on tableau, up by suit on foundations.
                </div>
            `;

            gameState = {
                deck: [],
                stock: [],
                waste: [],
                foundations: [[], [], [], []],
                tableau: [[], [], [], [], [], [], []],
                score: 0,
                moves: 0,
                gameTime: 0
            };

            initSolitaireDeck();
            dealSolitaire();
            drawSolitaire();

            // Start timer
            gameLoop = setInterval(() => {
                if (!gamePaused) {
                    gameState.gameTime++;
                    document.getElementById('solitaire-time').textContent = gameState.gameTime;
                }
            }, 1000);
        }

        function initSolitaireDeck() {
            const suits = ['♠', '♥', '♣', '♦'];
            const ranks = ['A', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K'];

            gameState.deck = [];
            for (let suit of suits) {
                for (let rank of ranks) {
                    gameState.deck.push({
                        suit: suit,
                        rank: rank,
                        value: ranks.indexOf(rank) + 1,
                        color: (suit === '♥' || suit === '♦') ? 'red' : 'black',
                        faceUp: false
                    });
                }
            }

            // Shuffle deck
            for (let i = gameState.deck.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [gameState.deck[i], gameState.deck[j]] = [gameState.deck[j], gameState.deck[i]];
            }
        }

        function dealSolitaire() {
            const state = gameState;
            let cardIndex = 0;

            // Deal to tableau
            for (let col = 0; col < 7; col++) {
                for (let row = 0; row <= col; row++) {
                    const card = state.deck[cardIndex++];
                    card.faceUp = (row === col); // Only top card face up
                    state.tableau[col].push(card);
                }
            }

            // Remaining cards to stock
            state.stock = state.deck.slice(cardIndex);
        }

        function drawSolitaire() {
            // Simplified drawing - just show card counts for demo
            document.getElementById('stock-pile').innerHTML = `Stock<br>${gameState.stock.length}`;
            document.getElementById('waste-pile').innerHTML = `Waste<br>${gameState.waste.length}`;

            for (let i = 0; i < 4; i++) {
                document.getElementById(`foundation-${i}`).innerHTML = `${['♠','♥','♣','♦'][i]}<br>${gameState.foundations[i].length}`;
            }

            for (let i = 0; i < 7; i++) {
                document.getElementById(`tableau-${i}`).innerHTML = `Col ${i+1}<br>${gameState.tableau[i].length} cards`;
            }

            document.getElementById('solitaire-score').textContent = gameState.score;
            document.getElementById('solitaire-moves').textContent = gameState.moves;
        }

        // System functions
        function showSystemInfo() {
            showNotification('System: Kronos OS v2.0 | CPU: 4 cores | RAM: 8GB | Uptime: 2 days', 'info');
        }

        // Settings system
        let systemSettings = {
            darkTheme: false,
            animations: true,
            wallpaper: 'ocean-blue',
            iconSize: 48,
            brightness: 80,
            volume: 75,
            wifiEnabled: true,
            firewallEnabled: true,
            autoLock: true,
            powerMode: 'balanced'
        };

        // Select settings category
        function selectSettingsCategory(category) {
            // Update sidebar selection
            document.querySelectorAll('.settings-category').forEach(cat => {
                cat.classList.remove('active');
            });
            document.querySelector(`[data-category="${category}"]`).classList.add('active');

            // Load category content
            loadSettingsCategory(category);
        }

        // Load settings category content
        function loadSettingsCategory(category) {
            const content = document.getElementById('settings-content');

            switch (category) {
                case 'appearance':
                    content.innerHTML = `
                        <h3 style="margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                            <span>🎨</span>
                            <span>Appearance Settings</span>
                        </h3>

                        <div class="setting-item" style="background: white; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px; margin-bottom: 15px;">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <div style="font-weight: 600; margin-bottom: 4px;">Dark Theme</div>
                                    <div style="color: #666; font-size: 14px;">Use dark colors for the desktop and applications</div>
                                </div>
                                <div class="toggle-switch ${systemSettings.darkTheme ? 'active' : ''}" onclick="toggleSystemSetting(this, 'darkTheme')" style="width: 50px; height: 24px; background: ${systemSettings.darkTheme ? '#E95420' : '#ccc'}; border-radius: 12px; position: relative; cursor: pointer; transition: all 0.3s;">
                                    <div class="toggle-knob" style="position: absolute; top: 2px; left: ${systemSettings.darkTheme ? '28px' : '2px'}; width: 20px; height: 20px; background: white; border-radius: 50%; transition: all 0.3s; box-shadow: 0 2px 4px rgba(0,0,0,0.2);"></div>
                                </div>
                            </div>
                        </div>

                        <div class="setting-item" style="background: white; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px; margin-bottom: 15px;">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <div style="font-weight: 600; margin-bottom: 4px;">Window Animations</div>
                                    <div style="color: #666; font-size: 14px;">Enable smooth transitions and effects</div>
                                </div>
                                <div class="toggle-switch ${systemSettings.animations ? 'active' : ''}" onclick="toggleSystemSetting(this, 'animations')" style="width: 50px; height: 24px; background: ${systemSettings.animations ? '#E95420' : '#ccc'}; border-radius: 12px; position: relative; cursor: pointer; transition: all 0.3s;">
                                    <div class="toggle-knob" style="position: absolute; top: 2px; left: ${systemSettings.animations ? '28px' : '2px'}; width: 20px; height: 20px; background: white; border-radius: 50%; transition: all 0.3s; box-shadow: 0 2px 4px rgba(0,0,0,0.2);"></div>
                                </div>
                            </div>
                        </div>

                        <div class="setting-item" style="background: white; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px; margin-bottom: 15px;">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <div style="font-weight: 600; margin-bottom: 4px;">Desktop Wallpaper</div>
                                    <div style="color: #666; font-size: 14px;">Choose your desktop background</div>
                                </div>
                                <button onclick="openApp('wallpaper-selector')" style="background: #E95420; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer;">Change...</button>
                            </div>
                        </div>

                        <div class="setting-item" style="background: white; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px; margin-bottom: 15px;">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <div style="font-weight: 600; margin-bottom: 4px;">Icon Size</div>
                                    <div style="color: #666; font-size: 14px;">Size of desktop and application icons</div>
                                </div>
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <div style="width: 100px; height: 4px; background: #ddd; border-radius: 2px; position: relative; cursor: pointer;" onclick="setIconSize(event)">
                                        <div style="width: ${(systemSettings.iconSize - 24) / (128 - 24) * 100}%; height: 100%; background: #E95420; border-radius: 2px;"></div>
                                        <div style="position: absolute; top: -6px; left: calc(${(systemSettings.iconSize - 24) / (128 - 24) * 100}% - 8px); width: 16px; height: 16px; background: #E95420; border-radius: 50%; cursor: pointer;"></div>
                                    </div>
                                    <span style="font-weight: 600; min-width: 40px;">${systemSettings.iconSize}px</span>
                                </div>
                            </div>
                        </div>
                    `;
                    break;

                case 'display':
                    content.innerHTML = `
                        <h3 style="margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                            <span>🖥️</span>
                            <span>Display Settings</span>
                        </h3>

                        <div class="setting-item" style="background: white; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px; margin-bottom: 15px;">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <div style="font-weight: 600; margin-bottom: 4px;">Screen Resolution</div>
                                    <div style="color: #666; font-size: 14px;">Display resolution setting</div>
                                </div>
                                <select style="padding: 8px; border: 1px solid #ccc; border-radius: 4px;" onchange="changeSystemSetting('resolution', this.value)">
                                    <option value="1920x1080">1920x1080</option>
                                    <option value="1680x1050">1680x1050</option>
                                    <option value="1440x900">1440x900</option>
                                    <option value="1366x768">1366x768</option>
                                </select>
                            </div>
                        </div>

                        <div class="setting-item" style="background: white; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px; margin-bottom: 15px;">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <div style="font-weight: 600; margin-bottom: 4px;">Brightness</div>
                                    <div style="color: #666; font-size: 14px;">Screen brightness level</div>
                                </div>
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <div style="width: 100px; height: 4px; background: #ddd; border-radius: 2px; position: relative; cursor: pointer;" onclick="setBrightness(event)">
                                        <div style="width: ${systemSettings.brightness}%; height: 100%; background: #E95420; border-radius: 2px;"></div>
                                        <div style="position: absolute; top: -6px; left: calc(${systemSettings.brightness}% - 8px); width: 16px; height: 16px; background: #E95420; border-radius: 50%; cursor: pointer;"></div>
                                    </div>
                                    <span style="font-weight: 600; min-width: 40px;">${systemSettings.brightness}%</span>
                                </div>
                            </div>
                        </div>
                    `;
                    break;

                case 'audio':
                    content.innerHTML = `
                        <h3 style="margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                            <span>🔊</span>
                            <span>Audio Settings</span>
                        </h3>

                        <div class="setting-item" style="background: white; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px; margin-bottom: 15px;">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <div style="font-weight: 600; margin-bottom: 4px;">Master Volume</div>
                                    <div style="color: #666; font-size: 14px;">System master volume level</div>
                                </div>
                                <div style="display: flex; align-items: center; gap: 10px;">
                                    <div style="width: 100px; height: 4px; background: #ddd; border-radius: 2px; position: relative; cursor: pointer;" onclick="setVolume(event)">
                                        <div style="width: ${systemSettings.volume}%; height: 100%; background: #E95420; border-radius: 2px;"></div>
                                        <div style="position: absolute; top: -6px; left: calc(${systemSettings.volume}% - 8px); width: 16px; height: 16px; background: #E95420; border-radius: 50%; cursor: pointer;"></div>
                                    </div>
                                    <span style="font-weight: 600; min-width: 40px;">${systemSettings.volume}%</span>
                                </div>
                            </div>
                        </div>

                        <div class="setting-item" style="background: white; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px; margin-bottom: 15px;">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <div style="font-weight: 600; margin-bottom: 4px;">System Sounds</div>
                                    <div style="color: #666; font-size: 14px;">Play sounds for system events</div>
                                </div>
                                <div class="toggle-switch active" onclick="toggleSystemSetting(this, 'systemSounds')" style="width: 50px; height: 24px; background: #E95420; border-radius: 12px; position: relative; cursor: pointer; transition: all 0.3s;">
                                    <div class="toggle-knob" style="position: absolute; top: 2px; left: 28px; width: 20px; height: 20px; background: white; border-radius: 50%; transition: all 0.3s; box-shadow: 0 2px 4px rgba(0,0,0,0.2);"></div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;

                case 'system':
                    content.innerHTML = `
                        <h3 style="margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                            <span>ℹ️</span>
                            <span>System Information</span>
                        </h3>

                        <div class="setting-item" style="background: white; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px; margin-bottom: 15px;">
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                                <div>
                                    <div style="font-weight: 600; margin-bottom: 8px;">Operating System</div>
                                    <div style="color: #666;">Kronos OS v2.0 Advanced</div>
                                    <div style="color: #666; font-size: 12px;">64-bit Ubuntu-compatible</div>
                                </div>
                                <div>
                                    <div style="font-weight: 600; margin-bottom: 8px;">Processor</div>
                                    <div style="color: #666;">Intel Core i7-8550U</div>
                                    <div style="color: #666; font-size: 12px;">4 cores @ 1.80GHz</div>
                                </div>
                                <div>
                                    <div style="font-weight: 600; margin-bottom: 8px;">Memory</div>
                                    <div style="color: #666;">8.0 GB RAM</div>
                                    <div style="color: #666; font-size: 12px;">2.1 GB used (26%)</div>
                                </div>
                                <div>
                                    <div style="font-weight: 600; margin-bottom: 8px;">Storage</div>
                                    <div style="color: #666;">256 GB SSD</div>
                                    <div style="color: #666; font-size: 12px;">128 GB available</div>
                                </div>
                                <div>
                                    <div style="font-weight: 600; margin-bottom: 8px;">Graphics</div>
                                    <div style="color: #666;">Intel UHD Graphics 620</div>
                                    <div style="color: #666; font-size: 12px;">Integrated GPU</div>
                                </div>
                                <div>
                                    <div style="font-weight: 600; margin-bottom: 8px;">Uptime</div>
                                    <div style="color: #666;">2 days, 14:32:18</div>
                                    <div style="color: #666; font-size: 12px;">Last boot: Jan 13</div>
                                </div>
                            </div>
                        </div>

                        <div class="setting-item" style="background: white; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px; margin-bottom: 15px;">
                            <div style="text-align: center;">
                                <h4 style="margin-bottom: 10px;">Kronos OS Advanced</h4>
                                <p style="color: #666; margin-bottom: 15px;">Complete Ubuntu-compatible operating system with advanced features</p>
                                <div style="display: flex; gap: 10px; justify-content: center;">
                                    <button onclick="showNotification('Checking for updates...', 'info')" style="background: #E95420; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer;">Check for Updates</button>
                                    <button onclick="showNotification('System information copied to clipboard', 'info')" style="background: #6c757d; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer;">Copy Info</button>
                                </div>
                            </div>
                        </div>
                    `;
                    break;

                default:
                    content.innerHTML = `
                        <h3 style="margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                            <span>⚙️</span>
                            <span>${category.charAt(0).toUpperCase() + category.slice(1)} Settings</span>
                        </h3>

                        <div class="setting-item" style="background: white; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px; margin-bottom: 15px;">
                            <div style="text-align: center; padding: 40px;">
                                <h4 style="margin-bottom: 10px;">Coming Soon</h4>
                                <p style="color: #666;">This settings category is under development.</p>
                            </div>
                        </div>
                    `;
            }
        }

        // Toggle system setting
        function toggleSystemSetting(element, setting) {
            element.classList.toggle('active');
            const isActive = element.classList.contains('active');

            systemSettings[setting] = isActive;

            // Update visual state
            element.style.background = isActive ? '#E95420' : '#ccc';
            const knob = element.querySelector('.toggle-knob');
            knob.style.left = isActive ? '28px' : '2px';

            // Apply setting changes
            if (setting === 'darkTheme') {
                applyDarkTheme(isActive);
            }

            showNotification(`${setting.replace(/([A-Z])/g, ' $1').toLowerCase()} ${isActive ? 'enabled' : 'disabled'}`, 'info');
        }

        // Change system setting
        function changeSystemSetting(setting, value) {
            systemSettings[setting] = value;
            showNotification(`${setting} changed to ${value}`, 'info');
        }

        // Set icon size
        function setIconSize(event) {
            const slider = event.target.closest('div');
            const rect = slider.getBoundingClientRect();
            const percentage = Math.max(0, Math.min(100, ((event.clientX - rect.left) / rect.width) * 100));
            const size = Math.round(24 + (percentage / 100) * (128 - 24));

            systemSettings.iconSize = size;

            // Update slider visual
            const track = slider.querySelector('div');
            const thumb = slider.querySelector('div:last-child');
            const valueDisplay = slider.parentElement.querySelector('span');

            track.style.width = percentage + '%';
            thumb.style.left = `calc(${percentage}% - 8px)`;
            valueDisplay.textContent = size + 'px';

            showNotification(`Icon size set to ${size}px`, 'info');
        }

        // Set brightness
        function setBrightness(event) {
            const slider = event.target.closest('div');
            const rect = slider.getBoundingClientRect();
            const percentage = Math.max(0, Math.min(100, ((event.clientX - rect.left) / rect.width) * 100));
            const brightness = Math.round(percentage);

            systemSettings.brightness = brightness;

            // Update slider visual
            const track = slider.querySelector('div');
            const thumb = slider.querySelector('div:last-child');
            const valueDisplay = slider.parentElement.querySelector('span');

            track.style.width = percentage + '%';
            thumb.style.left = `calc(${percentage}% - 8px)`;
            valueDisplay.textContent = brightness + '%';

            showNotification(`Brightness set to ${brightness}%`, 'info');
        }

        // Set volume
        function setVolume(event) {
            const slider = event.target.closest('div');
            const rect = slider.getBoundingClientRect();
            const percentage = Math.max(0, Math.min(100, ((event.clientX - rect.left) / rect.width) * 100));
            const volume = Math.round(percentage);

            systemSettings.volume = volume;

            // Update slider visual
            const track = slider.querySelector('div');
            const thumb = slider.querySelector('div:last-child');
            const valueDisplay = slider.parentElement.querySelector('span');

            track.style.width = percentage + '%';
            thumb.style.left = `calc(${percentage}% - 8px)`;
            valueDisplay.textContent = volume + '%';

            showNotification(`Volume set to ${volume}%`, 'info');
        }

        // Apply dark theme
        function applyDarkTheme(enabled) {
            if (enabled) {
                document.body.style.filter = 'invert(1) hue-rotate(180deg)';
                showNotification('Dark theme enabled - restart required for full effect', 'info');
            } else {
                document.body.style.filter = '';
                showNotification('Dark theme disabled', 'info');
            }
        }

        // Search settings
        function searchSettings(query) {
            if (query.length < 2) return;

            const results = [];
            const categories = ['appearance', 'display', 'audio', 'network', 'security', 'performance'];

            // Simple search simulation
            if (query.toLowerCase().includes('dark')) {
                results.push('Dark Theme setting found in Appearance');
            }
            if (query.toLowerCase().includes('volume') || query.toLowerCase().includes('sound')) {
                results.push('Volume settings found in Audio');
            }
            if (query.toLowerCase().includes('bright')) {
                results.push('Brightness setting found in Display');
            }

            if (results.length > 0) {
                showNotification(`Found ${results.length} settings matching "${query}"`, 'info');
            }
        }

        // System Information functions
        let currentSystemInfoCategory = 'overview';
        let systemInfoData = {
            cpu: { usage: 15.2, temperature: 45.2, frequency: 2.4 },
            memory: { used: 2.1, total: 8.0, percentage: 26 },
            storage: { used: 128, total: 256, percentage: 50 },
            processes: 187,
            uptime: '2d 14h'
        };

        // Select system info category
        function selectSystemInfoCategory(category) {
            currentSystemInfoCategory = category;

            // Update sidebar selection
            document.querySelectorAll('.sysinfo-category').forEach(cat => {
                cat.classList.remove('active');
            });
            document.querySelector(`[data-category="${category}"]`).classList.add('active');

            // Load category content
            loadSystemInfoCategory(category);
        }

        // Load system info category content
        function loadSystemInfoCategory(category) {
            const content = document.getElementById('system-info-content');

            switch (category) {
                case 'overview':
                    loadSystemOverview(content);
                    break;
                case 'cpu':
                    loadCPUInfo(content);
                    break;
                case 'memory':
                    loadMemoryInfo(content);
                    break;
                case 'storage':
                    loadStorageInfo(content);
                    break;
                case 'graphics':
                    loadGraphicsInfo(content);
                    break;
                case 'network':
                    loadNetworkInfo(content);
                    break;
                default:
                    content.innerHTML = `
                        <h3 style="margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                            <span>ℹ️</span>
                            <span>${category.charAt(0).toUpperCase() + category.slice(1)} Information</span>
                        </h3>
                        <div style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 40px; text-align: center;">
                            <h4>Coming Soon</h4>
                            <p style="color: #666; margin-top: 10px;">This information category is under development.</p>
                        </div>
                    `;
            }
        }

        // Load CPU information
        function loadCPUInfo(content) {
            content.innerHTML = `
                <h3 style="margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                    <span>🖥️</span>
                    <span>Processor Information</span>
                </h3>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                    <div style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px;">
                        <h4 style="margin-bottom: 15px; color: #333;">CPU Details</h4>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                            <span style="color: #666;">Model:</span>
                            <span style="font-weight: 600;">Intel Core i7-8550U</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                            <span style="color: #666;">Cores:</span>
                            <span style="font-weight: 600;">4 cores, 8 threads</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                            <span style="color: #666;">Base Frequency:</span>
                            <span style="font-weight: 600;">1.80 GHz</span>
                        </div>
                        <div style="display: flex; justify-content: space-between;">
                            <span style="color: #666;">Max Frequency:</span>
                            <span style="font-weight: 600;">4.00 GHz</span>
                        </div>
                    </div>

                    <div style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px;">
                        <h4 style="margin-bottom: 15px; color: #333;">Cache Information</h4>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                            <span style="color: #666;">L1 Cache:</span>
                            <span style="font-weight: 600;">256 KB</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                            <span style="color: #666;">L2 Cache:</span>
                            <span style="font-weight: 600;">1 MB</span>
                        </div>
                        <div style="display: flex; justify-content: space-between;">
                            <span style="color: #666;">L3 Cache:</span>
                            <span style="font-weight: 600;">8 MB</span>
                        </div>
                    </div>
                </div>

                <div style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px; margin-top: 20px;">
                    <h4 style="margin-bottom: 15px; color: #333;">Real-time Performance</h4>
                    <div style="margin-bottom: 20px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                            <span>CPU Usage</span>
                            <span>${systemInfoData.cpu.usage}%</span>
                        </div>
                        <div style="width: 100%; height: 20px; background: #e9ecef; border-radius: 10px; overflow: hidden;">
                            <div style="height: 100%; background: linear-gradient(90deg, #28a745, #20c997); width: ${systemInfoData.cpu.usage}%; transition: width 0.5s ease; border-radius: 10px;"></div>
                        </div>
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px;">
                        <div style="text-align: center;">
                            <div style="font-size: 24px; font-weight: bold; color: #dc3545;">${systemInfoData.cpu.temperature}°C</div>
                            <div style="color: #666; font-size: 12px;">Temperature</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 24px; font-weight: bold; color: #6610f2;">${systemInfoData.cpu.frequency} GHz</div>
                            <div style="color: #666; font-size: 12px;">Current Frequency</div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Load memory information
        function loadMemoryInfo(content) {
            content.innerHTML = `
                <h3 style="margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                    <span>💾</span>
                    <span>Memory Information</span>
                </h3>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                    <div style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px;">
                        <h4 style="margin-bottom: 15px; color: #333;">Physical Memory</h4>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                            <span style="color: #666;">Total:</span>
                            <span style="font-weight: 600;">${systemInfoData.memory.total} GB</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                            <span style="color: #666;">Used:</span>
                            <span style="font-weight: 600;">${systemInfoData.memory.used} GB</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 15px;">
                            <span style="color: #666;">Available:</span>
                            <span style="font-weight: 600;">${(systemInfoData.memory.total - systemInfoData.memory.used).toFixed(1)} GB</span>
                        </div>

                        <div style="margin-bottom: 10px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                <span>Memory Usage</span>
                                <span>${systemInfoData.memory.percentage}%</span>
                            </div>
                            <div style="width: 100%; height: 20px; background: #e9ecef; border-radius: 10px; overflow: hidden;">
                                <div style="height: 100%; background: linear-gradient(90deg, #007bff, #6610f2); width: ${systemInfoData.memory.percentage}%; transition: width 0.5s ease; border-radius: 10px;"></div>
                            </div>
                        </div>
                    </div>

                    <div style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px;">
                        <h4 style="margin-bottom: 15px; color: #333;">Memory Modules</h4>
                        <div style="margin-bottom: 15px;">
                            <div style="font-weight: 600; margin-bottom: 5px;">Module 1</div>
                            <div style="color: #666; font-size: 14px;">4 GB DDR4-2400 (Samsung)</div>
                        </div>
                        <div>
                            <div style="font-weight: 600; margin-bottom: 5px;">Module 2</div>
                            <div style="color: #666; font-size: 14px;">4 GB DDR4-2400 (Samsung)</div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Load storage information
        function loadStorageInfo(content) {
            content.innerHTML = `
                <h3 style="margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                    <span>💿</span>
                    <span>Storage Information</span>
                </h3>

                <div style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
                    <h4 style="margin-bottom: 15px; color: #333;">Primary SSD (NVMe)</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 15px;">
                        <div>
                            <div style="color: #666;">Type:</div>
                            <div style="font-weight: 600;">NVMe SSD</div>
                        </div>
                        <div>
                            <div style="color: #666;">Capacity:</div>
                            <div style="font-weight: 600;">${systemInfoData.storage.total} GB</div>
                        </div>
                        <div>
                            <div style="color: #666;">Free Space:</div>
                            <div style="font-weight: 600;">${systemInfoData.storage.total - systemInfoData.storage.used} GB</div>
                        </div>
                        <div>
                            <div style="color: #666;">Model:</div>
                            <div style="font-weight: 600;">Samsung 980 PRO</div>
                        </div>
                    </div>

                    <div style="margin-bottom: 10px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                            <span>Storage Usage</span>
                            <span>${systemInfoData.storage.percentage}%</span>
                        </div>
                        <div style="width: 100%; height: 20px; background: #e9ecef; border-radius: 10px; overflow: hidden;">
                            <div style="height: 100%; background: linear-gradient(90deg, #fd7e14, #e83e8c); width: ${systemInfoData.storage.percentage}%; transition: width 0.5s ease; border-radius: 10px;"></div>
                        </div>
                    </div>
                </div>

                <div style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px;">
                    <h4 style="margin-bottom: 15px; color: #333;">Secondary HDD</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                        <div>
                            <div style="color: #666;">Type:</div>
                            <div style="font-weight: 600;">SATA HDD</div>
                        </div>
                        <div>
                            <div style="color: #666;">Capacity:</div>
                            <div style="font-weight: 600;">1 TB</div>
                        </div>
                        <div>
                            <div style="color: #666;">RPM:</div>
                            <div style="font-weight: 600;">7200 RPM</div>
                        </div>
                        <div>
                            <div style="color: #666;">Model:</div>
                            <div style="font-weight: 600;">WD Blue</div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Load graphics information
        function loadGraphicsInfo(content) {
            content.innerHTML = `
                <h3 style="margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                    <span>🎮</span>
                    <span>Graphics Information</span>
                </h3>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                    <div style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px;">
                        <h4 style="margin-bottom: 15px; color: #333;">Graphics Card</h4>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                            <span style="color: #666;">Vendor:</span>
                            <span style="font-weight: 600;">Intel Corporation</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                            <span style="color: #666;">Model:</span>
                            <span style="font-weight: 600;">UHD Graphics 620</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                            <span style="color: #666;">Driver:</span>
                            <span style="font-weight: 600;">27.20.100.8681</span>
                        </div>
                        <div style="display: flex; justify-content: space-between;">
                            <span style="color: #666;">Memory:</span>
                            <span style="font-weight: 600;">2 GB (Shared)</span>
                        </div>
                    </div>

                    <div style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px;">
                        <h4 style="margin-bottom: 15px; color: #333;">Performance</h4>
                        <div style="margin-bottom: 20px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                <span>GPU Usage</span>
                                <span>25%</span>
                            </div>
                            <div style="width: 100%; height: 20px; background: #e9ecef; border-radius: 10px; overflow: hidden;">
                                <div style="height: 100%; background: linear-gradient(90deg, #6f42c1, #e83e8c); width: 25%; transition: width 0.5s ease; border-radius: 10px;"></div>
                            </div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 24px; font-weight: bold; color: #dc3545;">55°C</div>
                            <div style="color: #666; font-size: 12px;">GPU Temperature</div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Load network information
        function loadNetworkInfo(content) {
            content.innerHTML = `
                <h3 style="margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                    <span>🌐</span>
                    <span>Network Information</span>
                </h3>

                <div style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
                    <h4 style="margin-bottom: 15px; color: #333;">Ethernet Connection</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                        <div>
                            <div style="color: #666;">Status:</div>
                            <div style="font-weight: 600; color: #28a745;">Connected</div>
                        </div>
                        <div>
                            <div style="color: #666;">IP Address:</div>
                            <div style="font-weight: 600;">192.168.1.100</div>
                        </div>
                        <div>
                            <div style="color: #666;">MAC Address:</div>
                            <div style="font-weight: 600;">00:1B:44:11:3A:B7</div>
                        </div>
                        <div>
                            <div style="color: #666;">Link Speed:</div>
                            <div style="font-weight: 600;">1 Gbps</div>
                        </div>
                    </div>
                </div>

                <div style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px;">
                    <h4 style="margin-bottom: 15px; color: #333;">WiFi Adapter</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                        <div>
                            <div style="color: #666;">Status:</div>
                            <div style="font-weight: 600; color: #dc3545;">Disconnected</div>
                        </div>
                        <div>
                            <div style="color: #666;">MAC Address:</div>
                            <div style="font-weight: 600;">A4:34:D9:12:34:56</div>
                        </div>
                        <div>
                            <div style="color: #666;">Max Speed:</div>
                            <div style="font-weight: 600;">300 Mbps</div>
                        </div>
                        <div>
                            <div style="color: #666;">Standard:</div>
                            <div style="font-weight: 600;">802.11n</div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Load system overview (default)
        function loadSystemOverview(content) {
            // Content is already loaded in HTML, just update real-time data
            updateSystemInfoRealtime();
        }

        // Refresh system information
        function refreshSystemInfo() {
            // Simulate data updates
            systemInfoData.cpu.usage = 10 + Math.random() * 30;
            systemInfoData.cpu.temperature = 40 + Math.random() * 20;
            systemInfoData.cpu.frequency = 1.8 + Math.random() * 2.2;
            systemInfoData.memory.used = 1.5 + Math.random() * 2;
            systemInfoData.memory.percentage = (systemInfoData.memory.used / systemInfoData.memory.total * 100);
            systemInfoData.processes = 180 + Math.floor(Math.random() * 20);

            // Update display
            if (currentSystemInfoCategory === 'overview') {
                updateSystemInfoRealtime();
            } else {
                loadSystemInfoCategory(currentSystemInfoCategory);
            }

            showNotification('System information refreshed!', 'info');
        }

        // Update real-time system info data
        function updateSystemInfoRealtime() {
            // Update CPU usage
            const cpuElement = document.getElementById('sysinfo-cpu-usage');
            const cpuBar = document.getElementById('sysinfo-cpu-bar');
            if (cpuElement && cpuBar) {
                cpuElement.textContent = `${systemInfoData.cpu.usage.toFixed(1)}%`;
                cpuBar.style.width = `${systemInfoData.cpu.usage}%`;
            }

            // Update memory usage
            const memoryElement = document.getElementById('sysinfo-memory-usage');
            const memoryBar = document.getElementById('sysinfo-memory-bar');
            if (memoryElement && memoryBar) {
                memoryElement.textContent = `${systemInfoData.memory.used.toFixed(1)} GB / ${systemInfoData.memory.total} GB (${systemInfoData.memory.percentage.toFixed(0)}%)`;
                memoryBar.style.width = `${systemInfoData.memory.percentage}%`;
            }

            // Update other stats
            const tempElement = document.getElementById('sysinfo-cpu-temp');
            const freqElement = document.getElementById('sysinfo-cpu-freq');
            const procElement = document.getElementById('sysinfo-processes');

            if (tempElement) tempElement.textContent = `${systemInfoData.cpu.temperature.toFixed(1)}°C`;
            if (freqElement) freqElement.textContent = `${systemInfoData.cpu.frequency.toFixed(1)} GHz`;
            if (procElement) procElement.textContent = systemInfoData.processes;
        }

        // Auto-refresh system info
        setInterval(() => {
            if (openWindows.has('system-info-window')) {
                refreshSystemInfo();
            }
        }, 3000); // Update every 3 seconds

        // Terminal Application Functions
        let terminalHistory = [];
        let historyIndex = -1;
        let currentDirectory = '/home/user';
        let terminalEnvironment = {
            USER: 'user',
            HOME: '/home/user',
            PATH: '/bin:/usr/bin:/usr/local/bin',
            SHELL: '/bin/ksh',
            TERM: 'kronos-terminal',
            PWD: '/home/user'
        };

        // File system simulation
        let fileSystem = {
            '/': {
                type: 'directory',
                contents: {
                    'home': {
                        type: 'directory',
                        contents: {
                            'user': {
                                type: 'directory',
                                contents: {
                                    'documents': { type: 'directory', contents: {} },
                                    'downloads': { type: 'directory', contents: {} },
                                    'desktop': { type: 'directory', contents: {} },
                                    'readme.txt': { type: 'file', content: 'Welcome to Kronos OS!\nThis is your home directory.' },
                                    'test.sh': { type: 'file', content: '#!/bin/bash\necho "Hello from Kronos OS!"' }
                                }
                            }
                        }
                    },
                    'bin': {
                        type: 'directory',
                        contents: {
                            'ls': { type: 'executable' },
                            'cat': { type: 'executable' },
                            'pwd': { type: 'executable' },
                            'cd': { type: 'executable' },
                            'mkdir': { type: 'executable' },
                            'rm': { type: 'executable' },
                            'cp': { type: 'executable' },
                            'mv': { type: 'executable' }
                        }
                    },
                    'usr': {
                        type: 'directory',
                        contents: {
                            'bin': { type: 'directory', contents: {} },
                            'lib': { type: 'directory', contents: {} }
                        }
                    },
                    'etc': {
                        type: 'directory',
                        contents: {
                            'passwd': { type: 'file', content: 'root:x:0:0:root:/root:/bin/bash\nuser:x:1000:1000:user:/home/user:/bin/ksh' },
                            'hostname': { type: 'file', content: 'kronos-desktop' }
                        }
                    }
                }
            }
        };

        // Handle terminal input
        function handleTerminalInput(event) {
            if (event.key === 'Enter') {
                const input = document.getElementById('terminal-input');
                const command = input.value.trim();

                if (command) {
                    // Add to history
                    terminalHistory.push(command);
                    historyIndex = terminalHistory.length;

                    // Display command
                    addTerminalLine(`user@kronos-desktop:${getCurrentDirectoryDisplay()}$ ${command}`, 'command');

                    // Execute command
                    executeCommand(command);
                }

                // Clear input
                input.value = '';

                // Scroll to bottom
                scrollTerminalToBottom();
            } else if (event.key === 'ArrowUp') {
                // Navigate history up
                if (historyIndex > 0) {
                    historyIndex--;
                    document.getElementById('terminal-input').value = terminalHistory[historyIndex];
                }
                event.preventDefault();
            } else if (event.key === 'ArrowDown') {
                // Navigate history down
                if (historyIndex < terminalHistory.length - 1) {
                    historyIndex++;
                    document.getElementById('terminal-input').value = terminalHistory[historyIndex];
                } else {
                    historyIndex = terminalHistory.length;
                    document.getElementById('terminal-input').value = '';
                }
                event.preventDefault();
            } else if (event.key === 'Tab') {
                // Tab completion (basic)
                event.preventDefault();
                const input = document.getElementById('terminal-input');
                const partial = input.value;
                const completion = getTabCompletion(partial);
                if (completion) {
                    input.value = completion;
                }
            }
        }

        // Execute terminal command
        function executeCommand(command) {
            const parts = command.split(' ');
            const cmd = parts[0];
            const args = parts.slice(1);

            switch (cmd) {
                case 'help':
                    showHelp();
                    break;
                case 'clear':
                    clearTerminalOutput();
                    break;
                case 'ls':
                    listDirectory(args);
                    break;
                case 'pwd':
                    addTerminalLine(currentDirectory, 'output');
                    break;
                case 'cd':
                    changeDirectory(args[0] || terminalEnvironment.HOME);
                    break;
                case 'cat':
                    catFile(args[0]);
                    break;
                case 'mkdir':
                    makeDirectory(args[0]);
                    break;
                case 'rm':
                    removeFile(args);
                    break;
                case 'cp':
                    copyFile(args[0], args[1]);
                    break;
                case 'mv':
                    moveFile(args[0], args[1]);
                    break;
                case 'echo':
                    addTerminalLine(args.join(' '), 'output');
                    break;
                case 'date':
                    addTerminalLine(new Date().toString(), 'output');
                    break;
                case 'whoami':
                    addTerminalLine(terminalEnvironment.USER, 'output');
                    break;
                case 'uname':
                    if (args.includes('-a')) {
                        addTerminalLine('Kronos 5.15.0-kronos #1 SMP x86_64 GNU/Linux', 'output');
                    } else {
                        addTerminalLine('Kronos', 'output');
                    }
                    break;
                case 'ps':
                    showProcesses();
                    break;
                case 'top':
                    showTop();
                    break;
                case 'df':
                    showDiskUsage();
                    break;
                case 'free':
                    showMemoryUsage();
                    break;
                case 'uptime':
                    showUptime();
                    break;
                case 'env':
                    showEnvironment();
                    break;
                case 'history':
                    showHistory();
                    break;
                case 'which':
                    whichCommand(args[0]);
                    break;
                case 'file':
                    fileCommand(args[0]);
                    break;
                case 'find':
                    findCommand(args);
                    break;
                case 'grep':
                    grepCommand(args);
                    break;
                case 'wc':
                    wcCommand(args[0]);
                    break;
                case 'head':
                    headCommand(args[0], args[1]);
                    break;
                case 'tail':
                    tailCommand(args[0], args[1]);
                    break;
                case 'chmod':
                    chmodCommand(args[0], args[1]);
                    break;
                case 'touch':
                    touchCommand(args[0]);
                    break;
                case 'nano':
                case 'vim':
                case 'emacs':
                    addTerminalLine(`${cmd}: text editor not available in demo mode`, 'error');
                    addTerminalLine('Use the Text Editor application from the desktop instead', 'info');
                    break;
                case 'reboot':
                    addTerminalLine('System reboot initiated...', 'info');
                    setTimeout(() => {
                        addTerminalLine('Reboot cancelled - demo mode', 'error');
                    }, 2000);
                    break;
                case 'shutdown':
                    addTerminalLine('System shutdown initiated...', 'info');
                    setTimeout(() => {
                        addTerminalLine('Shutdown cancelled - demo mode', 'error');
                    }, 2000);
                    break;
                case 'sudo':
                    if (args.length > 0) {
                        addTerminalLine('[sudo] password for user: ', 'info');
                        addTerminalLine('sudo: command execution simulated in demo mode', 'info');
                        executeCommand(args.join(' '));
                    } else {
                        addTerminalLine('usage: sudo <command>', 'error');
                    }
                    break;
                case '':
                    // Empty command, just show new prompt
                    break;
                default:
                    addTerminalLine(`ksh: ${cmd}: command not found`, 'error');
                    addTerminalLine(`Type 'help' for available commands`, 'info');
            }

            // Add new prompt
            addTerminalLine(`user@kronos-desktop:${getCurrentDirectoryDisplay()}$ `, 'prompt', true);
        }

        // Terminal command implementations
        function showHelp() {
            const helpText = `
Kronos OS Terminal - Available Commands:

File Operations:
  ls [path]          - List directory contents
  cd [path]          - Change directory
  pwd                - Print working directory
  cat <file>         - Display file contents
  mkdir <dir>        - Create directory
  rm <file>          - Remove file
  cp <src> <dest>    - Copy file
  mv <src> <dest>    - Move/rename file
  touch <file>       - Create empty file
  find <path> <name> - Find files
  file <file>        - Show file type
  chmod <mode> <file>- Change file permissions

Text Processing:
  echo <text>        - Display text
  grep <pattern>     - Search text patterns
  wc <file>          - Word count
  head <file>        - Show first lines
  tail <file>        - Show last lines

System Information:
  ps                 - Show running processes
  top                - Show system processes
  df                 - Show disk usage
  free               - Show memory usage
  uptime             - Show system uptime
  uname [-a]         - Show system information
  whoami             - Show current user
  env                - Show environment variables
  date               - Show current date/time

Utilities:
  history            - Show command history
  which <cmd>        - Show command location
  clear              - Clear terminal
  help               - Show this help

Navigation:
  Use ↑/↓ arrows for command history
  Use Tab for command completion
  Use Ctrl+C to cancel (simulated)
            `;
            addTerminalLine(helpText, 'output');
        }

        function listDirectory(args) {
            const path = args[0] || currentDirectory;
            const resolvedPath = resolvePath(path);
            const dir = getFileSystemNode(resolvedPath);

            if (!dir) {
                addTerminalLine(`ls: cannot access '${path}': No such file or directory`, 'error');
                return;
            }

            if (dir.type !== 'directory') {
                addTerminalLine(`ls: ${path}: Not a directory`, 'error');
                return;
            }

            const contents = Object.keys(dir.contents || {});
            if (contents.length === 0) {
                addTerminalLine('', 'output');
                return;
            }

            // Format output in columns
            let output = '';
            contents.forEach((name, index) => {
                const item = dir.contents[name];
                const color = item.type === 'directory' ? 'color: #4A90E2;' :
                             item.type === 'executable' ? 'color: #28A745;' : 'color: #ffffff;';
                output += `<span style="${color}">${name}</span>`;
                if ((index + 1) % 4 === 0) output += '<br>';
                else output += '&nbsp;&nbsp;&nbsp;&nbsp;';
            });

            addTerminalLine(output, 'output', false, true);
        }

        function changeDirectory(path) {
            if (!path) path = terminalEnvironment.HOME;

            const resolvedPath = resolvePath(path);
            const dir = getFileSystemNode(resolvedPath);

            if (!dir) {
                addTerminalLine(`cd: ${path}: No such file or directory`, 'error');
                return;
            }

            if (dir.type !== 'directory') {
                addTerminalLine(`cd: ${path}: Not a directory`, 'error');
                return;
            }

            currentDirectory = resolvedPath;
            terminalEnvironment.PWD = currentDirectory;
        }

        function catFile(filename) {
            if (!filename) {
                addTerminalLine('cat: missing file operand', 'error');
                return;
            }

            const path = resolvePath(filename);
            const file = getFileSystemNode(path);

            if (!file) {
                addTerminalLine(`cat: ${filename}: No such file or directory`, 'error');
                return;
            }

            if (file.type === 'directory') {
                addTerminalLine(`cat: ${filename}: Is a directory`, 'error');
                return;
            }

            if (file.type !== 'file') {
                addTerminalLine(`cat: ${filename}: Permission denied`, 'error');
                return;
            }

            addTerminalLine(file.content || '', 'output');
        }

        function makeDirectory(dirname) {
            if (!dirname) {
                addTerminalLine('mkdir: missing operand', 'error');
                return;
            }

            const path = resolvePath(dirname);
            const parentPath = path.substring(0, path.lastIndexOf('/')) || '/';
            const dirName = path.substring(path.lastIndexOf('/') + 1);

            const parent = getFileSystemNode(parentPath);
            if (!parent || parent.type !== 'directory') {
                addTerminalLine(`mkdir: cannot create directory '${dirname}': No such file or directory`, 'error');
                return;
            }

            if (parent.contents[dirName]) {
                addTerminalLine(`mkdir: cannot create directory '${dirname}': File exists`, 'error');
                return;
            }

            parent.contents[dirName] = { type: 'directory', contents: {} };
            addTerminalLine('', 'output');
        }

        function showProcesses() {
            const processes = [
                'PID  TTY          TIME CMD',
                '1    ?        00:00:01 systemd',
                '2    ?        00:00:00 kthreadd',
                '3    ?        00:00:00 rcu_gp',
                '4    ?        00:00:00 rcu_par_gp',
                '123  pts/0    00:00:00 ksh',
                '456  ?        00:00:02 kronos-desktop',
                '789  ?        00:00:01 system-monitor',
                '1001 pts/0    00:00:00 ps'
            ];

            processes.forEach(line => addTerminalLine(line, 'output'));
        }

        function showTop() {
            const topOutput = `
top - ${new Date().toLocaleTimeString()} up 2 days, 14:32,  1 user,  load average: 0.85, 0.72, 0.68
Tasks: 187 total,   1 running, 186 sleeping,   0 stopped,   0 zombie
%Cpu(s): 15.2 us,  2.1 sy,  0.0 ni, 82.1 id,  0.6 wa,  0.0 hi,  0.0 si,  0.0 st
MiB Mem :   8192.0 total,   5734.2 free,   2145.6 used,    312.2 buff/cache
MiB Swap:   2048.0 total,   2048.0 free,      0.0 used.   5734.2 avail Mem

  PID USER      PR  NI    VIRT    RES    SHR S  %CPU  %MEM     TIME+ COMMAND
    1 root      20   0  169364  13616   8844 S   0.0   0.2   0:01.23 systemd
  123 user      20   0   21532   5184   3312 S   0.0   0.1   0:00.05 ksh
  456 user      20   0  234567  45123  12345 S   2.1   0.5   0:02.34 kronos-desktop
            `;
            addTerminalLine(topOutput, 'output');
        }

        function showDiskUsage() {
            const dfOutput = `
Filesystem     1K-blocks    Used Available Use% Mounted on
/dev/nvme0n1p1    262144  131072    131072  50% /
/dev/sda1        1048576  262144    786432  25% /home
tmpfs               4096       0      4096   0% /dev/shm
            `;
            addTerminalLine(dfOutput, 'output');
        }

        function showMemoryUsage() {
            const freeOutput = `
               total        used        free      shared  buff/cache   available
Mem:         8388608     2097152     5734400           0      557056     5734400
Swap:        2097152           0     2097152
            `;
            addTerminalLine(freeOutput, 'output');
        }

        function showUptime() {
            addTerminalLine('14:32:18 up 2 days, 14:32, 1 user, load average: 0.85, 0.72, 0.68', 'output');
        }

        function showEnvironment() {
            Object.keys(terminalEnvironment).forEach(key => {
                addTerminalLine(`${key}=${terminalEnvironment[key]}`, 'output');
            });
        }

        function showHistory() {
            terminalHistory.forEach((cmd, index) => {
                addTerminalLine(`${index + 1}  ${cmd}`, 'output');
            });
        }

        // Utility functions
        function addTerminalLine(text, type = 'output', isPrompt = false, isHtml = false) {
            const content = document.getElementById('terminal-content');
            const line = document.createElement('div');
            line.className = 'terminal-line';

            if (isPrompt) {
                line.innerHTML = `<span class="terminal-prompt">${text}</span>`;
                line.style.display = 'inline';
            } else {
                const colors = {
                    'output': '#ffffff',
                    'error': '#ff6b6b',
                    'info': '#4ecdc4',
                    'command': '#ffd93d',
                    'prompt': '#00ff00'
                };

                line.style.color = colors[type] || '#ffffff';
                line.style.marginBottom = '2px';

                if (isHtml) {
                    line.innerHTML = text;
                } else {
                    line.textContent = text;
                }
            }

            content.appendChild(line);
        }

        function getCurrentDirectoryDisplay() {
            return currentDirectory.replace(terminalEnvironment.HOME, '~');
        }

        function resolvePath(path) {
            if (!path) return currentDirectory;

            if (path.startsWith('/')) {
                return path;
            } else if (path.startsWith('~')) {
                return path.replace('~', terminalEnvironment.HOME);
            } else {
                return currentDirectory === '/' ? '/' + path : currentDirectory + '/' + path;
            }
        }

        function getFileSystemNode(path) {
            const parts = path.split('/').filter(p => p);
            let current = fileSystem['/'];

            for (const part of parts) {
                if (!current.contents || !current.contents[part]) {
                    return null;
                }
                current = current.contents[part];
            }

            return current;
        }

        function getTabCompletion(partial) {
            const parts = partial.split(' ');
            const lastPart = parts[parts.length - 1];

            if (parts.length === 1) {
                // Command completion
                const commands = ['help', 'clear', 'ls', 'cd', 'pwd', 'cat', 'mkdir', 'rm', 'cp', 'mv', 'echo', 'date', 'whoami', 'uname', 'ps', 'top', 'df', 'free', 'uptime', 'env', 'history'];
                const matches = commands.filter(cmd => cmd.startsWith(lastPart));
                return matches.length === 1 ? matches[0] : null;
            } else {
                // File completion
                const dir = getFileSystemNode(currentDirectory);
                if (dir && dir.contents) {
                    const matches = Object.keys(dir.contents).filter(name => name.startsWith(lastPart));
                    if (matches.length === 1) {
                        return parts.slice(0, -1).join(' ') + ' ' + matches[0];
                    }
                }
            }

            return null;
        }

        function clearTerminal() {
            clearTerminalOutput();
        }

        function clearTerminalOutput() {
            const content = document.getElementById('terminal-content');
            content.innerHTML = '<div class="terminal-line"><span class="terminal-prompt">user@kronos-desktop:~$ </span></div>';
        }

        function copyTerminalOutput() {
            const content = document.getElementById('terminal-output');
            const text = content.innerText;
            navigator.clipboard.writeText(text).then(() => {
                document.getElementById('terminal-status').textContent = 'Copied to clipboard';
                setTimeout(() => {
                    document.getElementById('terminal-status').textContent = 'Ready';
                }, 2000);
            });
        }

        function pasteToTerminal() {
            navigator.clipboard.readText().then(text => {
                const input = document.getElementById('terminal-input');
                input.value += text;
                input.focus();
            });
        }

        function scrollTerminalToBottom() {
            const output = document.getElementById('terminal-output');
            output.scrollTop = output.scrollHeight;
        }

        // Focus terminal input when terminal window is opened
        function focusTerminalInput() {
            if (openWindows.has('terminal-window')) {
                const input = document.getElementById('terminal-input');
                if (input) {
                    input.focus();
                }
            }
        }

        // Terminal auto-focus functionality is now integrated into main openApp function

        // System Monitor Application Functions
        let currentMonitorCategory = 'overview';
        let monitorAutoRefresh = true;
        let monitorRefreshInterval;
        let selectedProcess = null;

        // Simulated system data for monitor
        let monitorData = {
            cpu: {
                usage: 15.2,
                temperature: 45.2,
                cores: [12.1, 18.3, 14.7, 16.9],
                frequency: 2.4
            },
            memory: {
                total: 8589934592, // 8GB
                used: 2234567890,  // ~2.1GB
                available: 6355366702,
                percentage: 26
            },
            disk: {
                total: 274877906944, // 256GB
                used: 137438953472,  // 128GB
                percentage: 50
            },
            network: {
                bytesIn: 1234567890,
                bytesOut: 987654321,
                packetsIn: 1234567,
                packetsOut: 987654,
                speed: 1.2 // MB/s
            },
            processes: [
                { pid: 1234, name: 'kronos-desktop', cpu: 8.2, memory: 156.7, user: 'user', status: 'Running' },
                { pid: 5678, name: 'system-monitor', cpu: 3.1, memory: 89.3, user: 'user', status: 'Running' },
                { pid: 9012, name: 'terminal', cpu: 1.8, memory: 45.2, user: 'user', status: 'Running' },
                { pid: 3456, name: 'file-manager', cpu: 1.2, memory: 67.8, user: 'user', status: 'Running' },
                { pid: 7890, name: 'systemd', cpu: 0.5, memory: 23.4, user: 'root', status: 'Running' },
                { pid: 2468, name: 'network-manager', cpu: 0.3, memory: 34.5, user: 'root', status: 'Running' },
                { pid: 1357, name: 'audio-service', cpu: 0.2, memory: 12.3, user: 'user', status: 'Running' },
                { pid: 8642, name: 'update-daemon', cpu: 0.1, memory: 8.9, user: 'root', status: 'Sleeping' }
            ],
            uptime: 214392, // seconds
            loadAverage: [0.85, 0.72, 0.68]
        };

        // Initialize system monitor
        function initializeSystemMonitor() {
            if (openWindows.has('monitor-window')) {
                startMonitorAutoRefresh();
                updateMonitorData();
                showNotification('System Monitor initialized', 'info');
            }
        }

        // Select monitor category
        function selectMonitorCategory(category) {
            currentMonitorCategory = category;

            // Update sidebar selection
            document.querySelectorAll('.monitor-category').forEach(cat => {
                cat.classList.remove('active');
            });
            document.querySelector(`[data-category="${category}"]`).classList.add('active');

            // Load category content
            loadMonitorCategory(category);
        }

        // Load monitor category content
        function loadMonitorCategory(category) {
            const content = document.getElementById('monitor-content');

            switch (category) {
                case 'overview':
                    loadMonitorOverview(content);
                    break;
                case 'processes':
                    loadMonitorProcesses(content);
                    break;
                case 'performance':
                    loadMonitorPerformance(content);
                    break;
                case 'network':
                    loadMonitorNetwork(content);
                    break;
                case 'storage':
                    loadMonitorStorage(content);
                    break;
            }
        }

        // Load processes view
        function loadMonitorProcesses(content) {
            content.innerHTML = `
                <h3 style="margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                    <span>⚙️</span>
                    <span>Running Processes</span>
                </h3>

                <div style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 15px; margin-bottom: 20px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <div>
                            <strong>Total Processes: </strong><span id="total-processes">${monitorData.processes.length}</span>
                            <span style="margin-left: 20px;"><strong>Running: </strong><span id="running-processes">${monitorData.processes.filter(p => p.status === 'Running').length}</span></span>
                            <span style="margin-left: 20px;"><strong>Sleeping: </strong><span id="sleeping-processes">${monitorData.processes.filter(p => p.status === 'Sleeping').length}</span></span>
                        </div>
                        <div>
                            <input type="text" placeholder="Search processes..." style="padding: 6px; border: 1px solid #ccc; border-radius: 4px;" onkeyup="filterProcesses(this.value)">
                        </div>
                    </div>
                </div>

                <div style="background: white; border: 1px solid #e9ecef; border-radius: 8px; overflow: hidden;">
                    <table style="width: 100%; border-collapse: collapse;" id="processes-table">
                        <thead style="background: #f8f9fa;">
                            <tr>
                                <th style="padding: 12px; text-align: left; border-bottom: 1px solid #dee2e6; cursor: pointer;" onclick="sortProcesses('pid')">PID</th>
                                <th style="padding: 12px; text-align: left; border-bottom: 1px solid #dee2e6; cursor: pointer;" onclick="sortProcesses('name')">Process Name</th>
                                <th style="padding: 12px; text-align: left; border-bottom: 1px solid #dee2e6; cursor: pointer;" onclick="sortProcesses('cpu')">CPU %</th>
                                <th style="padding: 12px; text-align: left; border-bottom: 1px solid #dee2e6; cursor: pointer;" onclick="sortProcesses('memory')">Memory (MB)</th>
                                <th style="padding: 12px; text-align: left; border-bottom: 1px solid #dee2e6; cursor: pointer;" onclick="sortProcesses('user')">User</th>
                                <th style="padding: 12px; text-align: left; border-bottom: 1px solid #dee2e6; cursor: pointer;" onclick="sortProcesses('status')">Status</th>
                                <th style="padding: 12px; text-align: left; border-bottom: 1px solid #dee2e6;">Action</th>
                            </tr>
                        </thead>
                        <tbody id="processes-tbody">
                            ${generateProcessRows()}
                        </tbody>
                    </table>
                </div>
            `;
        }

        // Generate process table rows
        function generateProcessRows() {
            return monitorData.processes.map(process => `
                <tr onclick="selectProcess(${process.pid})" style="cursor: pointer;" class="process-row" data-pid="${process.pid}">
                    <td style="padding: 10px; border-bottom: 1px solid #f1f3f4;">${process.pid}</td>
                    <td style="padding: 10px; border-bottom: 1px solid #f1f3f4; font-weight: 600;">${process.name}</td>
                    <td style="padding: 10px; border-bottom: 1px solid #f1f3f4;">
                        <span style="color: ${process.cpu > 5 ? '#dc3545' : process.cpu > 2 ? '#fd7e14' : '#28a745'};">
                            ${process.cpu}%
                        </span>
                    </td>
                    <td style="padding: 10px; border-bottom: 1px solid #f1f3f4;">${process.memory} MB</td>
                    <td style="padding: 10px; border-bottom: 1px solid #f1f3f4;">${process.user}</td>
                    <td style="padding: 10px; border-bottom: 1px solid #f1f3f4;">
                        <span style="color: ${process.status === 'Running' ? '#28a745' : '#6c757d'};">
                            ${process.status}
                        </span>
                    </td>
                    <td style="padding: 10px; border-bottom: 1px solid #f1f3f4;">
                        <button onclick="killProcess(${process.pid})" style="background: #dc3545; color: white; border: none; padding: 4px 8px; border-radius: 3px; cursor: pointer; font-size: 12px;">Kill</button>
                    </td>
                </tr>
            `).join('');
        }

        // Load performance view
        function loadMonitorPerformance(content) {
            content.innerHTML = `
                <h3 style="margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                    <span>⚡</span>
                    <span>Performance Monitoring</span>
                </h3>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 25px;">
                    <div style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px;">
                        <h4 style="margin-bottom: 15px; color: #333;">CPU Performance</h4>
                        <div style="margin-bottom: 15px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                <span>Overall Usage</span>
                                <span style="font-weight: 600;">${monitorData.cpu.usage}%</span>
                            </div>
                            <div style="width: 100%; height: 8px; background: #e9ecef; border-radius: 4px;">
                                <div style="height: 100%; background: linear-gradient(90deg, #28a745, #20c997); width: ${monitorData.cpu.usage}%; border-radius: 4px; transition: width 0.5s ease;"></div>
                            </div>
                        </div>

                        <div style="margin-bottom: 15px;">
                            <div style="font-weight: 600; margin-bottom: 8px;">Per-Core Usage:</div>
                            ${monitorData.cpu.cores.map((usage, index) => `
                                <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                    <span>Core ${index + 1}</span>
                                    <span>${usage}%</span>
                                </div>
                                <div style="width: 100%; height: 4px; background: #e9ecef; border-radius: 2px; margin-bottom: 8px;">
                                    <div style="height: 100%; background: #007bff; width: ${usage}%; border-radius: 2px; transition: width 0.5s ease;"></div>
                                </div>
                            `).join('')}
                        </div>

                        <div style="display: flex; justify-content: space-between;">
                            <span>Temperature:</span>
                            <span style="font-weight: 600; color: #dc3545;">${monitorData.cpu.temperature}°C</span>
                        </div>
                    </div>

                    <div style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px;">
                        <h4 style="margin-bottom: 15px; color: #333;">Memory Performance</h4>
                        <div style="margin-bottom: 15px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                <span>Used Memory</span>
                                <span style="font-weight: 600;">${(monitorData.memory.used / (1024**3)).toFixed(1)} GB / ${(monitorData.memory.total / (1024**3)).toFixed(1)} GB</span>
                            </div>
                            <div style="width: 100%; height: 8px; background: #e9ecef; border-radius: 4px;">
                                <div style="height: 100%; background: linear-gradient(90deg, #007bff, #6610f2); width: ${monitorData.memory.percentage}%; border-radius: 4px; transition: width 0.5s ease;"></div>
                            </div>
                        </div>

                        <div style="margin-bottom: 10px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                <span>Available:</span>
                                <span>${(monitorData.memory.available / (1024**3)).toFixed(1)} GB</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                <span>Usage:</span>
                                <span>${monitorData.memory.percentage}%</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px;">
                    <h4 style="margin-bottom: 15px; color: #333;">System Load</h4>
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;">
                        <div style="text-align: center;">
                            <div style="font-size: 24px; font-weight: bold; color: #fd7e14; margin-bottom: 5px;">${monitorData.loadAverage[0]}</div>
                            <div style="color: #666; font-size: 12px;">1 Minute</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 24px; font-weight: bold; color: #fd7e14; margin-bottom: 5px;">${monitorData.loadAverage[1]}</div>
                            <div style="color: #666; font-size: 12px;">5 Minutes</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 24px; font-weight: bold; color: #fd7e14; margin-bottom: 5px;">${monitorData.loadAverage[2]}</div>
                            <div style="color: #666; font-size: 12px;">15 Minutes</div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Load network view
        function loadMonitorNetwork(content) {
            content.innerHTML = `
                <h3 style="margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                    <span>🌐</span>
                    <span>Network Monitoring</span>
                </h3>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 25px;">
                    <div style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px; text-align: center;">
                        <div style="font-size: 24px; font-weight: bold; color: #28a745; margin-bottom: 5px;">${(monitorData.network.bytesIn / (1024**2)).toFixed(1)} MB</div>
                        <div style="color: #666; font-size: 12px; text-transform: uppercase;">Bytes Received</div>
                    </div>
                    <div style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px; text-align: center;">
                        <div style="font-size: 24px; font-weight: bold; color: #dc3545; margin-bottom: 5px;">${(monitorData.network.bytesOut / (1024**2)).toFixed(1)} MB</div>
                        <div style="color: #666; font-size: 12px; text-transform: uppercase;">Bytes Sent</div>
                    </div>
                    <div style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px; text-align: center;">
                        <div style="font-size: 24px; font-weight: bold; color: #007bff; margin-bottom: 5px;">${monitorData.network.speed} MB/s</div>
                        <div style="color: #666; font-size: 12px; text-transform: uppercase;">Current Speed</div>
                    </div>
                </div>

                <div style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px;">
                    <h4 style="margin-bottom: 15px; color: #333;">Network Interfaces</h4>
                    <div style="background: white; border: 1px solid #e9ecef; border-radius: 6px; overflow: hidden;">
                        <table style="width: 100%; border-collapse: collapse;">
                            <thead style="background: #f8f9fa;">
                                <tr>
                                    <th style="padding: 12px; text-align: left; border-bottom: 1px solid #dee2e6;">Interface</th>
                                    <th style="padding: 12px; text-align: left; border-bottom: 1px solid #dee2e6;">Status</th>
                                    <th style="padding: 12px; text-align: left; border-bottom: 1px solid #dee2e6;">IP Address</th>
                                    <th style="padding: 12px; text-align: left; border-bottom: 1px solid #dee2e6;">Speed</th>
                                    <th style="padding: 12px; text-align: left; border-bottom: 1px solid #dee2e6;">Packets In/Out</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td style="padding: 10px; border-bottom: 1px solid #f1f3f4; font-weight: 600;">eth0</td>
                                    <td style="padding: 10px; border-bottom: 1px solid #f1f3f4;"><span style="color: #28a745;">Connected</span></td>
                                    <td style="padding: 10px; border-bottom: 1px solid #f1f3f4;">192.168.1.100</td>
                                    <td style="padding: 10px; border-bottom: 1px solid #f1f3f4;">1 Gbps</td>
                                    <td style="padding: 10px; border-bottom: 1px solid #f1f3f4;">${monitorData.network.packetsIn.toLocaleString()} / ${monitorData.network.packetsOut.toLocaleString()}</td>
                                </tr>
                                <tr>
                                    <td style="padding: 10px; border-bottom: 1px solid #f1f3f4; font-weight: 600;">wlan0</td>
                                    <td style="padding: 10px; border-bottom: 1px solid #f1f3f4;"><span style="color: #dc3545;">Disconnected</span></td>
                                    <td style="padding: 10px; border-bottom: 1px solid #f1f3f4;">-</td>
                                    <td style="padding: 10px; border-bottom: 1px solid #f1f3f4;">300 Mbps</td>
                                    <td style="padding: 10px; border-bottom: 1px solid #f1f3f4;">0 / 0</td>
                                </tr>
                                <tr>
                                    <td style="padding: 10px; font-weight: 600;">lo</td>
                                    <td style="padding: 10px;"><span style="color: #28a745;">Active</span></td>
                                    <td style="padding: 10px;">127.0.0.1</td>
                                    <td style="padding: 10px;">-</td>
                                    <td style="padding: 10px;">1,234 / 1,234</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        // Load storage view
        function loadMonitorStorage(content) {
            content.innerHTML = `
                <h3 style="margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                    <span>💿</span>
                    <span>Storage Monitoring</span>
                </h3>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 25px;">
                    <div style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px; text-align: center;">
                        <div style="font-size: 24px; font-weight: bold; color: #fd7e14; margin-bottom: 5px;">${(monitorData.disk.total / (1024**3)).toFixed(0)} GB</div>
                        <div style="color: #666; font-size: 12px; text-transform: uppercase;">Total Capacity</div>
                    </div>
                    <div style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px; text-align: center;">
                        <div style="font-size: 24px; font-weight: bold; color: #dc3545; margin-bottom: 5px;">${(monitorData.disk.used / (1024**3)).toFixed(0)} GB</div>
                        <div style="color: #666; font-size: 12px; text-transform: uppercase;">Used Space</div>
                    </div>
                    <div style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px; text-align: center;">
                        <div style="font-size: 24px; font-weight: bold; color: #28a745; margin-bottom: 5px;">${((monitorData.disk.total - monitorData.disk.used) / (1024**3)).toFixed(0)} GB</div>
                        <div style="color: #666; font-size: 12px; text-transform: uppercase;">Free Space</div>
                    </div>
                </div>

                <div style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px; margin-bottom: 20px;">
                    <h4 style="margin-bottom: 15px; color: #333;">Disk Usage</h4>
                    <div style="margin-bottom: 10px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                            <span>Primary SSD (/)</span>
                            <span style="font-weight: 600;">${monitorData.disk.percentage}%</span>
                        </div>
                        <div style="width: 100%; height: 12px; background: #e9ecef; border-radius: 6px;">
                            <div style="height: 100%; background: linear-gradient(90deg, #fd7e14, #e83e8c); width: ${monitorData.disk.percentage}%; border-radius: 6px; transition: width 0.5s ease;"></div>
                        </div>
                    </div>
                </div>

                <div style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px;">
                    <h4 style="margin-bottom: 15px; color: #333;">Storage Devices</h4>
                    <div style="background: white; border: 1px solid #e9ecef; border-radius: 6px; overflow: hidden;">
                        <table style="width: 100%; border-collapse: collapse;">
                            <thead style="background: #f8f9fa;">
                                <tr>
                                    <th style="padding: 12px; text-align: left; border-bottom: 1px solid #dee2e6;">Device</th>
                                    <th style="padding: 12px; text-align: left; border-bottom: 1px solid #dee2e6;">Type</th>
                                    <th style="padding: 12px; text-align: left; border-bottom: 1px solid #dee2e6;">Size</th>
                                    <th style="padding: 12px; text-align: left; border-bottom: 1px solid #dee2e6;">Mount Point</th>
                                    <th style="padding: 12px; text-align: left; border-bottom: 1px solid #dee2e6;">Usage</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td style="padding: 10px; border-bottom: 1px solid #f1f3f4; font-weight: 600;">/dev/nvme0n1p1</td>
                                    <td style="padding: 10px; border-bottom: 1px solid #f1f3f4;">NVMe SSD</td>
                                    <td style="padding: 10px; border-bottom: 1px solid #f1f3f4;">256 GB</td>
                                    <td style="padding: 10px; border-bottom: 1px solid #f1f3f4;">/</td>
                                    <td style="padding: 10px; border-bottom: 1px solid #f1f3f4;">50%</td>
                                </tr>
                                <tr>
                                    <td style="padding: 10px; border-bottom: 1px solid #f1f3f4; font-weight: 600;">/dev/sda1</td>
                                    <td style="padding: 10px; border-bottom: 1px solid #f1f3f4;">SATA HDD</td>
                                    <td style="padding: 10px; border-bottom: 1px solid #f1f3f4;">1 TB</td>
                                    <td style="padding: 10px; border-bottom: 1px solid #f1f3f4;">/home</td>
                                    <td style="padding: 10px; border-bottom: 1px solid #f1f3f4;">25%</td>
                                </tr>
                                <tr>
                                    <td style="padding: 10px; font-weight: 600;">/dev/sdb1</td>
                                    <td style="padding: 10px;">USB Drive</td>
                                    <td style="padding: 10px;">32 GB</td>
                                    <td style="padding: 10px;">/media/usb</td>
                                    <td style="padding: 10px;">12%</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        // Load overview (default)
        function loadMonitorOverview(content) {
            content.innerHTML = `
                <h3 style="margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                    <span>📊</span>
                    <span>System Overview</span>
                </h3>

                <!-- Real-time Performance Cards -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 25px;">
                    <div style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 15px; text-align: center;">
                        <div style="font-size: 24px; font-weight: bold; color: #28a745; margin-bottom: 5px;" id="monitor-cpu-usage">${monitorData.cpu.usage.toFixed(1)}%</div>
                        <div style="color: #666; font-size: 12px; text-transform: uppercase;">CPU Usage</div>
                        <div style="width: 100%; height: 4px; background: #e9ecef; border-radius: 2px; margin-top: 8px;">
                            <div id="monitor-cpu-bar" style="height: 100%; background: #28a745; width: ${monitorData.cpu.usage}%; border-radius: 2px; transition: width 0.5s ease;"></div>
                        </div>
                    </div>
                    <div style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 15px; text-align: center;">
                        <div style="font-size: 24px; font-weight: bold; color: #007bff; margin-bottom: 5px;" id="monitor-memory-usage">${monitorData.memory.percentage.toFixed(0)}%</div>
                        <div style="color: #666; font-size: 12px; text-transform: uppercase;">Memory Usage</div>
                        <div style="width: 100%; height: 4px; background: #e9ecef; border-radius: 2px; margin-top: 8px;">
                            <div id="monitor-memory-bar" style="height: 100%; background: #007bff; width: ${monitorData.memory.percentage}%; border-radius: 2px; transition: width 0.5s ease;"></div>
                        </div>
                    </div>
                    <div style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 15px; text-align: center;">
                        <div style="font-size: 24px; font-weight: bold; color: #fd7e14; margin-bottom: 5px;" id="monitor-disk-usage">${monitorData.disk.percentage}%</div>
                        <div style="color: #666; font-size: 12px; text-transform: uppercase;">Disk Usage</div>
                        <div style="width: 100%; height: 4px; background: #e9ecef; border-radius: 2px; margin-top: 8px;">
                            <div id="monitor-disk-bar" style="height: 100%; background: #fd7e14; width: ${monitorData.disk.percentage}%; border-radius: 2px; transition: width 0.5s ease;"></div>
                        </div>
                    </div>
                    <div style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 15px; text-align: center;">
                        <div style="font-size: 24px; font-weight: bold; color: #6f42c1; margin-bottom: 5px;" id="monitor-network-usage">${monitorData.network.speed.toFixed(1)} MB/s</div>
                        <div style="color: #666; font-size: 12px; text-transform: uppercase;">Network I/O</div>
                        <div style="width: 100%; height: 4px; background: #e9ecef; border-radius: 2px; margin-top: 8px;">
                            <div id="monitor-network-bar" style="height: 100%; background: #6f42c1; width: ${Math.min(100, monitorData.network.speed * 20)}%; border-radius: 2px; transition: width 0.5s ease;"></div>
                        </div>
                    </div>
                </div>

                <!-- System Information Grid -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px;">
                        <h4 style="margin-bottom: 15px; color: #333;">System Information</h4>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                            <span style="color: #666;">Uptime:</span>
                            <span style="font-weight: 600;" id="monitor-uptime">${formatUptime(monitorData.uptime)}</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                            <span style="color: #666;">Processes:</span>
                            <span style="font-weight: 600;" id="monitor-processes">${monitorData.processes.length}</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                            <span style="color: #666;">Load Average:</span>
                            <span style="font-weight: 600;" id="monitor-load">${monitorData.loadAverage.map(l => l.toFixed(2)).join(', ')}</span>
                        </div>
                        <div style="display: flex; justify-content: space-between;">
                            <span style="color: #666;">CPU Temperature:</span>
                            <span style="font-weight: 600; color: #dc3545;" id="monitor-cpu-temp">${monitorData.cpu.temperature.toFixed(1)}°C</span>
                        </div>
                    </div>

                    <div style="background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px;">
                        <h4 style="margin-bottom: 15px; color: #333;">Top Processes</h4>
                        <div id="monitor-top-processes">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 6px; font-size: 12px; color: #666;">
                                <span>Process</span>
                                <span>CPU%</span>
                            </div>
                            ${monitorData.processes.sort((a, b) => b.cpu - a.cpu).slice(0, 5).map(process => `
                                <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                    <span style="font-size: 14px;">${process.name}</span>
                                    <span style="font-weight: 600; color: #28a745;">${process.cpu.toFixed(1)}%</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;
        }

        // Update monitor data
        function updateMonitorData() {
            // Simulate real-time data changes
            monitorData.cpu.usage = 10 + Math.random() * 30;
            monitorData.cpu.temperature = 40 + Math.random() * 20;
            monitorData.cpu.cores = monitorData.cpu.cores.map(() => 5 + Math.random() * 25);
            monitorData.memory.used = monitorData.memory.total * (0.2 + Math.random() * 0.3);
            monitorData.memory.percentage = (monitorData.memory.used / monitorData.memory.total) * 100;
            monitorData.memory.available = monitorData.memory.total - monitorData.memory.used;
            monitorData.network.speed = 0.5 + Math.random() * 2;
            monitorData.uptime += 1;
            monitorData.loadAverage = monitorData.loadAverage.map(() => 0.3 + Math.random() * 1.2);

            // Update processes CPU usage
            monitorData.processes.forEach(process => {
                process.cpu = Math.max(0.1, process.cpu + (Math.random() - 0.5) * 2);
            });

            // Update current view
            if (currentMonitorCategory === 'overview') {
                updateMonitorOverview();
            } else {
                loadMonitorCategory(currentMonitorCategory);
            }
        }

        // Update overview real-time elements
        function updateMonitorOverview() {
            // Update performance cards
            const cpuUsage = document.getElementById('monitor-cpu-usage');
            const cpuBar = document.getElementById('monitor-cpu-bar');
            if (cpuUsage && cpuBar) {
                cpuUsage.textContent = `${monitorData.cpu.usage.toFixed(1)}%`;
                cpuBar.style.width = `${monitorData.cpu.usage}%`;
            }

            const memoryUsage = document.getElementById('monitor-memory-usage');
            const memoryBar = document.getElementById('monitor-memory-bar');
            if (memoryUsage && memoryBar) {
                memoryUsage.textContent = `${monitorData.memory.percentage.toFixed(0)}%`;
                memoryBar.style.width = `${monitorData.memory.percentage}%`;
            }

            const diskUsage = document.getElementById('monitor-disk-usage');
            const diskBar = document.getElementById('monitor-disk-bar');
            if (diskUsage && diskBar) {
                diskUsage.textContent = `${monitorData.disk.percentage}%`;
                diskBar.style.width = `${monitorData.disk.percentage}%`;
            }

            const networkUsage = document.getElementById('monitor-network-usage');
            const networkBar = document.getElementById('monitor-network-bar');
            if (networkUsage && networkBar) {
                networkUsage.textContent = `${monitorData.network.speed.toFixed(1)} MB/s`;
                networkBar.style.width = `${Math.min(100, monitorData.network.speed * 20)}%`;
            }

            // Update system info
            const uptime = document.getElementById('monitor-uptime');
            const processes = document.getElementById('monitor-processes');
            const load = document.getElementById('monitor-load');
            const cpuTemp = document.getElementById('monitor-cpu-temp');

            if (uptime) uptime.textContent = formatUptime(monitorData.uptime);
            if (processes) processes.textContent = monitorData.processes.length;
            if (load) load.textContent = monitorData.loadAverage.map(l => l.toFixed(2)).join(', ');
            if (cpuTemp) cpuTemp.textContent = `${monitorData.cpu.temperature.toFixed(1)}°C`;

            // Update top processes
            const topProcesses = document.getElementById('monitor-top-processes');
            if (topProcesses) {
                const sortedProcesses = [...monitorData.processes].sort((a, b) => b.cpu - a.cpu).slice(0, 5);
                topProcesses.innerHTML = `
                    <div style="display: flex; justify-content: space-between; margin-bottom: 6px; font-size: 12px; color: #666;">
                        <span>Process</span>
                        <span>CPU%</span>
                    </div>
                    ${sortedProcesses.map(process => `
                        <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                            <span style="font-size: 14px;">${process.name}</span>
                            <span style="font-weight: 600; color: #28a745;">${process.cpu.toFixed(1)}%</span>
                        </div>
                    `).join('')}
                `;
            }
        }

        // Monitor control functions
        function refreshMonitorData() {
            updateMonitorData();
            showNotification('Monitor data refreshed!', 'info');
        }

        function toggleAutoRefreshMonitor() {
            monitorAutoRefresh = document.getElementById('autoRefreshMonitor').checked;
            if (monitorAutoRefresh) {
                startMonitorAutoRefresh();
                showNotification('Auto-refresh enabled', 'info');
            } else {
                stopMonitorAutoRefresh();
                showNotification('Auto-refresh disabled', 'info');
            }
        }

        function startMonitorAutoRefresh() {
            if (monitorRefreshInterval) clearInterval(monitorRefreshInterval);
            monitorRefreshInterval = setInterval(() => {
                if (openWindows.has('monitor-window') && monitorAutoRefresh) {
                    updateMonitorData();
                }
            }, 1000); // Update every second
        }

        function stopMonitorAutoRefresh() {
            if (monitorRefreshInterval) {
                clearInterval(monitorRefreshInterval);
                monitorRefreshInterval = null;
            }
        }

        // Process management functions
        function selectProcess(pid) {
            selectedProcess = pid;
            // Remove previous selection
            document.querySelectorAll('.process-row').forEach(row => {
                row.style.backgroundColor = '';
            });
            // Highlight selected row
            const row = document.querySelector(`[data-pid="${pid}"]`);
            if (row) {
                row.style.backgroundColor = '#e3f2fd';
            }
        }

        function killProcess(pid) {
            const process = monitorData.processes.find(p => p.pid === pid);
            if (process && confirm(`Are you sure you want to kill process "${process.name}" (PID: ${pid})?`)) {
                monitorData.processes = monitorData.processes.filter(p => p.pid !== pid);
                if (currentMonitorCategory === 'processes') {
                    loadMonitorProcesses(document.getElementById('monitor-content'));
                }
                showNotification(`Process ${process.name} (${pid}) terminated`, 'info');
            }
        }

        function killSelectedProcess() {
            if (selectedProcess) {
                killProcess(selectedProcess);
                selectedProcess = null;
            } else {
                showNotification('No process selected', 'warning');
            }
        }

        // Utility functions
        function formatUptime(seconds) {
            const days = Math.floor(seconds / 86400);
            const hours = Math.floor((seconds % 86400) / 3600);
            const minutes = Math.floor((seconds % 3600) / 60);
            const secs = seconds % 60;

            if (days > 0) {
                return `${days} days, ${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
            } else {
                return `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
            }
        }

        function filterProcesses(query) {
            const rows = document.querySelectorAll('.process-row');
            rows.forEach(row => {
                const processName = row.children[1].textContent.toLowerCase();
                if (processName.includes(query.toLowerCase())) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            });
        }

        function sortProcesses(column) {
            // Implementation for sorting processes table
            showNotification(`Sorting by ${column}`, 'info');
        }

        function changeMonitorView() {
            const view = document.getElementById('monitorView').value;
            selectMonitorCategory(view);
        }

        // Video Player Application Functions
        let currentVideoIndex = 0;
        let isPlaying = false;
        let isMuted = false;
        let isRepeat = false;
        let isPlaylistVisible = true;
        let playlist = [
            { name: 'Sample Video 1', duration: '02:30', url: '', type: 'demo' },
            { name: 'Sample Video 2', duration: '01:45', url: '', type: 'demo' },
            { name: 'Sample Video 3', duration: '03:15', url: '', type: 'demo' }
        ];

        // Initialize video player
        function initializeVideoPlayer() {
            if (openWindows.has('video-player-window')) {
                const video = document.getElementById('main-video');

                // Hide default controls
                video.controls = false;

                // Add event listeners
                video.addEventListener('loadedmetadata', updateDuration);
                video.addEventListener('timeupdate', updateProgress);
                video.addEventListener('ended', onVideoEnded);
                video.addEventListener('play', onVideoPlay);
                video.addEventListener('pause', onVideoPause);

                // Set initial volume
                video.volume = 0.5;

                updatePlaylistCount();
                showNotification('Video Player initialized', 'info');
            }
        }

        // Video control functions
        function togglePlayPause() {
            const video = document.getElementById('main-video');
            const playBtn = document.getElementById('play-pause-btn');

            if (video.paused) {
                video.play();
            } else {
                video.pause();
            }
        }

        function onVideoPlay() {
            isPlaying = true;
            document.getElementById('play-pause-btn').innerHTML = '⏸️';
            hideVideoOverlay();
        }

        function onVideoPause() {
            isPlaying = false;
            document.getElementById('play-pause-btn').innerHTML = '▶️';
        }

        function stopVideo() {
            const video = document.getElementById('main-video');
            video.pause();
            video.currentTime = 0;
            showVideoOverlay();
        }

        function previousVideo() {
            if (currentVideoIndex > 0) {
                currentVideoIndex--;
                loadVideo(currentVideoIndex);
            }
        }

        function nextVideo() {
            if (currentVideoIndex < playlist.length - 1) {
                currentVideoIndex++;
                loadVideo(currentVideoIndex);
            } else if (isRepeat) {
                currentVideoIndex = 0;
                loadVideo(currentVideoIndex);
            }
        }

        function onVideoEnded() {
            if (isRepeat) {
                const video = document.getElementById('main-video');
                video.currentTime = 0;
                video.play();
            } else {
                nextVideo();
            }
        }

        // Volume and audio controls
        function setVolume(value) {
            const video = document.getElementById('main-video');
            video.volume = value / 100;

            if (value == 0) {
                document.getElementById('mute-btn').innerHTML = '🔇';
            } else {
                document.getElementById('mute-btn').innerHTML = '🔊';
                isMuted = false;
            }
        }

        function toggleMute() {
            const video = document.getElementById('main-video');
            const muteBtn = document.getElementById('mute-btn');
            const volumeSlider = document.getElementById('volume-slider');

            if (isMuted) {
                video.muted = false;
                muteBtn.innerHTML = '🔊';
                isMuted = false;
            } else {
                video.muted = true;
                muteBtn.innerHTML = '🔇';
                isMuted = true;
            }
        }

        // Progress and seeking
        function updateProgress() {
            const video = document.getElementById('main-video');
            const progressBar = document.getElementById('progress-bar');
            const currentTimeSpan = document.getElementById('current-time');

            if (video.duration) {
                const progress = (video.currentTime / video.duration) * 100;
                progressBar.style.width = progress + '%';
                currentTimeSpan.textContent = formatTime(video.currentTime);
            }
        }

        function updateDuration() {
            const video = document.getElementById('main-video');
            const durationSpan = document.getElementById('duration');

            if (video.duration) {
                durationSpan.textContent = formatTime(video.duration);
            }
        }

        function seekVideo(event) {
            const video = document.getElementById('main-video');
            const progressContainer = document.getElementById('progress-container');
            const rect = progressContainer.getBoundingClientRect();
            const clickX = event.clientX - rect.left;
            const width = rect.width;
            const percentage = clickX / width;

            if (video.duration) {
                video.currentTime = percentage * video.duration;
            }
        }

        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
        }

        // Fullscreen functionality
        function toggleFullscreen() {
            const videoArea = document.getElementById('video-display-area');

            if (!document.fullscreenElement) {
                videoArea.requestFullscreen().catch(err => {
                    showNotification('Fullscreen not supported', 'warning');
                });
            } else {
                document.exitFullscreen();
            }
        }

        // Playlist management
        function togglePlaylist() {
            const sidebar = document.getElementById('playlist-sidebar');
            isPlaylistVisible = !isPlaylistVisible;

            if (isPlaylistVisible) {
                sidebar.style.display = 'flex';
            } else {
                sidebar.style.display = 'none';
            }
        }

        function selectPlaylistItem(index) {
            currentVideoIndex = index;
            loadVideo(index);
            updatePlaylistSelection();
        }

        function loadVideo(index) {
            if (index >= 0 && index < playlist.length) {
                const video = document.getElementById('main-video');
                const item = playlist[index];

                if (item.type === 'demo') {
                    // For demo purposes, show overlay
                    showVideoOverlay();
                    showNotification(`Loading: ${item.name}`, 'info');
                } else {
                    video.src = item.url;
                    hideVideoOverlay();
                }

                updatePlaylistSelection();
            }
        }

        function updatePlaylistSelection() {
            const items = document.querySelectorAll('.playlist-item');
            items.forEach((item, index) => {
                const container = item.querySelector('div');
                if (index === currentVideoIndex) {
                    container.style.background = '#E95420';
                    item.classList.add('active');
                } else {
                    container.style.background = '#444';
                    item.classList.remove('active');
                }
            });
        }

        function addVideoToPlaylist() {
            // Simulate file picker
            showNotification('File picker would open here in a real implementation', 'info');

            // Add a demo video
            const newVideo = {
                name: `Demo Video ${playlist.length + 1}`,
                duration: '02:00',
                url: '',
                type: 'demo'
            };

            playlist.push(newVideo);
            updatePlaylistDisplay();
            updatePlaylistCount();
        }

        function removeFromPlaylist(index) {
            if (playlist.length > 1) {
                playlist.splice(index, 1);

                // Adjust current index if necessary
                if (currentVideoIndex >= index && currentVideoIndex > 0) {
                    currentVideoIndex--;
                }

                updatePlaylistDisplay();
                updatePlaylistCount();
                updatePlaylistSelection();
            } else {
                showNotification('Cannot remove the last video from playlist', 'warning');
            }
        }

        function clearPlaylist() {
            if (confirm('Are you sure you want to clear the entire playlist?')) {
                playlist = [];
                currentVideoIndex = 0;
                updatePlaylistDisplay();
                updatePlaylistCount();
                stopVideo();
                showVideoOverlay();
            }
        }

        function shufflePlaylist() {
            for (let i = playlist.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [playlist[i], playlist[j]] = [playlist[j], playlist[i]];
            }

            currentVideoIndex = 0;
            updatePlaylistDisplay();
            updatePlaylistSelection();
            showNotification('Playlist shuffled', 'info');
        }

        function toggleRepeat() {
            isRepeat = !isRepeat;
            const repeatBtn = document.getElementById('repeat-btn');

            if (isRepeat) {
                repeatBtn.style.background = '#E95420';
                showNotification('Repeat enabled', 'info');
            } else {
                repeatBtn.style.background = '#6c757d';
                showNotification('Repeat disabled', 'info');
            }
        }

        function updatePlaylistDisplay() {
            const container = document.getElementById('playlist-items');
            container.innerHTML = '';

            playlist.forEach((item, index) => {
                const itemElement = document.createElement('div');
                itemElement.className = 'playlist-item';
                itemElement.setAttribute('data-index', index);
                itemElement.onclick = () => selectPlaylistItem(index);

                itemElement.innerHTML = `
                    <div style="display: flex; align-items: center; padding: 10px; background: ${index === currentVideoIndex ? '#E95420' : '#444'}; border-radius: 6px; cursor: pointer; margin-bottom: 8px;">
                        <div style="width: 40px; height: 30px; background: #333; border-radius: 4px; margin-right: 10px; display: flex; align-items: center; justify-content: center; color: #999; font-size: 12px;">🎬</div>
                        <div style="flex: 1; min-width: 0;">
                            <div style="color: white; font-weight: 600; font-size: 13px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">${item.name}</div>
                            <div style="color: #ccc; font-size: 11px;">${item.type} • ${item.duration}</div>
                        </div>
                        <button onclick="removeFromPlaylist(${index})" style="background: none; border: none; color: #fff; font-size: 14px; cursor: pointer; padding: 4px;">×</button>
                    </div>
                `;

                container.appendChild(itemElement);
            });
        }

        function updatePlaylistCount() {
            const countElement = document.getElementById('playlist-count');
            countElement.textContent = `${playlist.length} video${playlist.length !== 1 ? 's' : ''}`;
        }

        function showVideoOverlay() {
            document.getElementById('video-overlay').style.display = 'flex';
        }

        function hideVideoOverlay() {
            document.getElementById('video-overlay').style.display = 'none';
        }

        function openVideoFile() {
            showNotification('File picker would open here to select video files', 'info');
        }

        // File Manager Application Functions
        let fileManagerState = {
            currentPath: '/home/user',
            viewMode: 'list', // 'list' or 'grid'
            selectedFiles: [],
            history: ['/home/user'],
            historyIndex: 0,
            clipboard: null,
            clipboardOperation: null // 'cut' or 'copy'
        };

        // Simulated file system
        const fileSystem = {
            '/': {
                type: 'directory',
                name: 'Root',
                children: ['home', 'usr', 'var', 'etc', 'media'],
                size: 0,
                modified: '2024-01-15 10:30:00'
            },
            '/home': {
                type: 'directory',
                name: 'home',
                children: ['user'],
                size: 0,
                modified: '2024-01-15 10:30:00'
            },
            '/home/user': {
                type: 'directory',
                name: 'user',
                children: ['Desktop', 'Documents', 'Downloads', 'Pictures', 'Music', 'Videos', 'Projects'],
                size: 0,
                modified: '2024-01-20 14:25:00'
            },
            '/home/user/Desktop': {
                type: 'directory',
                name: 'Desktop',
                children: ['Shortcuts.txt', 'README.md'],
                size: 0,
                modified: '2024-01-20 09:15:00'
            },
            '/home/user/Documents': {
                type: 'directory',
                name: 'Documents',
                children: ['Report.docx', 'Presentation.pptx', 'Spreadsheet.xlsx', 'Notes.txt'],
                size: 0,
                modified: '2024-01-19 16:45:00'
            },
            '/home/user/Downloads': {
                type: 'directory',
                name: 'Downloads',
                children: ['installer.deb', 'image.jpg', 'document.pdf', 'archive.zip'],
                size: 0,
                modified: '2024-01-21 11:20:00'
            },
            '/home/user/Pictures': {
                type: 'directory',
                name: 'Pictures',
                children: ['vacation.jpg', 'family.png', 'screenshot.png', 'wallpaper.jpg'],
                size: 0,
                modified: '2024-01-18 13:30:00'
            },
            '/home/user/Music': {
                type: 'directory',
                name: 'Music',
                children: ['song1.mp3', 'song2.mp3', 'album', 'playlist.m3u'],
                size: 0,
                modified: '2024-01-17 20:15:00'
            },
            '/home/user/Videos': {
                type: 'directory',
                name: 'Videos',
                children: ['movie.mp4', 'tutorial.avi', 'recording.mkv'],
                size: 0,
                modified: '2024-01-16 18:45:00'
            },
            '/home/user/Projects': {
                type: 'directory',
                name: 'Projects',
                children: ['kronos-os', 'website', 'game-dev'],
                size: 0,
                modified: '2024-01-21 15:30:00'
            },
            // Files
            '/home/user/Desktop/Shortcuts.txt': {
                type: 'file',
                name: 'Shortcuts.txt',
                size: 1024,
                modified: '2024-01-20 09:15:00',
                extension: 'txt'
            },
            '/home/user/Desktop/README.md': {
                type: 'file',
                name: 'README.md',
                size: 2048,
                modified: '2024-01-20 09:20:00',
                extension: 'md'
            },
            '/home/user/Documents/Report.docx': {
                type: 'file',
                name: 'Report.docx',
                size: 524288,
                modified: '2024-01-19 16:45:00',
                extension: 'docx'
            },
            '/home/user/Documents/Presentation.pptx': {
                type: 'file',
                name: 'Presentation.pptx',
                size: 2097152,
                modified: '2024-01-19 14:30:00',
                extension: 'pptx'
            },
            '/home/user/Documents/Spreadsheet.xlsx': {
                type: 'file',
                name: 'Spreadsheet.xlsx',
                size: 65536,
                modified: '2024-01-19 12:15:00',
                extension: 'xlsx'
            },
            '/home/user/Documents/Notes.txt': {
                type: 'file',
                name: 'Notes.txt',
                size: 4096,
                modified: '2024-01-19 16:00:00',
                extension: 'txt'
            }
        };

        function initializeFileManager() {
            if (openWindows.has('file-manager-window')) {
                loadDirectory(fileManagerState.currentPath);
                updateAddressBar();
                updateBreadcrumb();
                updateNavigationButtons();
                showNotification('File Manager initialized', 'info');
            }
        }

        function loadDirectory(path) {
            const directory = fileSystem[path];
            if (!directory || directory.type !== 'directory') {
                showNotification('Directory not found', 'error');
                return;
            }

            fileManagerState.currentPath = path;
            fileManagerState.selectedFiles = [];

            const fileList = document.getElementById('file-list');
            if (!fileList) return;

            if (fileManagerState.viewMode === 'list') {
                loadListView(directory, fileList);
            } else {
                loadGridView(directory, fileList);
            }

            updateFileCount(directory.children.length);
            updateSidebarSelection();
            updateAddressBar();
            updateBreadcrumb();
            updateNavigationButtons();
        }

        function loadListView(directory, container) {
            container.className = 'file-list';
            container.innerHTML = `
                <div class="file-list-header">
                    <div style="width: 32px;"></div>
                    <div class="header-name">Name</div>
                    <div class="header-size">Size</div>
                    <div class="header-date">Modified</div>
                </div>
            `;

            directory.children.forEach(childName => {
                const childPath = fileManagerState.currentPath + (fileManagerState.currentPath.endsWith('/') ? '' : '/') + childName;
                const child = fileSystem[childPath];
                if (!child) return;

                const fileItem = document.createElement('div');
                fileItem.className = 'file-item';
                fileItem.onclick = () => selectFile(childPath);
                fileItem.ondblclick = () => openFile(childPath);
                fileItem.oncontextmenu = (e) => showContextMenu(e, childPath);

                const icon = getFileIcon(child);
                const size = child.type === 'directory' ? '-' : formatFileSize(child.size);

                fileItem.innerHTML = `
                    <div class="file-icon">${icon}</div>
                    <div class="file-info">
                        <div class="file-name">${child.name}</div>
                    </div>
                    <div class="file-size">${size}</div>
                    <div class="file-date">${child.modified}</div>
                `;

                container.appendChild(fileItem);
            });
        }

        function loadGridView(directory, container) {
            container.className = 'file-grid';
            container.innerHTML = '';

            directory.children.forEach(childName => {
                const childPath = fileManagerState.currentPath + (fileManagerState.currentPath.endsWith('/') ? '' : '/') + childName;
                const child = fileSystem[childPath];
                if (!child) return;

                const fileItem = document.createElement('div');
                fileItem.className = 'file-item grid-view';
                fileItem.onclick = () => selectFile(childPath);
                fileItem.ondblclick = () => openFile(childPath);
                fileItem.oncontextmenu = (e) => showContextMenu(e, childPath);

                const icon = getFileIcon(child);

                fileItem.innerHTML = `
                    <div class="file-icon large">${icon}</div>
                    <div class="file-name">${child.name}</div>
                    <div class="file-details">${child.type === 'directory' ? 'Folder' : formatFileSize(child.size)}</div>
                `;

                container.appendChild(fileItem);
            });
        }

        function getFileIcon(file) {
            if (file.type === 'directory') {
                return '📁';
            }

            const ext = file.extension?.toLowerCase();
            const iconMap = {
                'txt': '📄',
                'md': '📝',
                'docx': '📄',
                'pptx': '📊',
                'xlsx': '📈',
                'pdf': '📕',
                'jpg': '🖼️',
                'jpeg': '🖼️',
                'png': '🖼️',
                'gif': '🖼️',
                'mp3': '🎵',
                'mp4': '🎬',
                'avi': '🎬',
                'mkv': '🎬',
                'zip': '📦',
                'deb': '📦',
                'm3u': '🎵'
            };

            return iconMap[ext] || '📄';
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 B';
            const k = 1024;
            const sizes = ['B', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
        }

        // Application initialization functionality is now integrated into main openApp function

        // File Manager Navigation Functions
        function navigateToPath(path) {
            if (fileSystem[path]) {
                // Add to history if it's a new navigation
                if (fileManagerState.historyIndex === fileManagerState.history.length - 1) {
                    fileManagerState.history.push(path);
                    fileManagerState.historyIndex++;
                } else {
                    // Replace forward history
                    fileManagerState.history = fileManagerState.history.slice(0, fileManagerState.historyIndex + 1);
                    fileManagerState.history.push(path);
                    fileManagerState.historyIndex++;
                }

                loadDirectory(path);
            }
        }

        function navigateBack() {
            if (fileManagerState.historyIndex > 0) {
                fileManagerState.historyIndex--;
                loadDirectory(fileManagerState.history[fileManagerState.historyIndex]);
            }
        }

        function navigateForward() {
            if (fileManagerState.historyIndex < fileManagerState.history.length - 1) {
                fileManagerState.historyIndex++;
                loadDirectory(fileManagerState.history[fileManagerState.historyIndex]);
            }
        }

        function navigateUp() {
            const currentPath = fileManagerState.currentPath;
            if (currentPath === '/') return;

            const parentPath = currentPath.substring(0, currentPath.lastIndexOf('/')) || '/';
            navigateToPath(parentPath);
        }

        function refreshFiles() {
            loadDirectory(fileManagerState.currentPath);
            showNotification('Files refreshed', 'info');
        }

        function updateNavigationButtons() {
            const backBtn = document.getElementById('back-btn');
            const forwardBtn = document.getElementById('forward-btn');
            const upBtn = document.getElementById('up-btn');

            if (backBtn) backBtn.disabled = fileManagerState.historyIndex <= 0;
            if (forwardBtn) forwardBtn.disabled = fileManagerState.historyIndex >= fileManagerState.history.length - 1;
            if (upBtn) upBtn.disabled = fileManagerState.currentPath === '/';
        }

        function updateAddressBar() {
            const addressBar = document.getElementById('address-bar');
            if (addressBar) {
                addressBar.value = fileManagerState.currentPath;
            }
        }

        function updateBreadcrumb() {
            const breadcrumb = document.getElementById('breadcrumb');
            if (!breadcrumb) return;

            const pathParts = fileManagerState.currentPath.split('/').filter(part => part);
            let currentPath = '';

            breadcrumb.innerHTML = `
                <span onclick="navigateToPath('/')" style="cursor: pointer; color: #007bff;">🏠</span>
            `;

            pathParts.forEach((part, index) => {
                currentPath += '/' + part;
                breadcrumb.innerHTML += `
                    <span style="color: #666; margin: 0 5px;">></span>
                    <span onclick="navigateToPath('${currentPath}')" style="cursor: pointer; color: #007bff;">${part}</span>
                `;
            });
        }

        function updateSidebarSelection() {
            document.querySelectorAll('.sidebar-item').forEach(item => {
                item.classList.remove('active');
                if (item.dataset.path === fileManagerState.currentPath) {
                    item.classList.add('active');
                }
            });
        }

        function updateFileCount(count) {
            const fileCount = document.getElementById('file-count');
            if (fileCount) {
                fileCount.textContent = `${count} item${count !== 1 ? 's' : ''}`;
            }
        }

        function handleAddressBarEnter(event) {
            if (event.key === 'Enter') {
                const path = event.target.value;
                if (fileSystem[path]) {
                    navigateToPath(path);
                } else {
                    showNotification('Path not found', 'error');
                    updateAddressBar(); // Reset to current path
                }
            }
        }

        // File Operations
        function selectFile(path) {
            const fileItems = document.querySelectorAll('.file-item');
            fileItems.forEach(item => item.classList.remove('selected'));

            const clickedItem = event.currentTarget;
            clickedItem.classList.add('selected');

            fileManagerState.selectedFiles = [path];

            const file = fileSystem[path];
            if (file) {
                document.getElementById('status-text').textContent = `Selected: ${file.name}`;
            }
        }

        function openFile(path) {
            const file = fileSystem[path];
            if (!file) return;

            if (file.type === 'directory') {
                navigateToPath(path);
            } else {
                // Open file based on type
                const ext = file.extension?.toLowerCase();
                if (['jpg', 'jpeg', 'png', 'gif'].includes(ext)) {
                    showNotification(`Opening image: ${file.name}`, 'info');
                } else if (['mp3', 'mp4', 'avi', 'mkv'].includes(ext)) {
                    showNotification(`Opening media: ${file.name}`, 'info');
                } else if (['txt', 'md'].includes(ext)) {
                    showNotification(`Opening text file: ${file.name}`, 'info');
                } else {
                    showNotification(`Opening file: ${file.name}`, 'info');
                }
            }
        }

        function toggleViewMode() {
            const viewModeBtn = document.getElementById('view-mode-btn');

            if (fileManagerState.viewMode === 'list') {
                fileManagerState.viewMode = 'grid';
                viewModeBtn.innerHTML = '⊞ Grid';
            } else {
                fileManagerState.viewMode = 'list';
                viewModeBtn.innerHTML = '📋 List';
            }

            loadDirectory(fileManagerState.currentPath);
        }

        function searchFiles(query) {
            if (!query.trim()) {
                loadDirectory(fileManagerState.currentPath);
                return;
            }

            const directory = fileSystem[fileManagerState.currentPath];
            if (!directory) return;

            const filteredChildren = directory.children.filter(childName =>
                childName.toLowerCase().includes(query.toLowerCase())
            );

            const filteredDirectory = {
                ...directory,
                children: filteredChildren
            };

            const fileList = document.getElementById('file-list');
            if (fileManagerState.viewMode === 'list') {
                loadListView(filteredDirectory, fileList);
            } else {
                loadGridView(filteredDirectory, fileList);
            }

            updateFileCount(filteredChildren.length);
            document.getElementById('status-text').textContent = `Search results for "${query}"`;
        }

        function showContextMenu(event, path) {
            event.preventDefault();

            // Remove existing context menu
            const existingMenu = document.querySelector('.context-menu');
            if (existingMenu) {
                existingMenu.remove();
            }

            const file = fileSystem[path];
            if (!file) return;

            const contextMenu = document.createElement('div');
            contextMenu.className = 'context-menu';
            contextMenu.style.left = event.pageX + 'px';
            contextMenu.style.top = event.pageY + 'px';

            const menuItems = [
                { text: 'Open', action: () => openFile(path) },
                { text: 'Copy', action: () => copyFile(path) },
                { text: 'Cut', action: () => cutFile(path) },
                { text: 'Delete', action: () => deleteFile(path) },
                { text: 'Rename', action: () => renameFile(path) },
                { text: 'Properties', action: () => showFileProperties(path) }
            ];

            menuItems.forEach(item => {
                const menuItem = document.createElement('div');
                menuItem.className = 'context-menu-item';
                menuItem.textContent = item.text;
                menuItem.onclick = () => {
                    item.action();
                    contextMenu.remove();
                };
                contextMenu.appendChild(menuItem);
            });

            document.body.appendChild(contextMenu);

            // Remove menu when clicking elsewhere
            setTimeout(() => {
                document.addEventListener('click', function removeMenu() {
                    contextMenu.remove();
                    document.removeEventListener('click', removeMenu);
                });
            }, 0);
        }

        function showNewMenu() {
            showNotification('New file/folder creation would be implemented here', 'info');
        }

        function copyFile(path) {
            fileManagerState.clipboard = path;
            fileManagerState.clipboardOperation = 'copy';
            const file = fileSystem[path];
            showNotification(`Copied: ${file.name}`, 'info');
        }

        function cutFile(path) {
            fileManagerState.clipboard = path;
            fileManagerState.clipboardOperation = 'cut';
            const file = fileSystem[path];
            showNotification(`Cut: ${file.name}`, 'info');
        }

        function deleteFile(path) {
            const file = fileSystem[path];
            if (confirm(`Are you sure you want to delete "${file.name}"?`)) {
                showNotification(`Deleted: ${file.name}`, 'info');
                // In a real implementation, this would remove the file
            }
        }

        function renameFile(path) {
            const file = fileSystem[path];
            const newName = prompt('Enter new name:', file.name);
            if (newName && newName !== file.name) {
                showNotification(`Renamed "${file.name}" to "${newName}"`, 'info');
                // In a real implementation, this would rename the file
            }
        }

        function showFileProperties(path) {
            const file = fileSystem[path];
            const size = file.type === 'directory' ? 'Folder' : formatFileSize(file.size);

            alert(`Properties of ${file.name}:\n\nType: ${file.type}\nSize: ${size}\nModified: ${file.modified}`);
        }

        // Close start menu when clicking outside
        document.addEventListener('click', (e) => {
            if (!e.target.closest('.start-menu') && !e.target.closest('.start-button')) {
                closeStartMenu();
            }
        });

        // Make windows draggable
        document.querySelectorAll('.window-header').forEach(header => {
            let isDragging = false;
            let currentX, currentY, initialX, initialY, xOffset = 0, yOffset = 0;

            header.addEventListener('mousedown', dragStart);
            document.addEventListener('mousemove', drag);
            document.addEventListener('mouseup', dragEnd);

            function dragStart(e) {
                const window = header.closest('.window');
                setActiveWindow(window.id);

                initialX = e.clientX - xOffset;
                initialY = e.clientY - yOffset;

                if (e.target === header || header.contains(e.target)) {
                    isDragging = true;
                }
            }

            function drag(e) {
                if (isDragging) {
                    e.preventDefault();
                    currentX = e.clientX - initialX;
                    currentY = e.clientY - initialY;

                    xOffset = currentX;
                    yOffset = currentY;

                    const window = header.closest('.window');
                    window.style.left = currentX + 'px';
                    window.style.top = currentY + 'px';
                }
            }

            function dragEnd() {
                initialX = currentX;
                initialY = currentY;
                isDragging = false;
            }
        });
    </script>
</body>
</html>